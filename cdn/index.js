let e,t;let r={debug:!1,perf:!1};function i(e){if(null==e||"object"!=typeof e)return e;if(Array.isArray(e))return e.map(i);let t={};for(let r in e){let l=e[r];null!=e&&"object"==typeof e?t[r]=i(l):t[r]=l}return t}let l="-xin-data",o=`.${l}`,n="-xin-event",s=`.${n}`,a=Symbol("xin-path"),h=Symbol("xin-value"),u=e=>e[a];function d(e){return"object"==typeof e&&null!==e&&e[h]||e}let c=new WeakMap,f=new WeakMap,p=e=>{let t=e.cloneNode();if(t instanceof HTMLElement){let r=f.get(e),l=c.get(e);null!=r&&f.set(t,i(r)),null!=l&&c.set(t,i(l))}for(let r of e instanceof HTMLTemplateElement?e.content.childNodes:e.childNodes)r instanceof HTMLElement||r instanceof DocumentFragment?t.appendChild(p(r)):t.appendChild(r.cloneNode());return t},b=new WeakMap,m=e=>{let t=document.body.parentElement;for(;null!=e.parentElement&&e.parentElement!==t;){let t=b.get(e);if(null!=t)return t;e=e.parentElement}return!1},g=Symbol("observer should be removed"),$=[],y=[],v=!1;class x{constructor(e,t){let r;let i="string"==typeof t?`"${t}"`:`function ${t.name}`;if("string"==typeof e)this.test=t=>"string"==typeof t&&""!==t&&(e.startsWith(t)||t.startsWith(e)),r=`test = "${e}"`;else if(e instanceof RegExp)this.test=e.test.bind(e),r=`test = "${e.toString()}"`;else if(e instanceof Function)this.test=e,r=`test = function ${e.name}`;else throw Error("expect listener test to be a string, RegExp, or test function");if(this.description=`${r}, ${i}`,"function"==typeof t)this.callback=t;else throw Error("expect callback to be a path or function");$.push(this)}}let w=async()=>{void 0!==e&&await e},E=()=>{r.perf&&console.time("xin async update");let e=[...y];for(let t of e)$.filter(e=>{let r;try{r=e.test(t)}catch(r){throw Error(`Listener ${e.description} threw "${r}" at "${t}"`)}return r===g?(S(e),!1):r}).forEach(e=>{let r;try{r=e.callback(t)}catch(r){console.error(`Listener ${e.description} threw "${r}" handling "${t}"`)}r===g&&S(e)});y.splice(0),v=!1,"function"==typeof t&&t(),r.perf&&console.timeEnd("xin async update")},A=r=>{let i="string"==typeof r?r:u(r);if(void 0===i)throw console.error("touch was called on an invalid target",r),Error("touch was called on an invalid target");!1===v&&(e=new Promise(e=>{t=e}),v=setTimeout(E)),null==y.find(e=>i.startsWith(e))&&y.push(i)},_=(e,t)=>new x(e,t),S=e=>{let t=$.indexOf(e);if(t>-1)$.splice(t,1);else throw Error("unobserve failed, listener not found")},M=e=>{try{return JSON.stringify(e)}catch(e){return"{has circular references}"}},C=(...e)=>Error(e.map(M).join(" ")),O=()=>new Date(parseInt("1000000000",36)+Date.now()).valueOf().toString(36).slice(1),L=0,k=()=>(parseInt("10000",36)+ ++L).toString(36).slice(-5),j=()=>O()+k(),P={},T={};function D(e){if(""===e)return[];if(Array.isArray(e))return e;{let t=[];for(;e.length>0;){let r=e.search(/\[[^\]]+\]/);if(-1===r){t.push(e.split("."));break}{let i=e.slice(0,r);e=e.slice(r),""!==i&&t.push(i.split(".")),r=e.indexOf("]")+1,t.push(e.slice(1,r-1)),"."===e.slice(r,r+1)&&(r+=1),e=e.slice(r)}}return t}}let F=new WeakMap;function R(e,t){void 0===F.get(e)&&F.set(e,{}),void 0===F.get(e)[t]&&(F.get(e)[t]={});let r=F.get(e)[t];return"_auto_"===t?e.forEach((e,t)=>{void 0===e._auto_&&(e._auto_=j()),r[e._auto_+""]=t}):e.forEach((e,i)=>{r[H(e,t)+""]=i}),r}function N(e,t,r,i){var l;let o;let n=""!==t?(l=r+"",(void 0===(o=(void 0===F.get(e)||void 0===F.get(e)[t]?R(e,t):F.get(e)[t])[l])||H(e[o],t)+""!==l)&&(o=R(e,t)[l]),o):r;if(i===P)return e.splice(n,1),F.delete(e),Symbol("deleted");if(i===T)""===t&&void 0===e[n]&&(e[n]={});else if(void 0!==i){if(void 0!==n)e[n]=i;else if(""!==t&&H(i,t)+""==r+"")e.push(i),n=e.length-1;else throw Error(`byIdPath insert failed at [${t}=${r}]`)}return e[n]}function q(e){if(!Array.isArray(e))throw C("setByPath failed: expected array, found",e)}function B(e){if(null==e||!(e instanceof Object))throw C("setByPath failed: expected Object, found",e)}function H(e,t){let r,i,l,o;let n=D(t),s=e;for(r=0,i=n.length;void 0!==s&&r<i;r++){let e=n[r];if(Array.isArray(e))for(l=0,o=e.length;void 0!==s&&l<o;l++){let t=e[l];s=s[t]}else if(0===s.length){if(s=s[e.slice(1)],"="!==e[0])return}else if(e.includes("=")){let[t,...r]=e.split("=");s=N(s,t,r.join("="))}else s=s[l=parseInt(e,10)]}return s}let I=["sort","splice","copyWithin","fill","pop","push","reverse","shift","unshift"],W={},z=/^\.?([^.[\](),])+(\.[^.[\](),]+|\[\d+\]|\[[^=[\](),]*=[^[\]()]+\])*$/,V=e=>z.test(e),Q=(e="",t="")=>""===e?t:null!==t.match(/^\d+$/)||t.includes("=")?`${e}[${t}]`:`${e}.${t}`,Z=(e="")=>({get(t,r){if(r===a)return e;if(r===h){for(;void 0!==u(t);)t=d(t);return t}if("symbol"==typeof r)return t[r];let i=r,l=i.match(/^([^.[]+)\.(.+)$/)??i.match(/^([^\]]+)(\[.+)/)??i.match(/^(\[[^\]]+\])\.(.+)$/)??i.match(/^(\[[^\]]+\])\[(.+)$/);if(null!==l){let[,r,i]=l,o=Q(e,r),n=H(t,r);return null!==n&&"object"==typeof n?new Proxy(n,Z(o))[i]:n}if(i.startsWith("[")&&i.endsWith("]")&&(i=i.substring(1,i.length-1)),!Array.isArray(t)&&void 0!==t[i]||Array.isArray(t)&&i.includes("=")){let r;if(i.includes("=")){let[e,l]=i.split("=");r=t.find(t=>`${H(t,e)}`===l)}else r=t[i];if(null!==r&&"object"==typeof r){let t=Q(e,i);return new Proxy(r,Z(t))}return"function"==typeof r?r.bind(t):r}if(!Array.isArray(t))return t[i];{let r=t[i];return"function"==typeof r?(...r)=>{let l=Array.prototype[i].apply(t,r);return I.includes(i)&&A(e),l}:"object"==typeof r?new Proxy(r,Z(Q(e,i))):r}},set(t,r,i){i=d(i);let l=Q(e,r);if(!V(l))throw Error(`setting invalid path ${l}`);let o=d(J[l]);return o!==i&&function(e,t,r){let i=e,l=D(t);for(;null!=i&&l.length>0;){let e=l.shift();if("string"==typeof e){let t=e.indexOf("=");if(t>-1){0===t?B(i):q(i);let o=e.slice(0,t),n=e.slice(t+1);if(i=N(i,o,n,l.length>0?T:r),0===l.length)return!0}else{q(i);let t=parseInt(e,10);if(l.length>0)i=i[t];else{if(r!==P){if(i[t]===r)return!1;i[t]=r}else i.splice(t,1);return!0}}}else if(Array.isArray(e)&&e.length>0)for(B(i);e.length>0;){let t=e.shift();if(e.length>0||l.length>0){var o,n;o=i,n=e.length>0?{}:[],void 0===o[t]&&void 0!==n&&(o[t]=n),i=o[t]}else{if(r!==P){if(i[t]===r)return!1;i[t]=r}else{if(!Object.prototype.hasOwnProperty.call(i,t))return!1;delete i[t]}return!0}}else throw Error(`setByPath failed, bad path ${t}`)}throw Error(`setByPath(${e}, ${t}, ${r}) failed`)}(W,l,i)&&A(l),!0}}),G=(e,t)=>{let r="function"==typeof t?t:J[t];if("function"!=typeof r)throw Error(`observe expects a function or path to a function, ${t} is neither`);return _(e,r)},J=new Proxy(W,Z()),{document:Y,MutationObserver:U}=globalThis,K=(e,t)=>{let r=f.get(e);if(null!=r)for(let i of r){let{binding:r,options:l}=i,{path:o}=i,{toDOM:n}=r;if(null!=n){if(o.startsWith("^")){let t=m(e);if(null!=t&&null!=t[a])o=i.path=`${t[a]}${o.substring(1)}`;else throw console.error(`Cannot resolve relative binding ${o}`,e,"is not part of a list"),Error(`Cannot resolve relative binding ${o}`)}(null==t||o.startsWith(t))&&n(e,J[o],l)}}};if(null!=U){let e=new U(e=>{e.forEach(e=>{[...e.addedNodes].forEach(e=>{e instanceof HTMLElement&&[...e.querySelectorAll(o)].forEach(e=>K(e))})})});e.observe(Y.body,{subtree:!0,childList:!0})}G(()=>!0,e=>{let t=Y.querySelectorAll(o);for(let r of t)K(r,e)});let X=e=>{let t=e.target.closest(o);for(;null!=t;){let e=f.get(t);for(let r of e){let{binding:e,path:i}=r,{fromDOM:l}=e;if(null!=l){let e;try{e=l(t,r.options)}catch(e){throw console.error("Cannot get value from",t,"via",r),Error("Cannot obtain value fromDOM")}if(null!=e){let t=J[i];if(null==t)J[i]=e;else{let r=null!=t[a]?t[h]:t,l=null!=e[a]?e[h]:e;r!==l&&(J[i]=l)}}}}t=t.parentElement.closest(o)}};function ee(e,t,r,i){let o;if(e instanceof DocumentFragment)throw Error("bind cannot bind to a DocumentFragment");if("object"==typeof t&&void 0===t[a]&&void 0===i){let{value:e}=t;o="string"==typeof e?e:e[a],i=t,delete i.value}else o="string"==typeof t?t:t[a];if(null==o)throw Error("bind requires a path or object with xin Proxy");let{toDOM:n}=r;e.classList.add(l);let s=f.get(e);return null==s&&(s=[],f.set(e,s)),s.push({path:o,binding:r,options:i}),null==n||o.startsWith("^")||A(o),e}null!=globalThis.document&&(Y.body.addEventListener("change",X,!0),Y.body.addEventListener("input",X,!0));let et=new Set,er=e=>{let t=e?.target.closest(s),r=!1,i=new Proxy(e,{get(t,i){if("stopPropagation"===i)return()=>{e.stopPropagation(),r=!0};{let e=t[i];return"function"==typeof e?e.bind(t):e}}});for(;!r&&null!=t;){let l=c.get(t),o=l[e.type]||[];for(let e of o){if("function"==typeof e)e(i);else{let t=J[e];if("function"==typeof t)t(i);else throw Error(`no event handler found at path ${e}`)}if(r)continue}t=null!=t.parentElement?t.parentElement.closest(s):null}},ei=(e,t,r)=>{let i=c.get(e);e.classList.add(n),null==i&&(i={},c.set(e,i)),i[t]||(i[t]=[]),i[t].includes(r)||i[t].push(r),et.has(t)||(et.add(t),Y.body.addEventListener(t,er,!0))},el=(e,t)=>{let r=new Event(t);e.dispatchEvent(r)},eo=e=>e instanceof HTMLInputElement?e.type:e instanceof HTMLSelectElement&&e.hasAttribute("multiple")?"multi-select":"other",en=(e,t)=>{switch(eo(e)){case"radio":e.checked=e.value===t;break;case"checkbox":e.checked=!!t;break;case"date":e.valueAsDate=new Date(t);break;case"multi-select":for(let r of[...e.querySelectorAll("option")])r.selected=t[r.value];break;default:e.value=t}},es=e=>{switch(eo(e)){case"radio":{let t=e.parentElement?.querySelector(`[name="${e.name}"]:checked`);return null!=t?t.value:null}case"checkbox":return e.checked;case"date":return e.valueAsDate?.toISOString();case"multi-select":return[...e.querySelectorAll("option")].reduce((e,t)=>(e[t.value]=t.selected,e),{});default:return e.value}},{ResizeObserver:ea}=globalThis,eh=null!=ea?new ea(e=>{for(let t of e){let e=t.target;el(e,"resize")}}):{observe(){},unobserve(){}},eu=(e,t,r=!0)=>{if(null!=e&&null!=t){if("string"==typeof t)e.textContent=t;else if(Array.isArray(t))t.forEach(t=>{e.append(t instanceof Node&&r?p(t):t)});else if(t instanceof HTMLElement||t instanceof DocumentFragment)e.append(r?p(t):t);else throw Error("expect text content or document node")}},ed=(e,t=250)=>{let r;return(...i)=>{void 0!==r&&clearTimeout(r),r=setTimeout(()=>{e(...i)},t)}},ec=(e,t=250)=>{let r;let i=Date.now()-t,l=!1;return(...o)=>{if(clearTimeout(r),r=setTimeout(async()=>{e(...o),i=Date.now()},t),!l&&Date.now()-i>=t){l=!0;try{e(...o),i=Date.now()}finally{l=!1}}}},ef=Symbol("list-binding");function ep(e,t){let r=[...e.querySelectorAll(o)];for(let i of(e.matches(o)&&r.unshift(e),r)){let e=f.get(i);for(let r of e)r.path.startsWith("^")&&(r.path=`${t}${r.path.substring(1)}`),null!=r.binding.toDOM&&r.binding.toDOM(i,J[r.path])}}class eb{constructor(e,t={}){if(this._array=[],this.boundElement=e,this.itemToElement=new WeakMap,1!==e.children.length)throw Error("ListBinding expects an element with exactly one child element");if(e.children[0]instanceof HTMLTemplateElement){let t=e.children[0];if(1!==t.content.children.length)throw Error("ListBinding expects a template with exactly one child element");this.template=p(t.content.children[0])}else this.template=e.children[0],this.template.remove();this.listTop=document.createElement("div"),this.listBottom=document.createElement("div"),this.boundElement.append(this.listTop),this.boundElement.append(this.listBottom),this.options=t,null!=t.virtual&&(eh.observe(this.boundElement),this._update=ec(()=>{this.update(this._array,!0)},16),this.boundElement.addEventListener("scroll",this._update),this.boundElement.addEventListener("resize",this._update))}visibleSlice(){let{virtual:e,hiddenProp:t,visibleProp:r}=this.options,i=this._array;void 0!==t&&(i=i.filter(e=>!0!==e[t])),void 0!==r&&(i=i.filter(e=>!0===e[r]));let l=0,o=i.length-1,n=0,s=0;if(null!=e){let t=this.boundElement.offsetWidth,r=this.boundElement.offsetHeight,a=null!=e.width?Math.max(1,Math.floor(t/e.width)):1,h=Math.ceil(r/e.height)+1,u=Math.ceil(i.length/a),d=Math.floor(this.boundElement.scrollTop/e.height);d>u-h+1&&(d=Math.max(0,u-h+1)),o=(l=d*a)+a*h-1,n=d*e.height,s=Math.max(u*e.height-r-n,0)}return{items:i,firstItem:l,lastItem:o,topBuffer:n,bottomBuffer:s}}update(e,t){null==e&&(e=[]),this._array=e;let{initInstance:i,updateInstance:l,hiddenProp:o,visibleProp:n}=this.options,s=u(e),a=this.visibleSlice();this.boundElement.classList.toggle("-xin-empty-list",0===a.items.length);let h=this._previousSlice,{firstItem:c,lastItem:f,topBuffer:m,bottomBuffer:g}=a;if(void 0===o&&void 0===n&&!0===t&&null!=h&&c===h.firstItem&&f===h.lastItem)return;this._previousSlice=a;let $=0,y=0,v=0;for(let e of[...this.boundElement.children]){if(e===this.listTop||e===this.listBottom)continue;let t=b.get(e);if(null==t)e.remove();else{let r=a.items.indexOf(t);(r<c||r>f)&&(e.remove(),this.itemToElement.delete(t),b.delete(e),$++)}}this.listTop.style.height=String(m)+"px",this.listBottom.style.height=String(g)+"px";let x=[],{idPath:w}=this.options;for(let e=c;e<=f;e++){let t=a.items[e];if(void 0===t)continue;let r=this.itemToElement.get(d(t));if(null==r){if(v++,r=p(this.template),"object"==typeof t&&(this.itemToElement.set(d(t),r),b.set(r,d(t))),this.boundElement.insertBefore(r,this.listBottom),null!=w){let e=t[w],i=`${s}[${w}=${e}]`;ep(r,i)}else{let t=`${s}[${e}]`;ep(r,t)}null!=i&&i(r,t)}null!=l&&l(r,t),x.push(r)}let E=null;for(let e of x)e.previousElementSibling!==E&&(y++,E?.nextElementSibling!=null?this.boundElement.insertBefore(e,E.nextElementSibling):this.boundElement.insertBefore(e,this.listBottom)),E=e;r.perf&&console.log(s,"updated",{removed:$,created:v,moved:y})}}let em=(e,t)=>{let r=e[ef];return void 0===r&&(r=new eb(e,t),e[ef]=r),r},eg={value:{toDOM(e,t){en(e,t)},fromDOM:e=>es(e)},text:{toDOM(e,t){e.textContent=t}},enabled:{toDOM(e,t){e.disabled=!t}},disabled:{toDOM(e,t){e.disabled=!!t}},style:{toDOM(e,t){if("object"==typeof t)for(let r of Object.keys(t))e.style[r]=t[r];else if("string"==typeof t)e.setAttribute("style",t);else throw Error("style binding expects either a string or object")}},list:{toDOM(e,t,r){let i=em(e,r);i.update(t)}}};function e$(e,t,r){return t<e?e:t>r?r:t}function ey(e,t,r){return(r=e$(0,r,1))*(t-e)+e}let ev={clamp:e$,lerp:ey},ex=e=>("00"+Math.round(Number(e)).toString(16)).slice(-2);class ew{constructor(e,t,r){e/=255,t/=255,r/=255;let i=Math.max(e,t,r),l=i-Math.min(e,t,r),o=0!==l?i===e?(t-r)/l:i===t?2+(r-e)/l:4+(e-t)/l:0;this.h=60*o<0?60*o+360:60*o,this.s=0!==l?i<=.5?l/(2*i-l):l/(2-(2*i-l)):0,this.l=(2*i-l)/2}}let eE=void 0!==globalThis.document?globalThis.document.createElement("span"):void 0;class eA{static fromCss(e){let t=e;eE instanceof HTMLSpanElement&&(eE.style.color=e,document.body.appendChild(eE),t=getComputedStyle(eE).color,eE.remove());let[r,i,l,o]=t.match(/[\d.]+/g);return new eA(Number(r),Number(i),Number(l),null==o?1:Number(o))}static fromHsl(e,t,r,i=1){return eA.fromCss(`hsla(${e.toFixed(0)}, ${(100*t).toFixed(0)}%, ${(100*r).toFixed(0)}%, ${i.toFixed(2)})`)}constructor(e,t,r,i=1){this.r=e$(0,e,255),this.g=e$(0,t,255),this.b=e$(0,r,255),this.a=void 0!==i?e$(0,i,1):i=1}get inverse(){return new eA(255-this.r,255-this.g,255-this.b,this.a)}get inverseLuminance(){let{h:e,s:t,l:r}=this._hsl;return eA.fromHsl(e,t,1-r,this.a)}get rgb(){let{r:e,g:t,b:r}=this;return`rgb(${e.toFixed(0)},${t.toFixed(0)},${r.toFixed(0)})`}get rgba(){let{r:e,g:t,b:r,a:i}=this;return`rgba(${e.toFixed(0)},${t.toFixed(0)},${r.toFixed(0)},${i.toFixed(2)})`}get RGBA(){return[this.r/255,this.g/255,this.b/255,this.a]}get ARGB(){return[this.a,this.r/255,this.g/255,this.b/255]}get _hsl(){return null==this._hslCached&&(this._hslCached=new ew(this.r,this.g,this.b)),this._hslCached}get hsl(){let{h:e,s:t,l:r}=this._hsl;return`hsl(${e.toFixed(0)}, ${(100*t).toFixed(0)}%, ${(100*r).toFixed(0)}%)`}get hsla(){let{h:e,s:t,l:r}=this._hsl;return`hsla(${e.toFixed(0)}, ${(100*t).toFixed(0)}%, ${(100*r).toFixed(0)}%, ${this.a.toFixed(2)})`}get mono(){let e=255*this.brightness;return new eA(e,e,e)}get brightness(){return(.299*this.r+.587*this.g+.114*this.b)/255}get html(){return 1===this.a?"#"+ex(this.r)+ex(this.g)+ex(this.b):"#"+ex(this.r)+ex(this.g)+ex(this.b)+ex(Math.floor(255*this.a))}brighten(e){let{h:t,s:r,l:i}=this._hsl,l=e$(0,i+e*(1-i),1);return eA.fromHsl(t,r,l,this.a)}darken(e){let{h:t,s:r,l:i}=this._hsl,l=e$(0,i*(1-e),1);return eA.fromHsl(t,r,l,this.a)}saturate(e){let{h:t,s:r,l:i}=this._hsl,l=e$(0,r+e*(1-r),1);return eA.fromHsl(t,l,i,this.a)}desaturate(e){let{h:t,s:r,l:i}=this._hsl,l=e$(0,r*(1-e),1);return eA.fromHsl(t,l,i,this.a)}rotate(e){let{h:t,s:r,l:i}=this._hsl;return eA.fromHsl((t+360+e)%360,r,i,this.a)}opacity(e){let{h:t,s:r,l:i}=this._hsl;return eA.fromHsl(t,r,i,e)}swatch(){let{r:e,g:t,b:r,a:i}=this;console.log(`%c   %c ${this.html}, rgba(${e}, ${t}, ${r}, ${i}), ${this.hsla}`,`background-color: rgba(${e}, ${t}, ${r}, ${i})`,"background-color: #eee")}blend(e,t){return new eA(ey(this.r,e.r,t),ey(this.g,e.g,t),ey(this.b,e.b,t),ey(this.a,e.a,t))}}function e_(e){return e.replace(/[A-Z]/g,e=>`-${e.toLocaleLowerCase()}`)}let eS={},eM=(e,...t)=>{if(void 0===eS[e]){let[t,r]=e.split("|");void 0===r?eS[e]=globalThis.document.createElement(t):eS[e]=globalThis.document.createElementNS(r,t)}let r=eS[e].cloneNode(),i={};for(let e of t)e instanceof Element||e instanceof DocumentFragment||"string"==typeof e||"number"==typeof e?r instanceof HTMLTemplateElement?r.content.append(e):r.append(e):Object.assign(i,e);for(let e of Object.keys(i)){let t=i[e];if("apply"===e)t(r);else if("style"===e){if("object"==typeof t)for(let e of Object.keys(t))e.startsWith("--")?r.style.setProperty(e,t[e]):r.style[e]=t[e];else r.setAttribute("style",t)}else if(null!=e.match(/^on[A-Z]/)){let i=e.substring(2).toLowerCase();ei(r,i,t)}else if(null!=e.match(/^bind[A-Z]/)){let i=e.substring(4,5).toLowerCase()+e.substring(5),l=eg[i];if(void 0!==l)ee(r,t,l);else throw Error(`${e} is not allowed, bindings.${i} is not defined`)}else if(void 0!==r[e]){let{MathMLElement:i}=globalThis;r instanceof SVGElement||void 0!==i&&r instanceof i?r.setAttribute(e,t):r[e]=t}else{let i=e_(e);"class"===i?t.split(" ").forEach(e=>{r.classList.add(e)}):void 0!==r[i]?r[i]=t:"boolean"==typeof t?t?r.setAttribute(i,""):r.removeAttribute(i):r.setAttribute(i,t)}}return r},eC=(...e)=>{let t=globalThis.document.createDocumentFragment();for(let r of e)t.append(r);return t},eO=new Proxy({fragment:eC},{get:(e,t)=>(void 0===e[t=t.replace(/[A-Z]/g,e=>`-${e.toLocaleLowerCase()}`)]&&(e[t]=(...e)=>eM(t,...e)),e[t]),set(){throw Error("You may not add new properties to elements")}}),eL=new Proxy({fragment:eC},{get:(e,t)=>(void 0===e[t]&&(e[t]=(...e)=>eM(`${t}|http://www.w3.org/2000/svg`,...e)),e[t]),set(){throw Error("You may not add new properties to elements")}}),ek=new Proxy({fragment:eC},{get:(e,t)=>(void 0===e[t]&&(e[t]=(...e)=>eM(`${t}|http://www.w3.org/1998/Math/MathML`,...e)),e[t]),set(){throw Error("You may not add new properties to elements")}}),ej=["animation-iteration-count","flex","flex-base","flex-grow","flex-shrink","gap","opacity","order","tab-size","widows","z-index","zoom"],eP=(e,t,r)=>void 0===r?"":"string"==typeof r||ej.includes(t)?`${e}  ${t}: ${r};`:`${e}  ${t}: ${r}px;`,eT=(e,t,r="")=>{let i=e_(e);if("object"!=typeof t)return eP(r,i,t);{let i=Object.keys(t).map(e=>eT(e,t[e],`${r}  `)).join("\n");return`${r}  ${e} {
${i}
${r}  }`}},eD=(e,t="")=>{let r=Object.keys(e).map(r=>{let i=e[r];if("string"==typeof i){if("@import"===r)return`@import url('${i}');`;throw Error("top-level string value only allowed for `@import`")}let l=Object.keys(i).map(e=>eT(e,i[e])).join("\n");return`${t}${r} {
${l}
}`});return r.join("\n\n")},eF=e=>{let t={};for(let r of Object.keys(e)){let i=e[r],l=e_(r);t[`--${l}`]="number"==typeof i&&0!==i?String(i)+"px":i}return t},eR=e=>{let t={};for(let r of Object.keys(e)){let i=e[r];"string"==typeof i&&null!=i.match(/^(#|rgb[a]?\(|hsl[a]?\()/)&&(i=eA.fromCss(i).inverseLuminance.html,t[`--${e_(r)}`]=i)}return t},eN=new Proxy({},{get(e,t){if(null==e[t]){t=t.replace(/[A-Z]/g,e=>`-${e.toLocaleLowerCase()}`);let[,r,,i,l,o]=t.match(/^([^\d_]*)((_)?(\d+)(\w*))?$/),n=`--${r}`;if(null!=l){let r=null==i?Number(l)/100:-Number(l)/100;switch(o){case"b":{let i=getComputedStyle(document.body).getPropertyValue(n);e[t]=r>0?eA.fromCss(i).brighten(r).rgba:eA.fromCss(i).darken(-r).rgba}break;case"s":{let i=getComputedStyle(document.body).getPropertyValue(n);e[t]=r>0?eA.fromCss(i).saturate(r).rgba:eA.fromCss(i).desaturate(-r).rgba}break;case"h":{let i=getComputedStyle(document.body).getPropertyValue(n);e[t]=eA.fromCss(i).rotate(100*r).rgba,console.log(eA.fromCss(i).hsla,eA.fromCss(i).rotate(r).hsla)}break;case"o":{let i=getComputedStyle(document.body).getPropertyValue(n);e[t]=eA.fromCss(i).opacity(r).rgba}break;case"":e[t]=`calc(var(${n}) * ${r})`;break;default:throw console.error(o),Error(`Unrecognized method ${o} for css variable ${n}`)}}else e[t]=`var(${n})`}return e[t]}}),eq=new Proxy({},{get(e,t){if(void 0===e[t]){let r=`--${t.replace(/[A-Z]/g,e=>`-${e.toLocaleLowerCase()}`)}`;e[t]=e=>`var(${r}, ${e})`}return e[t]}}),eB=0;function eH(){return`custom-elt${(eB++).toString(36)}`}let eI=0;class eW extends HTMLElement{static #e=(()=>{this.elements=eO})();static StyleNode(e){return eO.style(eD(e))}static elementCreator(e){if(null==this._elementCreator){let t=null!=e?e.tag:null;for(null==t&&("string"==typeof this.name&&""!==this.name?(t=e_(this.name)).startsWith("-")&&(t=t.slice(1)):t=eH()),null!=customElements.get(t)&&console.warn(`${t} is already defined`),null==t.match(/\w+(-\w+)+/)&&(console.warn(`${t} is not a legal tag for a custom-element`),t=eH());void 0!==customElements.get(t);)t=eH();window.customElements.define(t,this,e),this._elementCreator=eO[t]}return this._elementCreator}initAttributes(...e){let t={},r={},l=new MutationObserver(t=>{let r=!1;t.forEach(t=>{r=!!(t.attributeName&&e.includes(t.attributeName.replace(/-([a-z])/g,(e,t)=>t.toLocaleUpperCase())))}),r&&void 0!==this.queueRender&&this.queueRender(!1)});l.observe(this,{attributes:!0}),e.forEach(e=>{t[e]=i(this[e]);let l=e_(e);Object.defineProperty(this,e,{enumerable:!1,get(){return"boolean"==typeof t[e]?this.hasAttribute(l):this.hasAttribute(l)?"number"==typeof t[e]?parseFloat(this.getAttribute(l)):this.getAttribute(l):void 0!==r[e]?r[e]:t[e]},set(i){"boolean"==typeof t[e]?i!==this[e]&&(i?this.setAttribute(l,""):this.removeAttribute(l),this.queueRender()):"number"==typeof t[e]?i!==parseFloat(this[e])&&(this.setAttribute(l,i),this.queueRender()):("object"==typeof i||`${i}`!=`${this[e]}`)&&(null==i||"object"==typeof i?this.removeAttribute(l):this.setAttribute(l,i),this.queueRender(),r[e]=i)}})})}initValue(){let e=Object.getOwnPropertyDescriptor(this,"value");if(void 0===e||void 0!==e.get||void 0!==e.set)return;let t=this.hasAttribute("value")?this.getAttribute("value"):i(this.value);delete this.value,Object.defineProperty(this,"value",{enumerable:!1,get:()=>t,set(e){t!==e&&(t=e,this.queueRender(!0))}})}get refs(){console.warn("refs and data-ref are deprecated, use the part attribute and .parts instead");let e=null!=this.shadowRoot?this.shadowRoot:this;return null==this._refs&&(this._refs=new Proxy({},{get(t,r){if(void 0===t[r]){let i=e.querySelector(`[part="${r}"],[data-ref="${r}"]`);if(null==i&&(i=e.querySelector(r)),null==i)throw Error(`elementRef "${r}" does not exist!`);i.removeAttribute("data-ref"),t[r]=i}return t[r]}})),this._refs}get parts(){let e=null!=this.shadowRoot?this.shadowRoot:this;return null==this._refs&&(this._refs=new Proxy({},{get(t,r){if(void 0===t[r]){let i=e.querySelector(`[part="${r}"]`);if(null==i&&(i=e.querySelector(r)),null==i)throw Error(`elementRef "${r}" does not exist!`);i.removeAttribute("data-ref"),t[r]=i}return t[r]}})),this._refs}constructor(){super(),this.content=eO.slot(),this._changeQueued=!1,this._renderQueued=!1,this._hydrated=!1,eI+=1,this.initAttributes("hidden"),this.instanceId=`${this.tagName.toLocaleLowerCase()}-${eI}`,this._value=i(this.defaultValue)}connectedCallback(){this.hydrate(),null!=this.role&&this.setAttribute("role",this.role),void 0!==this.onResize&&(eh.observe(this),null==this._onResize&&(this._onResize=this.onResize.bind(this)),this.addEventListener("resize",this._onResize)),null!=this.value&&null!=this.getAttribute("value")&&(this._value=this.getAttribute("value")),this.queueRender()}disconnectedCallback(){eh.unobserve(this)}queueRender(e=!1){this._hydrated&&(this._changeQueued||(this._changeQueued=e),this._renderQueued||(this._renderQueued=!0,requestAnimationFrame(()=>{this._changeQueued&&el(this,"change"),this._changeQueued=!1,this._renderQueued=!1,this.render()})))}hydrate(){if(!this._hydrated){this.initValue();let e="function"!=typeof this.content,t="function"==typeof this.content?this.content():this.content;if(void 0!==this.styleNode){let r=this.attachShadow({mode:"open"});r.appendChild(this.styleNode),eu(r,t,e)}else if(null!==t){let r=[...this.childNodes];eu(this,t,e),this.isSlotted=void 0!==this.querySelector("slot,xin-slot");let i=[...this.querySelectorAll("slot")];if(i.length>0&&i.forEach(ez.replaceSlot),r.length>0){let e={"":this};[...this.querySelectorAll("xin-slot")].forEach(t=>{e[t.name]=t}),r.forEach(t=>{let r=e[""],i=t instanceof Element?e[t.slot]:r;(void 0!==i?i:r).append(t)})}}this._hydrated=!0}}render(){}}class ez extends eW{static replaceSlot(e){let t=document.createElement("xin-slot");""!==e.name&&t.setAttribute("name",e.name),e.replaceWith(t)}constructor(){super(),this.name="",this.content=null,this.initAttributes("name")}}ez.elementCreator({tag:"xin-slot"});let eV=(e=()=>!0)=>{let t=localStorage.getItem("xin-state");if(null!=t){let r=JSON.parse(t);for(let t of Object.keys(r).filter(e))void 0!==J[t]?Object.assign(J[t],r[t]):J[t]=r[t]}let r=ed(()=>{let t={},r=J[h];for(let i of Object.keys(r).filter(e))t[i]=r[i];localStorage.setItem("xin-state",JSON.stringify(t)),console.log("xin state saved to localStorage")},500);G(e,r)};function eQ(e){let t={};return Object.keys(e).forEach(r=>{J[r]=e[r],t[r]=J[r]}),t}export{ee as bind,ei as on,eg as bindings,eD as css,eR as darkMode,eF as initVars,eN as vars,eq as varDefault,eA as Color,eW as Component,eO as elements,eL as svgElements,ek as mathML,eV as hotReload,m as getListItem,u as xinPath,d as xinValue,ev as MoreMath,r as settings,ec as throttle,ed as debounce,J as xin,G as observe,S as unobserve,A as touch,g as observerShouldBeRemoved,w as updates,eQ as xinProxy};
//# sourceMappingURL=index.js.map
