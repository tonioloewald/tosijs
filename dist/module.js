var O={debug:!1,perf:!1};function E(n){if(n==null||typeof n!=="object")return n;if(Array.isArray(n))return n.map(E);let e={};for(let o in n){let i=n[o];if(n!=null&&typeof n==="object")e[o]=E(i);else e[o]=i}return e}var fn="-xin-data",k=`.${fn}`,ln="-xin-event",un=`.${ln}`,a="xinPath",v="xinValue",Wn="xinObserve",Yn="xinBind",S=(n)=>{return n&&n[a]};function x(n){return typeof n==="object"&&n!==null?n[v]||n:n}var $=new WeakMap,T=new WeakMap;var L=(n)=>{let e=n.cloneNode();if(e instanceof Element){let o=T.get(n),i=$.get(n);if(o!=null)T.set(e,E(o));if(i!=null)$.set(e,E(i))}for(let o of n instanceof HTMLTemplateElement?n.content.childNodes:n.childNodes)if(o instanceof Element||o instanceof DocumentFragment)e.appendChild(L(o));else e.appendChild(o.cloneNode());return e},j=new WeakMap,yn=(n)=>{let e=document.body.parentElement;while(n.parentElement!=null&&n.parentElement!==e){let o=j.get(n);if(o!=null)return o;n=n.parentElement}return!1};var Jn=Symbol("observer should be removed"),_=[],N=[],mn=!1,pn,an;class Un{description;test;callback;constructor(n,e){let o=typeof e==="string"?`"${e}"`:`function ${e.name}`,i;if(typeof n==="string")this.test=(s)=>typeof s==="string"&&s!==""&&(n.startsWith(s)||s.startsWith(n)),i=`test = "${n}"`;else if(n instanceof RegExp)this.test=n.test.bind(n),i=`test = "${n.toString()}"`;else if(n instanceof Function)this.test=n,i=`test = function ${n.name}`;else throw new Error("expect listener test to be a string, RegExp, or test function");if(this.description=`${i}, ${o}`,typeof e==="function")this.callback=e;else throw new Error("expect callback to be a path or function");_.push(this)}}var jn=async()=>{if(pn===void 0)return;await pn},xe=()=>{if(O.perf)console.time("xin async update");let n=Array.from(N);for(let e of n)_.filter((o)=>{let i;try{i=o.test(e)}catch(s){throw new Error(`Listener ${o.description} threw "${s}" at "${e}"`)}if(i===Jn)return q(o),!1;return i}).forEach((o)=>{let i;try{i=o.callback(e)}catch(s){console.error(`Listener ${o.description} threw "${s}" handling "${e}"`)}if(i===Jn)q(o)});if(N.splice(0),mn=!1,typeof an==="function")an();if(O.perf)console.timeEnd("xin async update")},I=(n)=>{let e=typeof n==="string"?n:S(n);if(e===void 0)throw console.error("touch was called on an invalid target",n),new Error("touch was called on an invalid target");if(mn===!1)pn=new Promise((o)=>{an=o}),mn=setTimeout(xe);if(N.find((o)=>e.startsWith(o))==null)N.push(e)},xn=(n,e)=>{return new Un(n,e)},q=(n)=>{let e=_.indexOf(n);if(e>-1)_.splice(e,1);else throw new Error("unobserve failed, listener not found")};var he=(n)=>{try{return JSON.stringify(n)}catch(e){return"{has circular references}"}},hn=(...n)=>new Error(n.map(he).join(" "));var be=()=>new Date(parseInt("1000000000",36)+Date.now()).valueOf().toString(36).slice(1),Xe=0,we=()=>(parseInt("10000",36)+ ++Xe).toString(36).slice(-5),ge=()=>be()+we(),bn={},Zn={};function Pn(n){if(n==="")return[];if(Array.isArray(n))return n;else{let e=[];while(n.length>0){let o=n.search(/\[[^\]]+\]/);if(o===-1){e.push(n.split("."));break}else{let i=n.slice(0,o);if(n=n.slice(o),i!=="")e.push(i.split("."));if(o=n.indexOf("]")+1,e.push(n.slice(1,o-1)),n.slice(o,o+1)===".")o+=1;n=n.slice(o)}}return e}}var C=new WeakMap;function Qn(n,e){if(C.get(n)===void 0)C.set(n,{});if(C.get(n)[e]===void 0)C.get(n)[e]={};let o=C.get(n)[e];if(e==="_auto_")n.forEach((i,s)=>{if(i._auto_===void 0)i._auto_=ge();o[i._auto_+""]=s});else n.forEach((i,s)=>{o[W(i,e)+""]=s});return o}function Ee(n,e){if(C.get(n)===void 0||C.get(n)[e]===void 0)return Qn(n,e);else return C.get(n)[e]}function Te(n,e,o){o=o+"";let i=Ee(n,e)[o];if(i===void 0||W(n[i],e)+""!==o)i=Qn(n,e)[o];return i}function Ce(n,e,o){if(n[e]===void 0&&o!==void 0)n[e]=o;return n[e]}function Rn(n,e,o,i){let s=e!==""?Te(n,e,o):o;if(i===bn)return n.splice(s,1),C.delete(n),Symbol("deleted");else if(i===Zn){if(e===""&&n[s]===void 0)n[s]={}}else if(i!==void 0)if(s!==void 0)n[s]=i;else if(e!==""&&W(i,e)+""===o+"")n.push(i),s=n.length-1;else throw new Error(`byIdPath insert failed at [${e}=${o}]`);return n[s]}function qn(n){if(!Array.isArray(n))throw hn("setByPath failed: expected array, found",n)}function Gn(n){if(n==null||!(n instanceof Object))throw hn("setByPath failed: expected Object, found",n)}function W(n,e){let o=Pn(e),i=n,s,t,r,c;for(s=0,t=o.length;i!==void 0&&s<t;s++){let d=o[s];if(Array.isArray(d))for(r=0,c=d.length;i!==void 0&&r<c;r++){let u=d[r];i=i[u]}else if(i.length===0){if(i=i[d.slice(1)],d[0]!=="=")return}else if(d.includes("=")){let[u,...b]=d.split("=");i=Rn(i,u,b.join("="))}else r=parseInt(d,10),i=i[r]}return i}function Vn(n,e,o){let i=n,s=Pn(e);while(i!=null&&s.length>0){let t=s.shift();if(typeof t==="string"){let r=t.indexOf("=");if(r>-1){if(r===0)Gn(i);else qn(i);let c=t.slice(0,r),d=t.slice(r+1);if(i=Rn(i,c,d,s.length>0?Zn:o),s.length===0)return!0}else{qn(i);let c=parseInt(t,10);if(s.length>0)i=i[c];else{if(o!==bn){if(i[c]===o)return!1;i[c]=o}else i.splice(c,1);return!0}}}else if(Array.isArray(t)&&t.length>0){Gn(i);while(t.length>0){let r=t.shift();if(t.length>0||s.length>0)i=Ce(i,r,t.length>0?{}:[]);else{if(o!==bn){if(i[r]===o)return!1;i[r]=o}else{if(!Object.prototype.hasOwnProperty.call(i,r))return!1;delete i[r]}return!0}}}else throw new Error(`setByPath failed, bad path ${e}`)}throw new Error(`setByPath(${n}, ${e}, ${o}) failed`)}var ke=["sort","splice","copyWithin","fill","pop","push","reverse","shift","unshift"],wn={},Se=!0,Me=/^\.?([^.[\](),])+(\.[^.[\](),]+|\[\d+\]|\[[^=[\](),]*=[^[\]()]+\])*$/,De=(n)=>Me.test(n),H=(n="",e="")=>{if(n==="")return e;else if(e.match(/^\d+$/)!==null||e.includes("="))return`${n}[${e}]`;else return`${n}.${e}`},Fe={string(n){return new String(n)},boolean(n){return new Boolean(n)},bigint(n){return n},symbol(n){return n},number(n){return new Number(n)}};function Xn(n,e){let o=typeof n;if(n===void 0||o==="object"||o==="function")return n;else return new Proxy(Fe[typeof n](n),Y(e,!0))}var Y=(n,e)=>({get(o,i){switch(i){case a:return n;case v:return x(o);case Wn:return(r)=>{let c=xn(n,r);return()=>q(c)};case Yn:return(r,c,d)=>{M(r,n,c,d)}}if(typeof i==="symbol")return o[i];let s=i,t=s.match(/^([^.[]+)\.(.+)$/)??s.match(/^([^\]]+)(\[.+)/)??s.match(/^(\[[^\]]+\])\.(.+)$/)??s.match(/^(\[[^\]]+\])\[(.+)$/);if(t!==null){let[,r,c]=t,d=H(n,r),u=W(o,r);return u!==null&&typeof u==="object"?new Proxy(u,Y(d,e))[c]:u}if(s.startsWith("[")&&s.endsWith("]"))s=s.substring(1,s.length-1);if(!Array.isArray(o)&&o[s]!==void 0||Array.isArray(o)&&s.includes("=")){let r;if(s.includes("=")){let[c,d]=s.split("=");r=o.find((u)=>`${W(u,c)}`===d)}else r=o[s];if(r!==null&&typeof r==="object"){let c=H(n,s);return new Proxy(r,Y(c,e))}else if(typeof r==="function")return r.bind(o);else return e?Xn(r,H(n,s)):r}else if(Array.isArray(o)){let r=o[s];return typeof r==="function"?(...c)=>{let d=r.apply(o,c);if(ke.includes(s))I(n);return d}:typeof r==="object"?new Proxy(r,Y(H(n,s),e)):e?Xn(r,H(n,s)):r}else return e?Xn(o[s],H(n,s)):o[s]},set(o,i,s){s=x(s);let t=i!==v?H(n,i):n;if(Se&&!De(t))throw new Error(`setting invalid path ${t}`);if(x(l[t])!==s&&Vn(wn,t,s))I(t);return!0}}),G=(n,e)=>{let o=typeof e==="function"?e:l[e];if(typeof o!=="function")throw new Error(`observe expects a function or path to a function, ${e} is neither`);return xn(n,o)},l=new Proxy(wn,Y("",!1)),J=new Proxy(wn,Y("",!0));var{document:Z,MutationObserver:Kn}=globalThis,ne=(n,e)=>{let o=T.get(n);if(o==null)return;for(let i of o){let{binding:s,options:t}=i,{path:r}=i,{toDOM:c}=s;if(c!=null){if(r.startsWith("^")){let d=yn(n);if(d!=null&&d[a]!=null)r=i.path=`${d[a]}${r.substring(1)}`;else throw console.error(`Cannot resolve relative binding ${r}`,n,"is not part of a list"),new Error(`Cannot resolve relative binding ${r}`)}if(e==null||r.startsWith(e))c(n,l[r],t)}}};if(Kn!=null)new Kn((e)=>{e.forEach((o)=>{Array.from(o.addedNodes).forEach((i)=>{if(i instanceof Element)Array.from(i.querySelectorAll(k)).forEach((s)=>ne(s))})})}).observe(Z.body,{subtree:!0,childList:!0});G(()=>!0,(n)=>{let e=Array.from(Z.querySelectorAll(k));for(let o of e)ne(o,n)});var _n=(n)=>{let e=n.target.closest(k);while(e!=null){let o=T.get(e);for(let i of o){let{binding:s,path:t}=i,{fromDOM:r}=s;if(r!=null){let c;try{c=r(e,i.options)}catch(d){throw console.error("Cannot get value from",e,"via",i),new Error("Cannot obtain value fromDOM")}if(c!=null){let d=l[t];if(d==null)l[t]=c;else{let u=d[a]!=null?d[v]:d,b=c[a]!=null?c[v]:c;if(u!==b)l[t]=b}}}}e=e.parentElement.closest(k)}};if(globalThis.document!=null)Z.body.addEventListener("change",_n,!0),Z.body.addEventListener("input",_n,!0);function M(n,e,o,i){if(n instanceof DocumentFragment)throw new Error("bind cannot bind to a DocumentFragment");let s;if(typeof e==="object"&&e[a]===void 0&&i===void 0){let{value:c}=e;s=typeof c==="string"?c:c[a],i=e,delete i.value}else s=typeof e==="string"?e:e[a];if(s==null)throw new Error("bind requires a path or object with xin Proxy");let{toDOM:t}=o;n.classList?.add(fn);let r=T.get(n);if(r==null)r=[],T.set(n,r);if(r.push({path:s,binding:o,options:i}),t!=null&&!s.startsWith("^"))I(s);return n}var Nn=new Set,Oe=(n)=>{let e=n?.target.closest(un),o=!1,i=new Proxy(n,{get(s,t){if(t==="stopPropagation")return()=>{n.stopPropagation(),o=!0};else{let r=s[t];return typeof r==="function"?r.bind(s):r}}});while(!o&&e!=null){let t=$.get(e)[n.type]||[];for(let r of t){if(typeof r==="function")r(i);else{let c=l[r];if(typeof c==="function")c(i);else throw new Error(`no event handler found at path ${r}`)}if(o)continue}e=e.parentElement!=null?e.parentElement.closest(un):null}},gn=(n,e,o)=>{let i=$.get(n);if(n.classList.add(ln),i==null)i={},$.set(n,i);if(!i[e])i[e]=[];if(!i[e].includes(o))i[e].push(o);if(!Nn.has(e))Nn.add(e),Z.body.addEventListener(e,Oe,!0)};var En=(n,e)=>{let o=new Event(e);n.dispatchEvent(o)},oe=(n)=>{if(n instanceof HTMLInputElement)return n.type;else if(n instanceof HTMLSelectElement&&n.hasAttribute("multiple"))return"multi-select";else return"other"},Tn=(n,e)=>{switch(oe(n)){case"radio":n.checked=n.value===e;break;case"checkbox":n.checked=!!e;break;case"date":n.valueAsDate=new Date(e);break;case"multi-select":for(let o of Array.from(n.querySelectorAll("option")))o.selected=e[o.value];break;default:n.value=e}},ie=(n)=>{switch(oe(n)){case"radio":{let e=n.parentElement?.querySelector(`[name="${n.name}"]:checked`);return e!=null?e.value:null}case"checkbox":return n.checked;case"date":return n.valueAsDate?.toISOString();case"multi-select":return Array.from(n.querySelectorAll("option")).reduce((e,o)=>{return e[o.value]=o.selected,e},{});default:return n.value}},{ResizeObserver:ee}=globalThis,P=ee!=null?new ee((n)=>{for(let e of n){let o=e.target;En(o,"resize")}}):{observe(){},unobserve(){}},Cn=(n,e,o=!0)=>{if(n!=null&&e!=null)if(typeof e==="string")n.textContent=e;else if(Array.isArray(e))e.forEach((i)=>{n.append(i instanceof Node&&o?L(i):i)});else if(e instanceof Node)n.append(o?L(e):e);else throw new Error("expect text content or document node")};var kn=(n,e=250)=>{let o;return(...i)=>{if(o!==void 0)clearTimeout(o);o=setTimeout(()=>{n(...i)},e)}},Sn=(n,e=250)=>{let o,i=Date.now()-e,s=!1;return(...t)=>{if(clearTimeout(o),o=setTimeout(async()=>{n(...t),i=Date.now()},e),!s&&Date.now()-i>=e){s=!0;try{n(...t),i=Date.now()}finally{s=!1}}}};var se=Symbol("list-binding"),$e=16;function re(n,e){let o=Array.from(n.querySelectorAll(k));if(n.matches(k))o.unshift(n);for(let i of o){let s=T.get(i);for(let t of s){if(t.path.startsWith("^"))t.path=`${e}${t.path.substring(1)}`;if(t.binding.toDOM!=null)t.binding.toDOM(i,l[t.path])}}}class te{boundElement;listTop;listBottom;template;options;itemToElement;_array=[];_update;_previousSlice;constructor(n,e={}){if(this.boundElement=n,this.itemToElement=new WeakMap,n.children.length!==1)throw new Error("ListBinding expects an element with exactly one child element");if(n.children[0]instanceof HTMLTemplateElement){let o=n.children[0];if(o.content.children.length!==1)throw new Error("ListBinding expects a template with exactly one child element");this.template=L(o.content.children[0])}else this.template=n.children[0],this.template.remove();if(this.listTop=document.createElement("div"),this.listBottom=document.createElement("div"),this.boundElement.append(this.listTop),this.boundElement.append(this.listBottom),this.options=e,e.virtual!=null)P.observe(this.boundElement),this._update=Sn(()=>{this.update(this._array,!0)},$e),this.boundElement.addEventListener("scroll",this._update),this.boundElement.addEventListener("resize",this._update)}visibleSlice(){let{virtual:n,hiddenProp:e,visibleProp:o}=this.options,i=this._array;if(e!==void 0)i=i.filter((d)=>d[e]!==!0);if(o!==void 0)i=i.filter((d)=>d[o]===!0);let s=0,t=i.length-1,r=0,c=0;if(n!=null&&this.boundElement instanceof HTMLElement){let d=this.boundElement.offsetWidth,u=this.boundElement.offsetHeight,b=n.width!=null?Math.max(1,Math.floor(d/n.width)):1,A=Math.ceil(u/n.height)+1,z=Math.ceil(i.length/b),V=b*A,F=Math.floor(this.boundElement.scrollTop/n.height);if(F>z-A+1)F=Math.max(0,z-A+1);s=F*b,t=s+V-1,r=F*n.height,c=Math.max(z*n.height-u-r,0)}return{items:i,firstItem:s,lastItem:t,topBuffer:r,bottomBuffer:c}}update(n,e){if(n==null)n=[];this._array=n;let{hiddenProp:o,visibleProp:i}=this.options,s=S(n),t=this.visibleSlice();this.boundElement.classList.toggle("-xin-empty-list",t.items.length===0);let r=this._previousSlice,{firstItem:c,lastItem:d,topBuffer:u,bottomBuffer:b}=t;if(o===void 0&&i===void 0&&e===!0&&r!=null&&c===r.firstItem&&d===r.lastItem)return;this._previousSlice=t;let A=0,z=0,V=0;for(let y of Array.from(this.boundElement.children)){if(y===this.listTop||y===this.listBottom)continue;let X=j.get(y);if(X==null)y.remove();else{let p=t.items.indexOf(X);if(p<c||p>d)y.remove(),this.itemToElement.delete(X),j.delete(y),A++}}this.listTop.style.height=String(u)+"px",this.listBottom.style.height=String(b)+"px";let F=[],{idPath:cn}=this.options;for(let y=c;y<=d;y++){let X=t.items[y];if(X===void 0)continue;let p=this.itemToElement.get(x(X));if(p==null){if(V++,p=L(this.template),typeof X==="object")this.itemToElement.set(x(X),p),j.set(p,x(X));if(this.boundElement.insertBefore(p,this.listBottom),cn!=null){let dn=X[cn],ae=`${s}[${cn}=${dn}]`;re(p,ae)}else{let dn=`${s}[${y}]`;re(p,dn)}}F.push(p)}let K=null;for(let y of F){if(y.previousElementSibling!==K)if(z++,K?.nextElementSibling!=null)this.boundElement.insertBefore(y,K.nextElementSibling);else this.boundElement.insertBefore(y,this.listBottom);K=y}if(O.perf)console.log(s,"updated",{removed:A,created:V,moved:z})}}var ce=(n,e)=>{let o=n[se];if(o===void 0)o=new te(n,e),n[se]=o;return o};var nn={value:{toDOM:Tn,fromDOM(n){return ie(n)}},set:{toDOM:Tn},text:{toDOM(n,e){n.textContent=e}},enabled:{toDOM(n,e){n.disabled=!e}},disabled:{toDOM(n,e){n.disabled=Boolean(e)}},style:{toDOM(n,e){}},callback:{toDOM(n,e,o){if(o?.callback)o.callback(n,e);else if(e instanceof Function)e(n)}},list:{toDOM(n,e,o){ce(n,o).update(e)}}};var Bo=180/Math.PI,Ao=Math.PI/180;function h(n,e,o){return e<n?n:e>o?o:e}function w(n,e,o){return o=h(0,o,1),o*(e-n)+n}var ve={clamp:h,lerp:w};var Le=(n,e,o)=>{return(0.299*n+0.587*e+0.114*o)/255},B=(n)=>("00"+Math.round(Number(n)).toString(16)).slice(-2);class de{h;s;l;constructor(n,e,o){n/=255,e/=255,o/=255;let i=Math.max(n,e,o),s=i-Math.min(n,e,o),t=s!==0?i===n?(e-o)/s:i===e?2+(o-n)/s:4+(n-e)/s:0;this.h=60*t<0?60*t+360:60*t,this.s=s!==0?i<=0.5?s/(2*i-s):s/(2-(2*i-s)):0,this.l=(2*i-s)/2}}var Q=globalThis.document!==void 0?globalThis.document.createElement("span"):void 0;class f{r;g;b;a;static fromCss(n){let e=n;if(Q instanceof HTMLSpanElement)Q.style.color=n,document.body.appendChild(Q),e=getComputedStyle(Q).color,Q.remove();let[o,i,s,t]=e.match(/[\d.]+/g);return new f(Number(o),Number(i),Number(s),t==null?1:Number(t))}static fromHsl(n,e,o,i=1){return f.fromCss(`hsla(${n.toFixed(0)}, ${(e*100).toFixed(0)}%, ${(o*100).toFixed(0)}%, ${i.toFixed(2)})`)}constructor(n,e,o,i=1){this.r=h(0,n,255),this.g=h(0,e,255),this.b=h(0,o,255),this.a=i!==void 0?h(0,i,1):i=1}get inverse(){return new f(255-this.r,255-this.g,255-this.b,this.a)}get inverseLuminance(){let{h:n,s:e,l:o}=this._hsl;return f.fromHsl(n,e,1-o,this.a)}get rgb(){let{r:n,g:e,b:o}=this;return`rgb(${n.toFixed(0)},${e.toFixed(0)},${o.toFixed(0)})`}get rgba(){let{r:n,g:e,b:o,a:i}=this;return`rgba(${n.toFixed(0)},${e.toFixed(0)},${o.toFixed(0)},${i.toFixed(2)})`}get RGBA(){return[this.r/255,this.g/255,this.b/255,this.a]}get ARGB(){return[this.a,this.r/255,this.g/255,this.b/255]}hslCached;get _hsl(){if(this.hslCached==null)this.hslCached=new de(this.r,this.g,this.b);return this.hslCached}get hsl(){let{h:n,s:e,l:o}=this._hsl;return`hsl(${n.toFixed(0)}, ${(e*100).toFixed(0)}%, ${(o*100).toFixed(0)}%)`}get hsla(){let{h:n,s:e,l:o}=this._hsl;return`hsla(${n.toFixed(0)}, ${(e*100).toFixed(0)}%, ${(o*100).toFixed(0)}%, ${this.a.toFixed(2)})`}get mono(){let n=this.brightness*255;return new f(n,n,n)}get brightness(){return Le(this.r,this.g,this.b)}get html(){return this.toString()}toString(){return this.a===1?"#"+B(this.r)+B(this.g)+B(this.b):"#"+B(this.r)+B(this.g)+B(this.b)+B(Math.floor(255*this.a))}brighten(n){let{h:e,s:o,l:i}=this._hsl,s=h(0,i+n*(1-i),1);return f.fromHsl(e,o,s,this.a)}darken(n){let{h:e,s:o,l:i}=this._hsl,s=h(0,i*(1-n),1);return f.fromHsl(e,o,s,this.a)}saturate(n){let{h:e,s:o,l:i}=this._hsl,s=h(0,o+n*(1-o),1);return f.fromHsl(e,s,i,this.a)}desaturate(n){let{h:e,s:o,l:i}=this._hsl,s=h(0,o*(1-n),1);return f.fromHsl(e,s,i,this.a)}rotate(n){let{h:e,s:o,l:i}=this._hsl,s=(e+360+n)%360;return f.fromHsl(s,o,i,this.a)}opacity(n){let{h:e,s:o,l:i}=this._hsl;return f.fromHsl(e,o,i,n)}swatch(){let{r:n,g:e,b:o,a:i}=this;return console.log(`%c      %c ${this.html}, rgba(${n}, ${e}, ${o}, ${i}), ${this.hsla}`,`background-color: rgba(${n}, ${e}, ${o}, ${i})`,"background-color: transparent"),this}blend(n,e){return new f(w(this.r,n.r,e),w(this.g,n.g,e),w(this.b,n.b,e),w(this.a,n.a,e))}mix(n,e){let o=this._hsl,i=n._hsl;return f.fromHsl(w(o.h,i.h,e),w(o.s,i.s,e),w(o.l,i.l,e),w(this.a,n.a,e))}}function g(n){return n.replace(/[A-Z]/g,(e)=>{return`-${e.toLocaleLowerCase()}`})}function fe(n){return n.replace(/-([a-z])/g,(e,o)=>{return o.toLocaleUpperCase()})}var He="http://www.w3.org/1998/Math/MathML",Be="http://www.w3.org/2000/svg",en={},le=(n,e,o)=>{let i=$n(g(e),o);if(i.prop.startsWith("--"))n.style.setProperty(i.prop,i.value);else n.style[e]=i.value},Ae=(n)=>{return{toDOM(e,o){le(e,n,o)}}},ue=(n,e,o)=>{if(e==="style")if(typeof o==="object")for(let i of Object.keys(o))if(S(o[i]))console.log(i,o[i]),M(n,o[i],Ae(i));else le(n,i,o[i]);else n.setAttribute("style",o);else if(n[e]!==void 0){let{MathMLElement:i}=globalThis;if(n instanceof SVGElement||i!==void 0&&n instanceof i)n.setAttribute(e,o);else n[e]=o}else{let i=g(e);if(i==="class")o.split(" ").forEach((s)=>{n.classList.add(s)});else if(n[i]!==void 0)n[i]=o;else if(typeof o==="boolean")o?n.setAttribute(i,""):n.removeAttribute(i);else n.setAttribute(i,o)}},ze=(n)=>{return{toDOM(e,o){ue(e,n,o)}}},Ie=(n,e,o)=>{if(e==="apply")o(n);else if(e.match(/^on[A-Z]/)!=null){let i=e.substring(2).toLowerCase();gn(n,i,o)}else if(e==="bind")if((typeof o.binding==="string"?nn[o.binding]:o.binding)!==void 0&&o.value!==void 0)M(n,o.value,o.binding instanceof Function?{toDOM:o.binding}:o.binding);else throw new Error("bad binding");else if(e.match(/^bind[A-Z]/)!=null){let i=e.substring(4,5).toLowerCase()+e.substring(5),s=nn[i];if(s!==void 0)M(n,o,s);else throw new Error(`${e} is not allowed, bindings.${i} is not defined`)}else if(S(o))M(n,o,ze(e));else ue(n,e,o)},Mn=(n,...e)=>{if(en[n]===void 0){let[s,t]=n.split("|");if(t===void 0)en[n]=globalThis.document.createElement(s);else en[n]=globalThis.document.createElementNS(t,s)}let o=en[n].cloneNode(),i={};for(let s of e)if(s instanceof Element||s instanceof DocumentFragment||typeof s==="string"||typeof s==="number")if(o instanceof HTMLTemplateElement)o.content.append(s);else o.append(s);else if(s.xinPath)o.append(m.span({bindText:s}));else Object.assign(i,s);for(let s of Object.keys(i)){let t=i[s];Ie(o,s,t)}return o},Dn=(...n)=>{let e=globalThis.document.createDocumentFragment();for(let o of n)e.append(o);return e},m=new Proxy({fragment:Dn},{get(n,e){if(e=e.replace(/[A-Z]/g,(o)=>`-${o.toLocaleLowerCase()}`),n[e]===void 0)n[e]=(...o)=>Mn(e,...o);return n[e]},set(){throw new Error("You may not add new properties to elements")}}),Fn=new Proxy({fragment:Dn},{get(n,e){if(n[e]===void 0)n[e]=(...o)=>Mn(`${e}|${Be}`,...o);return n[e]},set(){throw new Error("You may not add new properties to elements")}}),On=new Proxy({fragment:Dn},{get(n,e){if(n[e]===void 0)n[e]=(...o)=>Mn(`${e}|${He}`,...o);return n[e]},set(){throw new Error("You may not add new properties to elements")}});function We(n,e){let o=m.style(U(e));o.id=n,document.head.append(o)}var Ye=["animation-iteration-count","flex","flex-base","flex-grow","flex-shrink","opacity","order","tab-size","widows","z-index","zoom"],$n=(n,e)=>{if(typeof e==="number"&&!Ye.includes(n))e=`${e}px`;if(n.startsWith("_"))if(n.startsWith("__"))n="--"+n.substring(2),e=`var(${n}-default, ${e})`;else n="--"+n.substring(1);return{prop:n,value:String(e)}},Je=(n,e,o)=>{if(o===void 0)return"";if(o instanceof f)o=o.html;let i=$n(e,o);return`${n}  ${i.prop}: ${i.value};`},ye=(n,e,o="")=>{let i=g(n);if(typeof e==="object"&&!(e instanceof f)){let s=Object.keys(e).map((t)=>ye(t,e[t],`${o}  `)).join(`
`);return`${o}  ${n} {
${s}
${o}  }`}else return Je(o,i,e)},U=(n,e="")=>{return Object.keys(n).map((i)=>{let s=n[i];if(typeof s==="string"){if(i==="@import")return`@import url('${s}');`;throw new Error("top-level string value only allowed for `@import`")}let t=Object.keys(s).map((r)=>ye(r,s[r])).join(`
`);return`${e}${i} {
${t}
}`}).join(`

`)},Ue=(n)=>{console.warn("initVars is deprecated. Just use _ and __ prefixes instead.");let e={};for(let o of Object.keys(n)){let i=n[o],s=g(o);e[`--${s}`]=typeof i==="number"&&i!==0?String(i)+"px":i}return e},je=(n)=>{console.warn("darkMode is deprecated. Use inverseLuminance instead.");let e={};for(let o of Object.keys(n)){let i=n[o];if(typeof i==="string"&&i.match(/^(#|rgb[a]?\(|hsl[a]?\()/)!=null)i=f.fromCss(i).inverseLuminance.html,e[`--${g(o)}`]=i}return e},qe=(n)=>{let e={};for(let o of Object.keys(n)){let i=n[o];if(i instanceof f)e[o]=i.inverseLuminance;else if(typeof i==="string"&&i.match(/^(#[0-9a-fA-F]{3}|rgba?\(|hsla?\()/))e[o]=f.fromCss(i).inverseLuminance}return e},on=new Proxy({},{get(n,e){if(n[e]===void 0){let o=`--${e.replace(/[A-Z]/g,(i)=>`-${i.toLocaleLowerCase()}`)}`;n[e]=(i)=>`var(${o}, ${i})`}return n[e]}}),vn=new Proxy({},{get(n,e){if(e==="default")return on;if(n[e]==null){e=e.replace(/[A-Z]/g,(c)=>`-${c.toLocaleLowerCase()}`);let[,o,,i,s,t]=e.match(/^([^\d_]*)((_)?(\d+)(\w*))?$/),r=`--${o}`;if(s!=null){let c=i==null?Number(s)/100:-Number(s)/100;switch(t){case"b":{let d=getComputedStyle(document.body).getPropertyValue(r);n[e]=c>0?f.fromCss(d).brighten(c).rgba:f.fromCss(d).darken(-c).rgba}break;case"s":{let d=getComputedStyle(document.body).getPropertyValue(r);n[e]=c>0?f.fromCss(d).saturate(c).rgba:f.fromCss(d).desaturate(-c).rgba}break;case"h":{let d=getComputedStyle(document.body).getPropertyValue(r);n[e]=f.fromCss(d).rotate(c*100).rgba,console.log(f.fromCss(d).hsla,f.fromCss(d).rotate(c).hsla)}break;case"o":{let d=getComputedStyle(document.body).getPropertyValue(r);n[e]=f.fromCss(d).opacity(c).rgba}break;case"":n[e]=`calc(var(${r}) * ${c})`;break;default:throw console.error(t),new Error(`Unrecognized method ${t} for css variable ${r}`)}}else n[e]=`var(${r})`}return n[e]}});var Ge=0;function Ln(){return`custom-elt${(Ge++).toString(36)}`}var me=0,R={};function Ze(n,e){let o=R[n],i=U(e).replace(/:host\b/g,n);R[n]=o?o+`
`+i:i}function Pe(n){if(R[n])document.head.append(m.style({id:n+"-component"},R[n]));delete R[n]}class D extends HTMLElement{static elements=m;static _elementCreator;instanceId;styleNode;static styleSpec;static styleNode;content=m.slot();isSlotted;static _tagName=null;static get tagName(){return this._tagName}static StyleNode(n){return console.warn("StyleNode is deprecated, just assign static styleSpec: XinStyleSheet to the class directly"),m.style(U(n))}static elementCreator(n={}){if(this._elementCreator==null){let{tag:e,styleSpec:o}=n,i=n!=null?e:null;if(i==null)if(typeof this.name==="string"&&this.name!==""){if(i=g(this.name),i.startsWith("-"))i=i.slice(1)}else i=Ln();if(customElements.get(i)!=null)console.warn(`${i} is already defined`);if(i.match(/\w+(-\w+)+/)==null)console.warn(`${i} is not a legal tag for a custom-element`),i=Ln();while(customElements.get(i)!==void 0)i=Ln();if(this._tagName=i,o!==void 0)Ze(i,o);window.customElements.define(i,this,n),this._elementCreator=m[i]}return this._elementCreator}initAttributes(...n){let e={},o={};new MutationObserver((s)=>{let t=!1;if(s.forEach((r)=>{t=!!(r.attributeName&&n.includes(fe(r.attributeName)))}),t&&this.queueRender!==void 0)this.queueRender(!1)}).observe(this,{attributes:!0}),n.forEach((s)=>{e[s]=E(this[s]);let t=g(s);Object.defineProperty(this,s,{enumerable:!1,get(){if(typeof e[s]==="boolean")return this.hasAttribute(t);else if(this.hasAttribute(t))return typeof e[s]==="number"?parseFloat(this.getAttribute(t)):this.getAttribute(t);else if(o[s]!==void 0)return o[s];else return e[s]},set(r){if(typeof e[s]==="boolean"){if(r!==this[s]){if(r)this.setAttribute(t,"");else this.removeAttribute(t);this.queueRender()}}else if(typeof e[s]==="number"){if(r!==parseFloat(this[s]))this.setAttribute(t,r),this.queueRender()}else if(typeof r==="object"||`${r}`!==`${this[s]}`){if(r===null||r===void 0||typeof r==="object")this.removeAttribute(t);else this.setAttribute(t,r);this.queueRender(),o[s]=r}}})})}initValue(){let n=Object.getOwnPropertyDescriptor(this,"value");if(n===void 0||n.get!==void 0||n.set!==void 0)return;let e=this.hasAttribute("value")?this.getAttribute("value"):E(this.value);delete this.value,Object.defineProperty(this,"value",{enumerable:!1,get(){return e},set(o){if(e!==o)e=o,this.queueRender(!0)}})}_parts;get parts(){let n=this.shadowRoot!=null?this.shadowRoot:this;if(this._parts==null)this._parts=new Proxy({},{get(e,o){if(e[o]===void 0){let i=n.querySelector(`[part="${o}"]`);if(i==null)i=n.querySelector(o);if(i==null)throw new Error(`elementRef "${o}" does not exist!`);i.removeAttribute("data-ref"),e[o]=i}return e[o]}});return this._parts}constructor(){super();me+=1,this.initAttributes("hidden"),this.instanceId=`${this.tagName.toLocaleLowerCase()}-${me}`,this._value=E(this.defaultValue)}connectedCallback(){if(Pe(this.constructor.tagName),this.hydrate(),this.role!=null)this.setAttribute("role",this.role);if(this.onResize!==void 0){if(P.observe(this),this._onResize==null)this._onResize=this.onResize.bind(this);this.addEventListener("resize",this._onResize)}if(this.value!=null&&this.getAttribute("value")!=null)this._value=this.getAttribute("value");this.queueRender()}disconnectedCallback(){P.unobserve(this)}_changeQueued=!1;_renderQueued=!1;queueRender(n=!1){if(!this._hydrated)return;if(!this._changeQueued)this._changeQueued=n;if(!this._renderQueued)this._renderQueued=!0,requestAnimationFrame(()=>{if(this._changeQueued)En(this,"change");this._changeQueued=!1,this._renderQueued=!1,this.render()})}_hydrated=!1;hydrate(){if(!this._hydrated){this.initValue();let n=typeof this.content!=="function",e=typeof this.content==="function"?this.content():this.content,{styleSpec:o}=this.constructor,{styleNode:i}=this.constructor;if(o)i=this.constructor.styleNode=m.style(U(o)),delete this.constructor.styleNode;if(this.styleNode)console.warn(this,"styleNode is deprecrated, use static styleNode or statc styleSpec instead"),i=this.styleNode;if(i){let s=this.attachShadow({mode:"open"});s.appendChild(i.cloneNode(!0)),Cn(s,e,n)}else if(e!==null){let s=Array.from(this.childNodes);Cn(this,e,n),this.isSlotted=this.querySelector("slot,xin-slot")!==void 0;let t=Array.from(this.querySelectorAll("slot"));if(t.length>0)t.forEach(Hn.replaceSlot);if(s.length>0){let r={"":this};Array.from(this.querySelectorAll("xin-slot")).forEach((c)=>{r[c.name]=c}),s.forEach((c)=>{let d=r[""],u=c instanceof Element?r[c.slot]:d;(u!==void 0?u:d).append(c)})}}this._hydrated=!0}}render(){}}class Hn extends D{name="";content=null;static replaceSlot(n){let e=document.createElement("xin-slot");if(n.name!=="")e.setAttribute("name",n.name);n.replaceWith(e)}constructor(){super();this.initAttributes("name")}}var ii=Hn.elementCreator({tag:"xin-slot"});var Qe=(n=()=>!0)=>{let e=localStorage.getItem("xin-state");if(e!=null){let i=JSON.parse(e);for(let s of Object.keys(i).filter(n))if(l[s]!==void 0)Object.assign(l[s],i[s]);else l[s]=i[s]}let o=kn(()=>{let i={},s=x(l);for(let t of Object.keys(s).filter(n))i[t]=s[t];localStorage.setItem("xin-state",JSON.stringify(i)),console.log("xin state saved to localStorage")},500);G(n,o)};var Bn="0.9.1";function sn(n){return Object.assign(J,n),J}var pe=!1;function An(n,e=!1){if(e){if(!pe)console.warn("xinProxy(..., true) is deprecated; use boxedProxy(...) instead"),pe=!0;return sn(n)}return Object.keys(n).forEach((o)=>{l[o]=n[o]}),l}var Re={};async function rn(n,e){let{type:o,styleSpec:i}=await e(n,{Color:f,Component:D,elements:m,svgElements:Fn,mathML:On,varDefault:on,vars:vn,xin:l,boxed:J,xinProxy:An,boxedProxy:sn,makeComponent:rn,version:Bn}),s={type:o,creator:o.elementCreator({tag:n,styleSpec:i})};return Re[n]=s,s}var zn={},Ve=(n)=>import(n);class tn extends D{tag="anon-elt";src="";property="default";loaded;onload=()=>{};async packaged(){let{tag:n,src:e,property:o}=this,i=`${n}.${o}:${e}`;if(!this.loaded){if(zn[i]===void 0){let t=(await Ve(e))[o];zn[i]=rn(n,t)}else console.log(`using cached ${n}`);this.loaded=await zn[i],this.onload()}return this.loaded}constructor(){super();this.initAttributes("tag","src","property")}}var Ke=tn.elementCreator({tag:"xin-blueprint",styleSpec:{":host":{display:"none"}}});class In extends D{onload=()=>{};constructor(){super()}async load(){let e=Array.from(this.querySelectorAll(tn.tagName)).filter((o)=>o.src).map((o)=>o.packaged());await Promise.all(e),this.onload()}connectedCallback(){super.connectedCallback(),this.load()}}var _e=In.elementCreator({tag:"xin-loader",styleSpec:{":host":{display:"none"}}});export{x as xinValue,An as xinProxy,S as xinPath,l as xin,Bn as version,vn as vars,on as varDefault,jn as updates,q as unobserve,I as touch,Sn as throttle,Fn as svgElements,O as settings,gn as on,G as observe,On as mathML,rn as makeComponent,qe as invertLuminance,Ue as initVars,Qe as hotReload,yn as getListItem,m as elements,kn as debounce,je as darkMode,U as css,sn as boxedProxy,J as boxed,_e as blueprintLoader,Ke as blueprint,nn as bindings,M as bind,We as StyleSheet,ve as MoreMath,D as Component,f as Color,In as BlueprintLoader,tn as Blueprint};

//# debugId=1FE843BFF7E1ED0364756E2164756E21
//# sourceMappingURL=module.js.map
