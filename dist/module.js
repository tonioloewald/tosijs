var F={debug:!1,perf:!1};function E(e){if(e==null||typeof e!=="object")return e;if(e instanceof Set)return new Set(e);else if(Array.isArray(e))return e.map(E);let n={};for(let o in e){let t=e[o];if(e!=null&&typeof e==="object")n[o]=E(t);else n[o]=t}return n}var ae="-xin-data",v=`.${ae}`,fe="-xin-event",ue=`.${fe}`,x="xinPath",B="xinValue",Ie="xinSet",Ye="xinObserve",qe="xinBind",Je="xinOn",M=(e)=>{return e&&e[x]||void 0};function h(e){return typeof e==="object"&&e!==null?e[B]||e:e}var L=new WeakMap,S=new WeakMap;var H=(e)=>{let n=e.cloneNode();if(n instanceof Element){let o=S.get(e),t=L.get(e);if(o!=null)S.set(n,E(o));if(t!=null)L.set(n,E(t))}for(let o of Array.from(e instanceof HTMLTemplateElement?e.content.childNodes:e.childNodes))if(o instanceof Element||o instanceof DocumentFragment)n.appendChild(H(o));else n.appendChild(o.cloneNode());return n},J=new WeakMap,pe=(e)=>{let n=document.body.parentElement;while(e.parentElement!=null&&e.parentElement!==n){let o=J.get(e);if(o!=null)return o;e=e.parentElement}return!1};var Ve=Symbol("observer should be removed"),R=[],N=[],ye=!1,me,xe;class Ue{description;test;callback;constructor(e,n){let o=typeof n==="string"?`"${n}"`:`function ${n.name}`,t;if(typeof e==="string")this.test=(i)=>typeof i==="string"&&i!==""&&(e.startsWith(i)||i.startsWith(e)),t=`test = "${e}"`;else if(e instanceof RegExp)this.test=e.test.bind(e),t=`test = "${e.toString()}"`;else if(e instanceof Function)this.test=e,t=`test = function ${e.name}`;else throw new Error("expect listener test to be a string, RegExp, or test function");if(this.description=`${t}, ${o}`,typeof n==="function")this.callback=n;else throw new Error("expect callback to be a path or function");R.push(this)}}var _e=async()=>{if(me===void 0)return;await me},wn=()=>{if(F.perf)console.time("xin async update");let e=Array.from(N);for(let n of e)R.filter((o)=>{let t;try{t=o.test(n)}catch(i){throw new Error(`Listener ${o.description} threw "${i}" at "${n}"`)}if(t===Ve)return V(o),!1;return t}).forEach((o)=>{let t;try{t=o.callback(n)}catch(i){console.error(`Listener ${o.description} threw "${i}" handling "${n}"`)}if(t===Ve)V(o)});if(N.splice(0),ye=!1,typeof xe==="function")xe();if(F.perf)console.timeEnd("xin async update")},P=(e)=>{let n=typeof e==="string"?e:M(e);if(n===void 0)throw console.error("touch was called on an invalid target",e),new Error("touch was called on an invalid target");if(ye===!1)me=new Promise((o)=>{xe=o}),ye=setTimeout(wn);if(N.find((o)=>n.startsWith(o))==null)N.push(n)},he=(e,n)=>{return new Ue(e,n)},V=(e)=>{let n=R.indexOf(e);if(n>-1)R.splice(n,1);else throw new Error("unobserve failed, listener not found")};var Tn=(e)=>{try{return JSON.stringify(e)}catch(n){return"{has circular references}"}},be=(...e)=>new Error(e.map(Tn).join(" "));var Xn=()=>new Date(parseInt("1000000000",36)+Date.now()).valueOf().toString(36).slice(1),En=0,Sn=()=>(parseInt("10000",36)+ ++En).toString(36).slice(-5),kn=()=>Xn()+Sn(),we=Symbol("delete"),Qe=Symbol("new-object"),ge=Symbol("automatic-index");function Ke(e){if(e==="")return[];if(Array.isArray(e))return e;else{let n=[];while(e.length>0){let o=e.search(/\[[^\]]+\]/);if(o===-1){n.push(e.split("."));break}else{let t=e.slice(0,o);if(e=e.slice(o),t!=="")n.push(t.split("."));if(o=e.indexOf("]")+1,n.push(e.slice(1,o-1)),e.slice(o,o+1)===".")o+=1;e=e.slice(o)}}return n}}var k=new WeakMap;function Re(e,n){if(k.get(e)===void 0)k.set(e,{});if(k.get(e)[n]===void 0)k.get(e)[n]={};let o=k.get(e)[n];if(n==="_auto_")e.forEach((t,i)=>{if(t[ge]===void 0)t[ge]=kn();o[t[ge]+""]=i});else e.forEach((t,i)=>{o[j(t,n)+""]=i});return o}function Cn(e,n){if(k.get(e)===void 0||k.get(e)[n]===void 0)return Re(e,n);else return k.get(e)[n]}function vn(e,n,o){o=o+"";let t=Cn(e,n)[o];if(t===void 0||j(e[t],n)+""!==o)t=Re(e,n)[o];return t}function Mn(e,n,o){if(e[n]===void 0&&o!==void 0)e[n]=o;return e[n]}function Ne(e,n,o,t){let i=n!==""?vn(e,n,o):o;if(t===we)return e.splice(i,1),k.delete(e),Symbol("deleted");else if(t===Qe){if(n===""&&e[i]===void 0)e[i]={}}else if(t!==void 0)if(i!==void 0)e[i]=t;else if(n!==""&&j(t,n)+""===o+"")e.push(t),i=e.length-1;else throw new Error(`byIdPath insert failed at [${n}=${o}]`);return e[i]}function Ge(e){if(!Array.isArray(e))throw be("setByPath failed: expected array, found",e)}function Ze(e){if(e==null||!(e instanceof Object))throw be("setByPath failed: expected Object, found",e)}function j(e,n){let o=Ke(n),t=e,i,s,r,c;for(i=0,s=o.length;t!==void 0&&i<s;i++){let l=o[i];if(Array.isArray(l))for(r=0,c=l.length;t!==void 0&&r<c;r++){let f=l[r];t=t[f]}else if(t.length===0){if(t=t[Number(l.slice(1))],l[0]!=="=")return}else if(l.includes("=")){let[f,...y]=l.split("=");t=Ne(t,f,y.join("="))}else r=parseInt(l,10),t=t[r]}return t}function en(e,n,o){let t=e;if(n==="")throw new Error("setByPath cannot be used to set the root object");let i=Ke(n);while(t!=null&&i.length>0){let s=i.shift();if(typeof s==="string"){let r=s.indexOf("=");if(r>-1){if(r===0)Ze(t);else Ge(t);let c=s.slice(0,r),l=s.slice(r+1);if(t=Ne(t,c,l,i.length>0?Qe:o),i.length===0)return!0}else{Ge(t);let c=parseInt(s,10);if(i.length>0)t=t[c];else{if(o!==we){if(t[c]===o)return!1;t[c]=o}else t.splice(c,1);return!0}}}else if(Array.isArray(s)&&s.length>0){Ze(t);while(s.length>0){let r=s.shift();if(s.length>0||i.length>0)t=Mn(t,r,s.length>0?{}:[]);else{if(o!==we){if(t[r]===o)return!1;t[r]=o}else{if(!Object.prototype.hasOwnProperty.call(t,r))return!1;delete t[r]}return!0}}}else throw new Error(`setByPath failed, bad path ${n}`)}throw new Error(`setByPath(${e}, ${n}, ${o}) failed`)}var Dn=["sort","splice","copyWithin","fill","pop","push","reverse","shift","unshift"],Xe={},Fn=!0,Ln=/^\.?([^.[\](),])+(\.[^.[\](),]+|\[\d+\]|\[[^=[\](),]*=[^[\]()]+\])*$/,Bn=(e)=>Ln.test(e),O=(e="",n="")=>{if(e==="")return n;else if(n.match(/^\d+$/)!==null||n.includes("="))return`${e}[${n}]`;else return`${e}.${n}`},Hn={string(e){return new String(e)},boolean(e){return new Boolean(e)},bigint(e){return e},symbol(e){return e},number(e){return new Number(e)}};function Te(e,n){let o=typeof e;if(e===void 0||o==="object"||o==="function")return e;else return new Proxy(Hn[typeof e](e),W(n,!0))}var W=(e,n)=>({get(o,t){switch(t){case x:return e;case B:return o.valueOf?o.valueOf():o;case Ie:return(r)=>a[e]=r;case Ye:return(r)=>{let c=he(e,r);return()=>V(c)};case Je:return(r,c)=>z(r,c,h(o));case qe:return(r,c,l)=>{b(r,e,c,l)}}if(typeof t==="symbol")return o[t];let i=t,s=i.match(/^([^.[]+)\.(.+)$/)??i.match(/^([^\]]+)(\[.+)/)??i.match(/^(\[[^\]]+\])\.(.+)$/)??i.match(/^(\[[^\]]+\])\[(.+)$/);if(s!==null){let[,r,c]=s,l=O(e,r),f=j(o,r);return f!==null&&typeof f==="object"?new Proxy(f,W(l,n))[c]:f}if(i.startsWith("[")&&i.endsWith("]"))i=i.substring(1,i.length-1);if(!Array.isArray(o)&&o[i]!==void 0||Array.isArray(o)&&i.includes("=")){let r;if(i.includes("=")){let[c,l]=i.split("=");r=o.find((f)=>`${j(f,c)}`===l)}else r=o[i];if(r instanceof Object){let c=O(e,i);return new Proxy(r instanceof Function?r.bind(o):r,W(c,n))}else return n?Te(r,O(e,i)):r}else if(Array.isArray(o)){let r=o[i];return typeof r==="function"?(...c)=>{let l=r.apply(o,c);if(Dn.includes(i))P(e);return l}:typeof r==="object"?new Proxy(r,W(O(e,i),n)):n?Te(r,O(e,i)):r}else return n?Te(o[i],O(e,i)):o[i]},set(o,t,i){i=h(i);let s=t!==B?O(e,t):e;if(Fn&&!Bn(s))throw new Error(`setting invalid path ${s}`);if(h(a[s])!==i&&en(Xe,s,i))P(s);return!0}}),U=(e,n)=>{let o=typeof n==="function"?n:a[n];if(typeof o!=="function")throw new Error(`observe expects a function or path to a function, ${n} is neither`);return he(e,o)},a=new Proxy(Xe,W("",!1)),I=new Proxy(Xe,W("",!0));var Ee=(e,n)=>{let o=new Event(n);e.dispatchEvent(o)},on=(e)=>{if(e instanceof HTMLInputElement)return e.type;else if(e instanceof HTMLSelectElement&&e.hasAttribute("multiple"))return"multi-select";else return"other"},tn=(e,n)=>{switch(on(e)){case"radio":e.checked=e.value===n;break;case"checkbox":e.checked=!!n;break;case"date":e.valueAsDate=new Date(n);break;case"multi-select":for(let o of Array.from(e.querySelectorAll("option")))o.selected=n[o.value];break;default:e.value=n}},rn=(e)=>{switch(on(e)){case"radio":{let n=e.parentElement?.querySelector(`[name="${e.name}"]:checked`);return n!=null?n.value:null}case"checkbox":return e.checked;case"date":return e.valueAsDate?.toISOString();case"multi-select":return Array.from(e.querySelectorAll("option")).reduce((n,o)=>{return n[o.value]=o.selected,n},{});default:return e.value}},{ResizeObserver:nn}=globalThis,_=nn!=null?new nn((e)=>{for(let n of e){let o=n.target;Ee(o,"resize")}}):{observe(){},unobserve(){}},Se=(e,n,o=!0)=>{if(e!=null&&n!=null)if(typeof n==="string")e.textContent=n;else if(Array.isArray(n))n.forEach((t)=>{e.append(t instanceof Node&&o?H(t):t)});else if(n instanceof Node)e.append(o?H(n):n);else throw new Error("expect text content or document node")};var ke=(e,n=250)=>{let o;return(...t)=>{if(o!==void 0)clearTimeout(o);o=setTimeout(()=>{e(...t)},n)}},ee=(e,n=250)=>{let o,t=Date.now()-n,i=!1;return(...s)=>{if(clearTimeout(o),o=setTimeout(async()=>{e(...s),t=Date.now()},n),!i&&Date.now()-t>=n){i=!0;try{e(...s),t=Date.now()}finally{i=!1}}}};var ne=Symbol("list-binding"),On=16,zn=100;function sn(e,n){let o=Array.from(e.querySelectorAll(v));if(e.matches(v))o.unshift(e);for(let t of o){let i=S.get(t);for(let s of i){if(s.path.startsWith("^"))s.path=`${n}${s.path.substring(1)}`;if(s.binding.toDOM!=null)s.binding.toDOM(t,a[s.path])}}}class cn{boundElement;listTop;listBottom;template;options;itemToElement;_array=[];_update;_previousSlice;static filterBoundObservers=new WeakMap;constructor(e,n,o={}){if(this.boundElement=e,this.itemToElement=new WeakMap,e.children.length!==1)throw new Error("ListBinding expects an element with exactly one child element");if(e.children[0]instanceof HTMLTemplateElement){let t=e.children[0];if(t.content.children.length!==1)throw new Error("ListBinding expects a template with exactly one child element");this.template=H(t.content.children[0])}else this.template=e.children[0],this.template.remove();if(this.options=o,this.listTop=document.createElement("div"),this.listBottom=document.createElement("div"),this.listTop.classList.add("virtual-list-padding"),this.listBottom.classList.add("virtual-list-padding"),this.boundElement.append(this.listTop),this.boundElement.append(this.listBottom),o.virtual!=null)_.observe(this.boundElement),this._update=ee(()=>{this.update(this._array,!0)},On),this.boundElement.addEventListener("scroll",this._update),this.boundElement.addEventListener("resize",this._update)}visibleSlice(){let{virtual:e,hiddenProp:n,visibleProp:o}=this.options,t=this._array;if(n!==void 0)t=t.filter((l)=>l[n]!==!0);if(o!==void 0)t=t.filter((l)=>l[o]===!0);if(this.options.filter&&this.needle!==void 0)t=this.options.filter(t,this.needle);let i=0,s=t.length-1,r=0,c=0;if(e!=null&&this.boundElement instanceof HTMLElement){let l=this.boundElement.offsetWidth,f=this.boundElement.offsetHeight;if(e.visibleColumns==null)e.visibleColumns=e.width!=null?Math.max(1,Math.floor(l/e.width)):1;let y=Math.ceil(f/e.height)+(e.rowChunkSize||1),A=Math.ceil(t.length/e.visibleColumns),Q=e.visibleColumns*y,X=Math.floor(this.boundElement.scrollTop/e.height);if(X>A-y+1)X=Math.max(0,A-y+1);if(e.rowChunkSize)X-=X%e.rowChunkSize;i=X*e.visibleColumns,s=i+Q-1,r=X*e.height,c=Math.max((A-y)*e.height-r,0)}return{items:t,firstItem:i,lastItem:s,topBuffer:r,bottomBuffer:c}}needle;filter=ee((e)=>{if(this.needle!==e)this.needle=e,this.update(this._array)},zn);update(e,n){if(e==null)e=[];this._array=e;let{hiddenProp:o,visibleProp:t}=this.options,i=M(e),s=this.visibleSlice();this.boundElement.classList.toggle("-xin-empty-list",s.items.length===0);let r=this._previousSlice,{firstItem:c,lastItem:l,topBuffer:f,bottomBuffer:y}=s;if(o===void 0&&t===void 0&&n===!0&&r!=null&&c===r.firstItem&&l===r.lastItem)return;this._previousSlice=s;let A=0,Q=0,X=0;for(let u of Array.from(this.boundElement.children)){if(u===this.listTop||u===this.listBottom)continue;let T=J.get(u);if(T==null)u.remove();else{let m=s.items.indexOf(T);if(m<c||m>l)u.remove(),this.itemToElement.delete(T),J.delete(u),A++}}this.listTop.style.height=String(f)+"px",this.listBottom.style.height=String(y)+"px";let We=[],{idPath:le}=this.options;for(let u=c;u<=l;u++){let T=s.items[u];if(T===void 0)continue;let m=this.itemToElement.get(h(T));if(m==null){if(X++,m=H(this.template),typeof T==="object")this.itemToElement.set(h(T),m),J.set(m,h(T));if(this.boundElement.insertBefore(m,this.listBottom),le!=null){let de=T[le],gn=`${i}[${le}=${de}]`;sn(m,gn)}else{let de=`${i}[${u}]`;sn(m,de)}}We.push(m)}let K=null;for(let u of We){if(u.previousElementSibling!==K)if(Q++,K?.nextElementSibling!=null)this.boundElement.insertBefore(u,K.nextElementSibling);else this.boundElement.insertBefore(u,this.listBottom);K=u}if(F.perf)console.log(i,"updated",{removed:A,created:X,moved:Q})}}var ln=(e,n,o)=>{let t=e[ne];if(t===void 0)t=new cn(e,n,o),e[ne]=t;return t};var{document:G,MutationObserver:dn}=globalThis,Ce=(e,n)=>{let o=S.get(e);if(o==null)return;for(let t of o){let{binding:i,options:s}=t,{path:r}=t,{toDOM:c}=i;if(c!=null){if(r.startsWith("^")){let l=pe(e);if(l!=null&&l[x]!=null)r=t.path=`${l[x]}${r.substring(1)}`;else throw console.error(`Cannot resolve relative binding ${r}`,e,"is not part of a list"),new Error(`Cannot resolve relative binding ${r}`)}if(n==null||r.startsWith(n))c(e,a[r],s)}}};if(dn!=null)new dn((n)=>{n.forEach((o)=>{Array.from(o.addedNodes).forEach((t)=>{if(t instanceof Element)Array.from(t.querySelectorAll(v)).forEach((i)=>Ce(i))})})}).observe(G.body,{subtree:!0,childList:!0});U(()=>!0,(e)=>{let n=Array.from(G.querySelectorAll(v));for(let o of n)Ce(o,e)});var an=(e)=>{let n=e.target.closest(v);while(n!=null){let o=S.get(n);for(let t of o){let{binding:i,path:s}=t,{fromDOM:r}=i;if(r!=null){let c;try{c=r(n,t.options)}catch(l){throw console.error("Cannot get value from",n,"via",t),new Error("Cannot obtain value fromDOM")}if(c!=null){let l=a[s];if(l==null)a[s]=c;else{let f=l[x]!=null?l[B]:l,y=c[x]!=null?c[B]:c;if(f!==y)a[s]=y}}}}n=n.parentElement.closest(v)}};if(globalThis.document!=null)G.body.addEventListener("change",an,!0),G.body.addEventListener("input",an,!0);function b(e,n,o,t){if(e instanceof DocumentFragment)throw new Error("bind cannot bind to a DocumentFragment");let i;if(typeof n==="object"&&n[x]===void 0&&t===void 0){let{value:c}=n;i=typeof c==="string"?c:c[x],t=n,delete t.value}else i=typeof n==="string"?n:n[x];if(i==null)throw new Error("bind requires a path or object with xin Proxy");let{toDOM:s}=o;e.classList?.add(ae);let r=S.get(e);if(r==null)r=[],S.set(e,r);if(r.push({path:i,binding:o,options:t}),s!=null&&!i.startsWith("^"))P(i);if(t?.filter&&t?.needle)b(e,t.needle,{toDOM(c,l){console.log({needle:l}),c[ne]?.filter(l)}});return e}var fn=new Set,$n=(e)=>{let n=e?.target.closest(ue),o=!1,t=new Proxy(e,{get(s,r){if(r==="stopPropagation")return()=>{e.stopPropagation(),o=!0};else{let c=s[r];return typeof c==="function"?c.bind(s):c}}}),i=new Set;while(!o&&n!=null){let r=L.get(n)[e.type]||i;for(let c of r){if(typeof c==="function")c(t);else{let l=a[c];if(typeof l==="function")l(t);else throw new Error(`no event handler found at path ${c}`)}if(o)continue}n=n.parentElement!=null?n.parentElement.closest(ue):null}};function z(e,n,o){let t=L.get(e);if(e.classList.add(fe),t==null)t={},L.set(e,t);if(!t[n])t[n]=new Set;if(t[n].add(o),!fn.has(n))fn.add(n),G.body.addEventListener(n,$n,!0);return()=>{t[n].delete(o)}}var oe={value:{toDOM:tn,fromDOM(e){return rn(e)}},text:{toDOM(e,n){e.textContent=n}},enabled:{toDOM(e,n){e.disabled=!n}},disabled:{toDOM(e,n){e.disabled=Boolean(n)}},list:{toDOM(e,n,o){ln(e,n,o).update(n)}}};var An=180/Math.PI,Pn=Math.PI/180;function g(e,n,o){return o<e?NaN:n<e?e:n>o?o:n}function C(e,n,o,t=!0){if(t)o=g(0,o,1);return o*(n-e)+e}var jn={RADIANS_TO_DEGREES:An,DEGREES_TO_RADIANS:Pn,clamp:g,lerp:C};function ve(e,n=document.body){let o=getComputedStyle(n);if(e.endsWith(")")&&e.startsWith("var("))e=e.slice(4,-1);return o.getPropertyValue(e).trim()}var Wn=(e,n,o)=>{return(0.299*e+0.587*n+0.114*o)/255},$=(e)=>("00"+Math.round(Number(e)).toString(16)).slice(-2);class un{h;s;l;constructor(e,n,o){e/=255,n/=255,o/=255;let t=Math.max(e,n,o),i=t-Math.min(e,n,o),s=i!==0?t===e?(n-o)/i:t===n?2+(o-e)/i:4+(e-n)/i:0;this.h=60*s<0?60*s+360:60*s,this.s=i!==0?t<=0.5?i/(2*t-i):i/(2-(2*t-i)):0,this.l=(2*t-i)/2}}var Y=globalThis.document!==void 0?globalThis.document.createElement("span"):void 0;class d{r;g;b;a;static fromVar(e,n=document.body){return d.fromCss(ve(e,n))}static fromCss(e){let n=e;if(Y instanceof HTMLSpanElement)Y.style.color="black",Y.style.color=e,document.body.appendChild(Y),n=getComputedStyle(Y).color,Y.remove();let[o,t,i,s]=n.match(/[\d.]+/g),r=n.startsWith("color(srgb")?255:1;return new d(Number(o)*r,Number(t)*r,Number(i)*r,s==null?1:Number(s))}static fromHsl(e,n,o,t=1){return d.fromCss(`hsl(${e.toFixed(0)}deg ${(n*100).toFixed(0)}% ${(o*100).toFixed(0)}% / ${(t*100).toFixed(0)}%)`)}static black=new d(0,0,0);static white=new d(255,255,255);constructor(e,n,o,t=1){this.r=g(0,e,255),this.g=g(0,n,255),this.b=g(0,o,255),this.a=t!==void 0?g(0,t,1):t=1}get inverse(){return new d(255-this.r,255-this.g,255-this.b,this.a)}get inverseLuminance(){let{h:e,s:n,l:o}=this._hsl;return d.fromHsl(e,n,1-o,this.a)}contrasting(e=1){let{h:n,s:o,l:t}=this._hsl;return this.blend(this.brightness>0.5?d.black:d.white,e)}get rgb(){let{r:e,g:n,b:o}=this;return`rgb(${e.toFixed(0)},${n.toFixed(0)},${o.toFixed(0)})`}get rgba(){let{r:e,g:n,b:o,a:t}=this;return`rgba(${e.toFixed(0)},${n.toFixed(0)},${o.toFixed(0)},${t.toFixed(2)})`}get RGBA(){return[this.r/255,this.g/255,this.b/255,this.a]}get ARGB(){return[this.a,this.r/255,this.g/255,this.b/255]}hslCached;get _hsl(){if(this.hslCached==null)this.hslCached=new un(this.r,this.g,this.b);return this.hslCached}get hsl(){let{h:e,s:n,l:o}=this._hsl;return`hsl(${e.toFixed(0)}deg ${(n*100).toFixed(0)}% ${(o*100).toFixed(0)}%)`}get hsla(){let{h:e,s:n,l:o}=this._hsl;return`hsl(${e.toFixed(0)}deg ${(n*100).toFixed(0)}% ${(o*100).toFixed(0)}% / ${(this.a*100).toFixed(0)}%)`}get mono(){let e=this.brightness*255;return new d(e,e,e)}get brightness(){return Wn(this.r,this.g,this.b)}get html(){return this.toString()}toString(){return this.a===1?"#"+$(this.r)+$(this.g)+$(this.b):"#"+$(this.r)+$(this.g)+$(this.b)+$(Math.floor(255*this.a))}brighten(e){let{h:n,s:o,l:t}=this._hsl,i=g(0,t+e*(1-t),1);return d.fromHsl(n,o,i,this.a)}darken(e){let{h:n,s:o,l:t}=this._hsl,i=g(0,t*(1-e),1);return d.fromHsl(n,o,i,this.a)}saturate(e){let{h:n,s:o,l:t}=this._hsl,i=g(0,o+e*(1-o),1);return d.fromHsl(n,i,t,this.a)}desaturate(e){let{h:n,s:o,l:t}=this._hsl,i=g(0,o*(1-e),1);return d.fromHsl(n,i,t,this.a)}rotate(e){let{h:n,s:o,l:t}=this._hsl,i=(n+360+e)%360;return d.fromHsl(i,o,t,this.a)}opacity(e){let{h:n,s:o,l:t}=this._hsl;return d.fromHsl(n,o,t,e)}swatch(){return console.log(`%c      %c ${this.html}, ${this.rgba}`,`background-color: ${this.html}`,"background-color: transparent"),this}blend(e,n){return new d(C(this.r,e.r,n),C(this.g,e.g,n),C(this.b,e.b,n),C(this.a,e.a,n))}static blendHue(e,n,o){let t=(n-e+720)%360;if(t<180)return e+o*t;else return e-(360-t)*o}mix(e,n){let o=this._hsl,t=e._hsl;return d.fromHsl(o.s===0?t.h:t.s===0?o.h:d.blendHue(o.h,t.h,n),C(o.s,t.s,n),C(o.l,t.l,n),C(this.a,e.a,n))}colorMix(e,n){return d.fromCss(`color-mix(in hsl, ${this.html}, ${e.html} ${(n*100).toFixed(0)}%)`)}}function w(e){return e.replace(/[A-Z]/g,(n)=>{return`-${n.toLocaleLowerCase()}`})}function pn(e){return e.replace(/-([a-z])/g,(n,o)=>{return o.toLocaleUpperCase()})}var In="http://www.w3.org/1998/Math/MathML",Yn="http://www.w3.org/2000/svg",te={},yn=(e,n,o)=>{let t=Be(w(n),o);if(t.prop.startsWith("--"))e.style.setProperty(t.prop,t.value);else e.style[n]=t.value},qn=(e)=>{return{toDOM(n,o){yn(n,e,o)}}},mn=(e,n,o)=>{if(n==="style")if(typeof o==="object")for(let t of Object.keys(o))if(M(o[t]))b(e,o[t],qn(t));else yn(e,t,o[t]);else e.setAttribute("style",o);else if(e[n]!==void 0){let{MathMLElement:t}=globalThis;if(e instanceof SVGElement||t!==void 0&&e instanceof t)e.setAttribute(n,o);else e[n]=o}else{let t=w(n);if(t==="class")o.split(" ").forEach((i)=>{e.classList.add(i)});else if(e[t]!==void 0)e[t]=o;else if(typeof o==="boolean")o?e.setAttribute(t,""):e.removeAttribute(t);else e.setAttribute(t,o)}},Jn=(e)=>{return{toDOM(n,o){mn(n,e,o)}}},Vn=(e,n,o)=>{if(n==="apply")o(e);else if(n.match(/^on[A-Z]/)!=null){let t=n.substring(2).toLowerCase();z(e,t,o)}else if(n==="bind")if((typeof o.binding==="string"?oe[o.binding]:o.binding)!==void 0&&o.value!==void 0)b(e,o.value,o.binding instanceof Function?{toDOM:o.binding}:o.binding);else throw new Error("bad binding");else if(n.match(/^bind[A-Z]/)!=null){let t=n.substring(4,5).toLowerCase()+n.substring(5),i=oe[t];if(i!==void 0)b(e,o,i);else throw new Error(`${n} is not allowed, bindings.${t} is not defined`)}else if(M(o))b(e,o,Jn(n));else mn(e,n,o)},Me=(e,...n)=>{if(te[e]===void 0){let[i,s]=e.split("|");if(s===void 0)te[e]=globalThis.document.createElement(i);else te[e]=globalThis.document.createElementNS(s,i)}let o=te[e].cloneNode(),t={};for(let i of n)if(i instanceof Element||i instanceof DocumentFragment||typeof i==="string"||typeof i==="number")if(o instanceof HTMLTemplateElement)o.content.append(i);else o.append(i);else if(i.xinPath)o.append(p.span({bindText:i}));else Object.assign(t,i);for(let i of Object.keys(t)){let s=t[i];Vn(o,i,s)}return o},De=(...e)=>{let n=globalThis.document.createDocumentFragment();for(let o of e)n.append(o);return n},p=new Proxy({fragment:De},{get(e,n){if(n=n.replace(/[A-Z]/g,(o)=>`-${o.toLocaleLowerCase()}`),e[n]===void 0)e[n]=(...o)=>Me(n,...o);return e[n]},set(){throw new Error("You may not add new properties to elements")}}),Fe=new Proxy({fragment:De},{get(e,n){if(e[n]===void 0)e[n]=(...o)=>Me(`${n}|${Yn}`,...o);return e[n]},set(){throw new Error("You may not add new properties to elements")}}),Le=new Proxy({fragment:De},{get(e,n){if(e[n]===void 0)e[n]=(...o)=>Me(`${n}|${In}`,...o);return e[n]},set(){throw new Error("You may not add new properties to elements")}});function Un(e,n){let o=p.style(q(n));o.id=e,document.head.append(o)}var _n=["animation-iteration-count","flex","flex-base","flex-grow","flex-shrink","opacity","order","tab-size","widows","z-index","zoom"],Be=(e,n)=>{if(typeof n==="number"&&!_n.includes(e))n=`${n}px`;if(e.startsWith("_"))if(e.startsWith("__"))e="--"+e.substring(2),n=`var(${e}-default, ${n})`;else e="--"+e.substring(1);return{prop:e,value:String(n)}},Gn=(e,n,o)=>{if(o===void 0)return"";if(o instanceof d)o=o.html;let t=Be(n,o);return`${e}  ${t.prop}: ${t.value};`},xn=(e,n,o="")=>{let t=w(e);if(typeof n==="object"&&!(n instanceof d)){let i=Object.keys(n).map((s)=>xn(s,n[s],`${o}  `)).join(`
`);return`${o}  ${e} {
${i}
${o}  }`}else return Gn(o,t,n)},q=(e,n="")=>{return Object.keys(e).map((t)=>{let i=e[t];if(typeof i==="string"){if(t==="@import")return`@import url('${i}');`;throw new Error("top-level string value only allowed for `@import`")}let s=Object.keys(i).map((r)=>xn(r,i[r])).join(`
`);return`${n}${t} {
${s}
}`}).join(`

`)},Zn=(e)=>{console.warn("initVars is deprecated. Just use _ and __ prefixes instead.");let n={};for(let o of Object.keys(e)){let t=e[o],i=w(o);n[`--${i}`]=typeof t==="number"&&t!==0?String(t)+"px":t}return n},Qn=(e)=>{let n={};for(let o of Object.keys(e)){let t=e[o];if(t instanceof d)n[o]=t.inverseLuminance;else if(typeof t==="string"&&t.match(/^(#[0-9a-fA-F]{3}|rgba?\(|hsla?\()/))n[o]=d.fromCss(t).inverseLuminance}return n},ie=new Proxy({},{get(e,n){if(e[n]===void 0){let o="--"+w(n);e[n]=(t)=>`var(${o}, ${t})`}return e[n]}}),He=new Proxy({},{get(e,n){if(n==="default")return ie;if(e[n]==null){n=w(n);let[,o,,t,i,s]=n.match(/^([-\w]*?)((_)?(\d+)(\w?))?$/)||["",n],r=`--${o}`;if(i!=null){let c=t==null?Number(i)/100:-Number(i)/100;switch(s){case"b":{let l=d.fromVar(r);e[n]=c>0?l.brighten(c).rgba:l.darken(-c).rgba}break;case"s":{let l=d.fromVar(r);e[n]=c>0?l.saturate(c).rgba:l.desaturate(-c).rgba}break;case"h":{let l=d.fromVar(r);e[n]=l.rotate(c*100).rgba}break;case"o":{let l=d.fromVar(r);e[n]=l.opacity(c).rgba}break;case"":e[n]=`calc(var(${r}) * ${c})`;break;default:throw console.error(s),new Error(`Unrecognized method ${s} for css variable ${r}`)}}else e[n]=`var(${r})`}return e[n]}});var Kn=0;function Oe(){return`custom-elt${(Kn++).toString(36)}`}var hn=0,Z={};function Rn(e,n){let o=Z[e],t=q(n).replace(/:host\b/g,e);Z[e]=o?o+`
`+t:t}function Nn(e){if(Z[e])document.head.append(p.style({id:e+"-component"},Z[e]));delete Z[e]}class D extends HTMLElement{static elements=p;static _elementCreator;instanceId;styleNode;static styleSpec;static styleNode;content=p.slot();isSlotted;static _tagName=null;static get tagName(){return this._tagName}static StyleNode(e){return console.warn("StyleNode is deprecated, just assign static styleSpec: XinStyleSheet to the class directly"),p.style(q(e))}static elementCreator(e={}){if(this._elementCreator==null){let{tag:n,styleSpec:o}=e,t=e!=null?n:null;if(t==null)if(typeof this.name==="string"&&this.name!==""){if(t=w(this.name),t.startsWith("-"))t=t.slice(1)}else t=Oe();if(customElements.get(t)!=null)console.warn(`${t} is already defined`);if(t.match(/\w+(-\w+)+/)==null)console.warn(`${t} is not a legal tag for a custom-element`),t=Oe();while(customElements.get(t)!==void 0)t=Oe();if(this._tagName=t,o!==void 0)Rn(t,o);window.customElements.define(t,this,e),this._elementCreator=p[t]}return this._elementCreator}initAttributes(...e){let n={},o={};new MutationObserver((i)=>{let s=!1;if(i.forEach((r)=>{s=!!(r.attributeName&&e.includes(pn(r.attributeName)))}),s&&this.queueRender!==void 0)this.queueRender(!1)}).observe(this,{attributes:!0}),e.forEach((i)=>{n[i]=E(this[i]);let s=w(i);Object.defineProperty(this,i,{enumerable:!1,get(){if(typeof n[i]==="boolean")return this.hasAttribute(s);else if(this.hasAttribute(s))return typeof n[i]==="number"?parseFloat(this.getAttribute(s)):this.getAttribute(s);else if(o[i]!==void 0)return o[i];else return n[i]},set(r){if(typeof n[i]==="boolean"){if(r!==this[i]){if(r)this.setAttribute(s,"");else this.removeAttribute(s);this.queueRender()}}else if(typeof n[i]==="number"){if(r!==parseFloat(this[i]))this.setAttribute(s,r),this.queueRender()}else if(typeof r==="object"||`${r}`!==`${this[i]}`){if(r===null||r===void 0||typeof r==="object")this.removeAttribute(s);else this.setAttribute(s,r);this.queueRender(),o[i]=r}}})})}initValue(){let e=Object.getOwnPropertyDescriptor(this,"value");if(e===void 0||e.get!==void 0||e.set!==void 0)return;let n=this.hasAttribute("value")?this.getAttribute("value"):E(this.value);delete this.value,Object.defineProperty(this,"value",{enumerable:!1,get(){return n},set(o){if(n!==o)n=o,this.queueRender(!0)}})}_parts;get parts(){let e=this.shadowRoot!=null?this.shadowRoot:this;if(this._parts==null)this._parts=new Proxy({},{get(n,o){if(n[o]===void 0){let t=e.querySelector(`[part="${o}"]`);if(t==null)t=e.querySelector(o);if(t==null)throw new Error(`elementRef "${o}" does not exist!`);t.removeAttribute("data-ref"),n[o]=t}return n[o]}});return this._parts}constructor(){super();hn+=1,this.initAttributes("hidden"),this.instanceId=`${this.tagName.toLocaleLowerCase()}-${hn}`,this._value=E(this.defaultValue)}connectedCallback(){if(Nn(this.constructor.tagName),this.hydrate(),this.role!=null)this.setAttribute("role",this.role);if(this.onResize!==void 0){if(_.observe(this),this._onResize==null)this._onResize=this.onResize.bind(this);this.addEventListener("resize",this._onResize)}if(this.value!=null&&this.getAttribute("value")!=null)this._value=this.getAttribute("value");this.queueRender()}disconnectedCallback(){_.unobserve(this)}_changeQueued=!1;_renderQueued=!1;queueRender(e=!1){if(!this._hydrated)return;if(!this._changeQueued)this._changeQueued=e;if(!this._renderQueued)this._renderQueued=!0,requestAnimationFrame(()=>{if(this._changeQueued)Ee(this,"change");this._changeQueued=!1,this._renderQueued=!1,this.render()})}_hydrated=!1;hydrate(){if(!this._hydrated){this.initValue();let e=typeof this.content!=="function",n=typeof this.content==="function"?this.content():this.content,{styleSpec:o}=this.constructor,{styleNode:t}=this.constructor;if(o)t=this.constructor.styleNode=p.style(q(o)),delete this.constructor.styleNode;if(this.styleNode)console.warn(this,"styleNode is deprecrated, use static styleNode or statc styleSpec instead"),t=this.styleNode;if(t){let i=this.attachShadow({mode:"open"});i.appendChild(t.cloneNode(!0)),Se(i,n,e)}else if(n!==null){let i=Array.from(this.childNodes);Se(this,n,e),this.isSlotted=this.querySelector("slot,xin-slot")!==void 0;let s=Array.from(this.querySelectorAll("slot"));if(s.length>0)s.forEach(ze.replaceSlot);if(i.length>0){let r={"":this};Array.from(this.querySelectorAll("xin-slot")).forEach((c)=>{r[c.name]=c}),i.forEach((c)=>{let l=r[""],f=c instanceof Element?r[c.slot]:l;(f!==void 0?f:l).append(c)})}}this._hydrated=!0}}render(){}}class ze extends D{name="";content=null;static replaceSlot(e){let n=document.createElement("xin-slot");if(e.name!=="")n.setAttribute("name",e.name);e.replaceWith(n)}constructor(){super();this.initAttributes("name")}}var ft=ze.elementCreator({tag:"xin-slot"});var eo=(e=()=>!0)=>{let n=localStorage.getItem("xin-state");if(n!=null){let t=JSON.parse(n);for(let i of Object.keys(t).filter(e))if(a[i]!==void 0)Object.assign(a[i],t[i]);else a[i]=t[i]}let o=ke(()=>{let t={},i=h(a);for(let s of Object.keys(i).filter(e))t[s]=i[s];localStorage.setItem("xin-state",JSON.stringify(t)),console.log("xin state saved to localStorage")},500);U(e,o)};var $e="1.0.3";function bn(e){return Object.assign(I,e),I}function re(e){return console.warn("boxedProxy is deprecated, please use tosi() instead"),bn(e)}function Ae(e,n=!1){if(n)return console.warn("xinProxy(..., true) is deprecated; use tosi(...) instead"),re(e);return Object.keys(e).forEach((o)=>{a[o]=e[o]}),a}var no={};async function se(e,n){let{type:o,styleSpec:t}=await n(e,{Color:d,Component:D,elements:p,svgElements:Fe,mathML:Le,varDefault:ie,vars:He,xin:a,boxed:I,xinProxy:Ae,boxedProxy:re,makeComponent:se,bind:b,on:z,version:$e}),i={type:o,creator:o.elementCreator({tag:e,styleSpec:t})};return no[e]=i,i}var Pe={},oo=(e)=>import(e);class ce extends D{tag="anon-elt";src="";property="default";loaded;blueprintLoaded=(e)=>{};async packaged(){let{tag:e,src:n,property:o}=this,t=`${e}.${o}:${n}`;if(!this.loaded){if(Pe[t]===void 0)Pe[t]=oo(n).then((i)=>{let s=i[o];return se(e,s)});else console.log(`using cached ${e}`);this.loaded=await Pe[t],this.blueprintLoaded(this.loaded)}return this.loaded}constructor(){super();this.initAttributes("tag","src","property")}}var to=ce.elementCreator({tag:"xin-blueprint",styleSpec:{":host":{display:"none"}}});class je extends D{allLoaded=()=>{};constructor(){super()}async load(){let n=Array.from(this.querySelectorAll(ce.tagName)).filter((o)=>o.src).map((o)=>o.packaged());await Promise.all(n),this.allLoaded()}connectedCallback(){super.connectedCallback(),this.load()}}var io=je.elementCreator({tag:"xin-loader",styleSpec:{":host":{display:"none"}}});export{h as xinValue,Ae as xinProxy,M as xinPath,a as xin,$e as version,He as vars,ie as varDefault,_e as updates,V as unobserve,Ce as touchElement,P as touch,bn as tosi,ee as throttle,Fe as svgElements,F as settings,z as on,U as observe,Le as mathML,se as makeComponent,Qn as invertLuminance,Zn as initVars,eo as hotReload,pe as getListItem,ve as getCssVar,p as elements,ke as debounce,q as css,re as boxedProxy,I as boxed,io as blueprintLoader,to as blueprint,oe as bindings,b as bind,Un as StyleSheet,jn as MoreMath,D as Component,d as Color,je as BlueprintLoader,ce as Blueprint};

//# debugId=83DD56991FE3C98464756E2164756E21
//# sourceMappingURL=module.js.map
