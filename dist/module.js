var U={debug:!1,perf:!1};function H(n){if(n==null||typeof n!=="object")return n;if(Array.isArray(n))return n.map(H);let o={};for(let c in n){let f=n[c];if(n!=null&&typeof n==="object")o[c]=H(f);else o[c]=f}return o}var En="-xin-data",Z=`.${En}`,Tn="-xin-event",$n=`.${Tn}`,M="xinPath",Y="xinValue",In="xinObserve",Pn="xinBind",m=(n)=>{return n[M]};function C(n){return typeof n==="object"&&n!==null?n[Y]||n:n}var Q=new WeakMap,O=new WeakMap;var q=(n)=>{let o=n.cloneNode();if(o instanceof Element){let c=O.get(n),f=Q.get(n);if(c!=null)O.set(o,H(c));if(f!=null)Q.set(o,H(f))}for(let c of n instanceof HTMLTemplateElement?n.content.childNodes:n.childNodes)if(c instanceof Element||c instanceof DocumentFragment)o.appendChild(q(c));else o.appendChild(c.cloneNode());return o},p=new WeakMap,Fn=(n)=>{let o=document.body.parentElement;while(n.parentElement!=null&&n.parentElement!==o){let c=p.get(n);if(c!=null)return c;n=n.parentElement}return!1};var e=Symbol("observer should be removed"),t=[],a=[],Sn=!1,kn,Ln;class un{description;test;callback;constructor(n,o){let c=typeof o==="string"?`"${o}"`:`function ${o.name}`,f;if(typeof n==="string")this.test=(r)=>typeof r==="string"&&r!==""&&(n.startsWith(r)||r.startsWith(n)),f=`test = "${n}"`;else if(n instanceof RegExp)this.test=n.test.bind(n),f=`test = "${n.toString()}"`;else if(n instanceof Function)this.test=n,f=`test = function ${n.name}`;else throw new Error("expect listener test to be a string, RegExp, or test function");if(this.description=`${f}, ${c}`,typeof o==="function")this.callback=o;else throw new Error("expect callback to be a path or function");t.push(this)}}var mn=async()=>{if(kn===void 0)return;await kn},ko=()=>{if(U.perf)console.time("xin async update");let n=Array.from(a);for(let o of n)t.filter((c)=>{let f;try{f=c.test(o)}catch(r){throw new Error(`Listener ${c.description} threw "${r}" at "${o}"`)}if(f===e)return nn(c),!1;return f}).forEach((c)=>{let f;try{f=c.callback(o)}catch(r){console.error(`Listener ${c.description} threw "${r}" handling "${o}"`)}if(f===e)nn(c)});if(a.splice(0),Sn=!1,typeof Ln==="function")Ln();if(U.perf)console.timeEnd("xin async update")},j=(n)=>{let o=typeof n==="string"?n:m(n);if(o===void 0)throw console.error("touch was called on an invalid target",n),new Error("touch was called on an invalid target");if(Sn===!1)kn=new Promise((c)=>{Ln=c}),Sn=setTimeout(ko);if(a.find((c)=>o.startsWith(c))==null)a.push(o)},Mn=(n,o)=>{return new un(n,o)},nn=(n)=>{let o=t.indexOf(n);if(o>-1)t.splice(o,1);else throw new Error("unobserve failed, listener not found")};var Lo=(n)=>{try{return JSON.stringify(n)}catch(o){return"{has circular references}"}},Cn=(...n)=>new Error(n.map(Lo).join(" "));var Mo=()=>new Date(parseInt("1000000000",36)+Date.now()).valueOf().toString(36).slice(1),Co=0,so=()=>(parseInt("10000",36)+ ++Co).toString(36).slice(-5),Ao=()=>Mo()+so(),sn={},dn={};function gn(n){if(n==="")return[];if(Array.isArray(n))return n;else{let o=[];while(n.length>0){let c=n.search(/\[[^\]]+\]/);if(c===-1){o.push(n.split("."));break}else{let f=n.slice(0,c);if(n=n.slice(c),f!=="")o.push(f.split("."));if(c=n.indexOf("]")+1,o.push(n.slice(1,c-1)),n.slice(c,c+1)===".")c+=1;n=n.slice(c)}}return o}}var z=new WeakMap;function bn(n,o){if(z.get(n)===void 0)z.set(n,{});if(z.get(n)[o]===void 0)z.get(n)[o]={};let c=z.get(n)[o];if(o==="_auto_")n.forEach((f,r)=>{if(f._auto_===void 0)f._auto_=Ao();c[f._auto_+""]=r});else n.forEach((f,r)=>{c[_(f,o)+""]=r});return c}function io(n,o){if(z.get(n)===void 0||z.get(n)[o]===void 0)return bn(n,o);else return z.get(n)[o]}function Wo(n,o,c){c=c+"";let f=io(n,o)[c];if(f===void 0||_(n[f],o)+""!==c)f=bn(n,o)[c];return f}function Do(n,o,c){if(n[o]===void 0&&c!==void 0)n[o]=c;return n[o]}function vn(n,o,c,f){let r=o!==""?Wo(n,o,c):c;if(f===sn)return n.splice(r,1),z.delete(n),Symbol("deleted");else if(f===dn){if(o===""&&n[r]===void 0)n[r]={}}else if(f!==void 0)if(r!==void 0)n[r]=f;else if(o!==""&&_(f,o)+""===c+"")n.push(f),r=n.length-1;else throw new Error(`byIdPath insert failed at [${o}=${c}]`);return n[r]}function pn(n){if(!Array.isArray(n))throw Cn("setByPath failed: expected array, found",n)}function Nn(n){if(n==null||!(n instanceof Object))throw Cn("setByPath failed: expected Object, found",n)}function _(n,o){let c=gn(o),f=n,r,x,X,y;for(r=0,x=c.length;f!==void 0&&r<x;r++){let E=c[r];if(Array.isArray(E))for(X=0,y=E.length;f!==void 0&&X<y;X++){let F=E[X];f=f[F]}else if(f.length===0){if(f=f[E.slice(1)],E[0]!=="=")return}else if(E.includes("=")){let[F,...A]=E.split("=");f=vn(f,F,A.join("="))}else X=parseInt(E,10),f=f[X]}return f}function hn(n,o,c){let f=n,r=gn(o);while(f!=null&&r.length>0){let x=r.shift();if(typeof x==="string"){let X=x.indexOf("=");if(X>-1){if(X===0)Nn(f);else pn(f);let y=x.slice(0,X),E=x.slice(X+1);if(f=vn(f,y,E,r.length>0?dn:c),r.length===0)return!0}else{pn(f);let y=parseInt(x,10);if(r.length>0)f=f[y];else{if(c!==sn){if(f[y]===c)return!1;f[y]=c}else f.splice(y,1);return!0}}}else if(Array.isArray(x)&&x.length>0){Nn(f);while(x.length>0){let X=x.shift();if(x.length>0||r.length>0)f=Do(f,X,x.length>0?{}:[]);else{if(c!==sn){if(f[X]===c)return!1;f[X]=c}else{if(!Object.prototype.hasOwnProperty.call(f,X))return!1;delete f[X]}return!0}}}else throw new Error(`setByPath failed, bad path ${o}`)}throw new Error(`setByPath(${n}, ${o}, ${c}) failed`)}var Ho=["sort","splice","copyWithin","fill","pop","push","reverse","shift","unshift"],Wn={},Oo=!0,zo=/^\.?([^.[\](),])+(\.[^.[\](),]+|\[\d+\]|\[[^=[\](),]*=[^[\]()]+\])*$/,Zo=(n)=>zo.test(n),B=(n="",o="")=>{if(n==="")return o;else if(o.match(/^\d+$/)!==null||o.includes("="))return`${n}[${o}]`;else return`${n}.${o}`},Jo={string(n){return new String(n)},boolean(n){return new Boolean(n)},bigint(n){return n},symbol(n){return n},number(n){return new Number(n)}};function An(n,o){let c=typeof n;if(n===void 0||c==="object"||c==="function")return n;else return new Proxy(Jo[typeof n](n),V(o,!0))}var V=(n,o)=>({get(c,f){switch(f){case M:return n;case Y:return C(c);case In:return(X)=>Mn(n,X);case Pn:return(X,y,E)=>{P(X,n,y,E)}}if(typeof f==="symbol")return c[f];let r=f,x=r.match(/^([^.[]+)\.(.+)$/)??r.match(/^([^\]]+)(\[.+)/)??r.match(/^(\[[^\]]+\])\.(.+)$/)??r.match(/^(\[[^\]]+\])\[(.+)$/);if(x!==null){let[,X,y]=x,E=B(n,X),F=_(c,X);return F!==null&&typeof F==="object"?new Proxy(F,V(E,o))[y]:F}if(r.startsWith("[")&&r.endsWith("]"))r=r.substring(1,r.length-1);if(!Array.isArray(c)&&c[r]!==void 0||Array.isArray(c)&&r.includes("=")){let X;if(r.includes("=")){let[y,E]=r.split("=");X=c.find((F)=>`${_(F,y)}`===E)}else X=c[r];if(X!==null&&typeof X==="object"){let y=B(n,r);return new Proxy(X,V(y,o))}else if(typeof X==="function")return X.bind(c);else return o?An(X,B(n,r)):X}else if(Array.isArray(c)){let X=c[r];return typeof X==="function"?(...y)=>{let E=Array.prototype[r].apply(c,y);if(Ho.includes(r))j(n);return E}:typeof X==="object"?new Proxy(X,V(B(n,r),o)):o?An(X,B(n,r)):X}else return o?An(c[r],B(n,r)):c[r]},set(c,f,r){r=C(r);let x=f!==Y?B(n,f):n;if(Oo&&!Zo(x))throw new Error(`setting invalid path ${x}`);if(C($[x])!==r&&hn(Wn,x,r))j(x);return!0}}),N=(n,o)=>{let c=typeof o==="function"?o:$[o];if(typeof c!=="function")throw new Error(`observe expects a function or path to a function, ${o} is neither`);return Mn(n,c)},$=new Proxy(Wn,V("",!1)),I=new Proxy(Wn,V("",!0));var{document:d,MutationObserver:ln}=globalThis,an=(n,o)=>{let c=O.get(n);if(c==null)return;for(let f of c){let{binding:r,options:x}=f,{path:X}=f,{toDOM:y}=r;if(y!=null){if(X.startsWith("^")){let E=Fn(n);if(E!=null&&E[M]!=null)X=f.path=`${E[M]}${X.substring(1)}`;else throw console.error(`Cannot resolve relative binding ${X}`,n,"is not part of a list"),new Error(`Cannot resolve relative binding ${X}`)}if(o==null||X.startsWith(o))y(n,$[X],x)}}};if(ln!=null)new ln((o)=>{o.forEach((c)=>{Array.from(c.addedNodes).forEach((f)=>{if(f instanceof Element)Array.from(f.querySelectorAll(Z)).forEach((r)=>an(r))})})}).observe(d.body,{subtree:!0,childList:!0});N(()=>!0,(n)=>{let o=Array.from(d.querySelectorAll(Z));for(let c of o)an(c,n)});var en=(n)=>{let o=n.target.closest(Z);while(o!=null){let c=O.get(o);for(let f of c){let{binding:r,path:x}=f,{fromDOM:X}=r;if(X!=null){let y;try{y=X(o,f.options)}catch(E){throw console.error("Cannot get value from",o,"via",f),new Error("Cannot obtain value fromDOM")}if(y!=null){let E=$[x];if(E==null)$[x]=y;else{let F=E[M]!=null?E[Y]:E,A=y[M]!=null?y[Y]:y;if(F!==A)$[x]=A}}}}o=o.parentElement.closest(Z)}};if(globalThis.document!=null)d.body.addEventListener("change",en,!0),d.body.addEventListener("input",en,!0);function P(n,o,c,f){if(n instanceof DocumentFragment)throw new Error("bind cannot bind to a DocumentFragment");let r;if(typeof o==="object"&&o[M]===void 0&&f===void 0){let{value:y}=o;r=typeof y==="string"?y:y[M],f=o,delete f.value}else r=typeof o==="string"?o:o[M];if(r==null)throw new Error("bind requires a path or object with xin Proxy");let{toDOM:x}=c;n.classList?.add(En);let X=O.get(n);if(X==null)X=[],O.set(n,X);if(X.push({path:r,binding:c,options:f}),x!=null&&!r.startsWith("^"))j(r);return n}var tn=new Set,Go=(n)=>{let o=n?.target.closest($n),c=!1,f=new Proxy(n,{get(r,x){if(x==="stopPropagation")return()=>{n.stopPropagation(),c=!0};else{let X=r[x];return typeof X==="function"?X.bind(r):X}}});while(!c&&o!=null){let x=Q.get(o)[n.type]||[];for(let X of x){if(typeof X==="function")X(f);else{let y=$[X];if(typeof y==="function")y(f);else throw new Error(`no event handler found at path ${X}`)}if(c)continue}o=o.parentElement!=null?o.parentElement.closest($n):null}},Dn=(n,o,c)=>{let f=Q.get(n);if(n.classList.add(Tn),f==null)f={},Q.set(n,f);if(!f[o])f[o]=[];if(!f[o].includes(c))f[o].push(c);if(!tn.has(o))tn.add(o),d.body.addEventListener(o,Go,!0)};var Hn=(n,o)=>{let c=new Event(o);n.dispatchEvent(c)},oo=(n)=>{if(n instanceof HTMLInputElement)return n.type;else if(n instanceof HTMLSelectElement&&n.hasAttribute("multiple"))return"multi-select";else return"other"},On=(n,o)=>{switch(oo(n)){case"radio":n.checked=n.value===o;break;case"checkbox":n.checked=!!o;break;case"date":n.valueAsDate=new Date(o);break;case"multi-select":for(let c of Array.from(n.querySelectorAll("option")))c.selected=o[c.value];break;default:n.value=o}},co=(n)=>{switch(oo(n)){case"radio":{let o=n.parentElement?.querySelector(`[name="${n.name}"]:checked`);return o!=null?o.value:null}case"checkbox":return n.checked;case"date":return n.valueAsDate?.toISOString();case"multi-select":return Array.from(n.querySelectorAll("option")).reduce((o,c)=>{return o[c.value]=c.selected,o},{});default:return n.value}},{ResizeObserver:no}=globalThis,g=no!=null?new no((n)=>{for(let o of n){let c=o.target;Hn(c,"resize")}}):{observe(){},unobserve(){}},zn=(n,o,c=!0)=>{if(n!=null&&o!=null)if(typeof o==="string")n.textContent=o;else if(Array.isArray(o))o.forEach((f)=>{n.append(f instanceof Node&&c?q(f):f)});else if(o instanceof Node)n.append(c?q(o):o);else throw new Error("expect text content or document node")};var Zn=(n,o=250)=>{let c;return(...f)=>{if(c!==void 0)clearTimeout(c);c=setTimeout(()=>{n(...f)},o)}},Jn=(n,o=250)=>{let c,f=Date.now()-o,r=!1;return(...x)=>{if(clearTimeout(c),c=setTimeout(async()=>{n(...x),f=Date.now()},o),!r&&Date.now()-f>=o){r=!0;try{n(...x),f=Date.now()}finally{r=!1}}}};var fo=Symbol("list-binding"),Uo=16;function ro(n,o){let c=Array.from(n.querySelectorAll(Z));if(n.matches(Z))c.unshift(n);for(let f of c){let r=O.get(f);for(let x of r){if(x.path.startsWith("^"))x.path=`${o}${x.path.substring(1)}`;if(x.binding.toDOM!=null)x.binding.toDOM(f,$[x.path])}}}class Xo{boundElement;listTop;listBottom;template;options;itemToElement;_array=[];_update;_previousSlice;constructor(n,o={}){if(this.boundElement=n,this.itemToElement=new WeakMap,n.children.length!==1)throw new Error("ListBinding expects an element with exactly one child element");if(n.children[0]instanceof HTMLTemplateElement){let c=n.children[0];if(c.content.children.length!==1)throw new Error("ListBinding expects a template with exactly one child element");this.template=q(c.content.children[0])}else this.template=n.children[0],this.template.remove();if(this.listTop=document.createElement("div"),this.listBottom=document.createElement("div"),this.boundElement.append(this.listTop),this.boundElement.append(this.listBottom),this.options=o,o.virtual!=null)g.observe(this.boundElement),this._update=Jn(()=>{this.update(this._array,!0)},Uo),this.boundElement.addEventListener("scroll",this._update),this.boundElement.addEventListener("resize",this._update)}visibleSlice(){let{virtual:n,hiddenProp:o,visibleProp:c}=this.options,f=this._array;if(o!==void 0)f=f.filter((E)=>E[o]!==!0);if(c!==void 0)f=f.filter((E)=>E[c]===!0);let r=0,x=f.length-1,X=0,y=0;if(n!=null&&this.boundElement instanceof HTMLElement){let E=this.boundElement.offsetWidth,F=this.boundElement.offsetHeight,A=n.width!=null?Math.max(1,Math.floor(E/n.width)):1,K=Math.ceil(F/n.height)+1,R=Math.ceil(f.length/A),h=A*K,G=Math.floor(this.boundElement.scrollTop/n.height);if(G>R-K+1)G=Math.max(0,R-K+1);r=G*A,x=r+h-1,X=G*n.height,y=Math.max(R*n.height-F-X,0)}return{items:f,firstItem:r,lastItem:x,topBuffer:X,bottomBuffer:y}}update(n,o){if(n==null)n=[];this._array=n;let{hiddenProp:c,visibleProp:f}=this.options,r=m(n),x=this.visibleSlice();this.boundElement.classList.toggle("-xin-empty-list",x.items.length===0);let X=this._previousSlice,{firstItem:y,lastItem:E,topBuffer:F,bottomBuffer:A}=x;if(c===void 0&&f===void 0&&o===!0&&X!=null&&y===X.firstItem&&E===X.lastItem)return;this._previousSlice=x;let K=0,R=0,h=0;for(let S of Array.from(this.boundElement.children)){if(S===this.listTop||S===this.listBottom)continue;let i=p.get(S);if(i==null)S.remove();else{let L=x.items.indexOf(i);if(L<y||L>E)S.remove(),this.itemToElement.delete(i),p.delete(S),K++}}this.listTop.style.height=String(F)+"px",this.listBottom.style.height=String(A)+"px";let G=[],{idPath:xn}=this.options;for(let S=y;S<=E;S++){let i=x.items[S];if(i===void 0)continue;let L=this.itemToElement.get(C(i));if(L==null){if(h++,L=q(this.template),typeof i==="object")this.itemToElement.set(C(i),L),p.set(L,C(i));if(this.boundElement.insertBefore(L,this.listBottom),xn!=null){let yn=i[xn],So=`${r}[${xn}=${yn}]`;ro(L,So)}else{let yn=`${r}[${S}]`;ro(L,yn)}}G.push(L)}let l=null;for(let S of G){if(S.previousElementSibling!==l)if(R++,l?.nextElementSibling!=null)this.boundElement.insertBefore(S,l.nextElementSibling);else this.boundElement.insertBefore(S,this.listBottom);l=S}if(U.perf)console.log(r,"updated",{removed:K,created:h,moved:R})}}var xo=(n,o)=>{let c=n[fo];if(c===void 0)c=new Xo(n,o),n[fo]=c;return c};var on={value:{toDOM:On,fromDOM(n){return co(n)}},set:{toDOM:On},text:{toDOM(n,o){n.textContent=o}},enabled:{toDOM(n,o){n.disabled=!o}},disabled:{toDOM(n,o){n.disabled=Boolean(o)}},style:{toDOM(n,o){if(typeof o==="object")for(let c of Object.keys(o))n.style[c]=o[c];else if(typeof o==="string")n.setAttribute("style",o);else throw new Error("style binding expects either a string or object")}},list:{toDOM(n,o,c){xo(n,c).update(o)}}};var Uc=180/Math.PI,Qc=Math.PI/180;function s(n,o,c){return o<n?n:o>c?c:o}function W(n,o,c){return c=s(0,c,1),c*(o-n)+n}var Qo={clamp:s,lerp:W};var Yo=(n,o,c)=>{return(0.299*n+0.587*o+0.114*c)/255},w=(n)=>("00"+Math.round(Number(n)).toString(16)).slice(-2);class yo{h;s;l;constructor(n,o,c){n/=255,o/=255,c/=255;let f=Math.max(n,o,c),r=f-Math.min(n,o,c),x=r!==0?f===n?(o-c)/r:f===o?2+(c-n)/r:4+(n-o)/r:0;this.h=60*x<0?60*x+360:60*x,this.s=r!==0?f<=0.5?r/(2*f-r):r/(2-(2*f-r)):0,this.l=(2*f-r)/2}}var b=globalThis.document!==void 0?globalThis.document.createElement("span"):void 0;class T{r;g;b;a;static fromCss(n){let o=n;if(b instanceof HTMLSpanElement)b.style.color=n,document.body.appendChild(b),o=getComputedStyle(b).color,b.remove();let[c,f,r,x]=o.match(/[\d.]+/g);return new T(Number(c),Number(f),Number(r),x==null?1:Number(x))}static fromHsl(n,o,c,f=1){return T.fromCss(`hsla(${n.toFixed(0)}, ${(o*100).toFixed(0)}%, ${(c*100).toFixed(0)}%, ${f.toFixed(2)})`)}constructor(n,o,c,f=1){this.r=s(0,n,255),this.g=s(0,o,255),this.b=s(0,c,255),this.a=f!==void 0?s(0,f,1):f=1}get inverse(){return new T(255-this.r,255-this.g,255-this.b,this.a)}get inverseLuminance(){let{h:n,s:o,l:c}=this._hsl;return T.fromHsl(n,o,1-c,this.a)}get rgb(){let{r:n,g:o,b:c}=this;return`rgb(${n.toFixed(0)},${o.toFixed(0)},${c.toFixed(0)})`}get rgba(){let{r:n,g:o,b:c,a:f}=this;return`rgba(${n.toFixed(0)},${o.toFixed(0)},${c.toFixed(0)},${f.toFixed(2)})`}get RGBA(){return[this.r/255,this.g/255,this.b/255,this.a]}get ARGB(){return[this.a,this.r/255,this.g/255,this.b/255]}hslCached;get _hsl(){if(this.hslCached==null)this.hslCached=new yo(this.r,this.g,this.b);return this.hslCached}get hsl(){let{h:n,s:o,l:c}=this._hsl;return`hsl(${n.toFixed(0)}, ${(o*100).toFixed(0)}%, ${(c*100).toFixed(0)}%)`}get hsla(){let{h:n,s:o,l:c}=this._hsl;return`hsla(${n.toFixed(0)}, ${(o*100).toFixed(0)}%, ${(c*100).toFixed(0)}%, ${this.a.toFixed(2)})`}get mono(){let n=this.brightness*255;return new T(n,n,n)}get brightness(){return Yo(this.r,this.g,this.b)}get html(){return this.toString()}toString(){return this.a===1?"#"+w(this.r)+w(this.g)+w(this.b):"#"+w(this.r)+w(this.g)+w(this.b)+w(Math.floor(255*this.a))}brighten(n){let{h:o,s:c,l:f}=this._hsl,r=s(0,f+n*(1-f),1);return T.fromHsl(o,c,r,this.a)}darken(n){let{h:o,s:c,l:f}=this._hsl,r=s(0,f*(1-n),1);return T.fromHsl(o,c,r,this.a)}saturate(n){let{h:o,s:c,l:f}=this._hsl,r=s(0,c+n*(1-c),1);return T.fromHsl(o,r,f,this.a)}desaturate(n){let{h:o,s:c,l:f}=this._hsl,r=s(0,c*(1-n),1);return T.fromHsl(o,r,f,this.a)}rotate(n){let{h:o,s:c,l:f}=this._hsl,r=(o+360+n)%360;return T.fromHsl(r,c,f,this.a)}opacity(n){let{h:o,s:c,l:f}=this._hsl;return T.fromHsl(o,c,f,n)}swatch(){let{r:n,g:o,b:c,a:f}=this;return console.log(`%c      %c ${this.html}, rgba(${n}, ${o}, ${c}, ${f}), ${this.hsla}`,`background-color: rgba(${n}, ${o}, ${c}, ${f})`,"background-color: transparent"),this}blend(n,o){return new T(W(this.r,n.r,o),W(this.g,n.g,o),W(this.b,n.b,o),W(this.a,n.a,o))}mix(n,o){let c=this._hsl,f=n._hsl;return T.fromHsl(W(c.h,f.h,o),W(c.s,f.s,o),W(c.l,f.l,o),W(this.a,n.a,o))}}function D(n){return n.replace(/[A-Z]/g,(o)=>{return`-${o.toLocaleLowerCase()}`})}function Eo(n){return n.replace(/-([a-z])/g,(o,c)=>{return c.toLocaleUpperCase()})}var qo="http://www.w3.org/1998/Math/MathML",Bo="http://www.w3.org/2000/svg",cn={},Gn=(n,...o)=>{if(cn[n]===void 0){let[r,x]=n.split("|");if(x===void 0)cn[n]=globalThis.document.createElement(r);else cn[n]=globalThis.document.createElementNS(x,r)}let c=cn[n].cloneNode(),f={};for(let r of o)if(r instanceof Element||r instanceof DocumentFragment||typeof r==="string"||typeof r==="number")if(c instanceof HTMLTemplateElement)c.content.append(r);else c.append(r);else Object.assign(f,r);for(let r of Object.keys(f)){let x=f[r];if(r==="apply")x(c);else if(r==="style")if(typeof x==="object")for(let X of Object.keys(x)){let y=qn(D(X),x[X]);if(y.prop.startsWith("--"))c.style.setProperty(y.prop,y.value);else c.style[X]=y.value}else c.setAttribute("style",x);else if(r.match(/^on[A-Z]/)!=null){let X=r.substring(2).toLowerCase();Dn(c,X,x)}else if(r==="bind")if((typeof x.binding==="string"?on[x.binding]:x.binding)!==void 0&&x.value!==void 0)P(c,x.value,x.binding instanceof Function?{toDOM:x.binding}:x.binding);else throw new Error("bad binding");else if(r.match(/^bind[A-Z]/)!=null){let X=r.substring(4,5).toLowerCase()+r.substring(5),y=on[X];if(y!==void 0)P(c,x,y);else throw new Error(`${r} is not allowed, bindings.${X} is not defined`)}else if(c[r]!==void 0){let{MathMLElement:X}=globalThis;if(c instanceof SVGElement||X!==void 0&&c instanceof X)c.setAttribute(r,x);else c[r]=x}else{let X=D(r);if(X==="class")x.split(" ").forEach((y)=>{c.classList.add(y)});else if(c[X]!==void 0)c[X]=x;else if(typeof x==="boolean")x?c.setAttribute(X,""):c.removeAttribute(X);else c.setAttribute(X,x)}}return c},Un=(...n)=>{let o=globalThis.document.createDocumentFragment();for(let c of n)o.append(c);return o},k=new Proxy({fragment:Un},{get(n,o){if(o=o.replace(/[A-Z]/g,(c)=>`-${c.toLocaleLowerCase()}`),n[o]===void 0)n[o]=(...c)=>Gn(o,...c);return n[o]},set(){throw new Error("You may not add new properties to elements")}}),Qn=new Proxy({fragment:Un},{get(n,o){if(n[o]===void 0)n[o]=(...c)=>Gn(`${o}|${Bo}`,...c);return n[o]},set(){throw new Error("You may not add new properties to elements")}}),Yn=new Proxy({fragment:Un},{get(n,o){if(n[o]===void 0)n[o]=(...c)=>Gn(`${o}|${qo}`,...c);return n[o]},set(){throw new Error("You may not add new properties to elements")}});function wo(n,o){let c=k.style(u(o));c.id=n,document.head.append(c)}var Ko=["animation-iteration-count","flex","flex-base","flex-grow","flex-shrink","opacity","order","tab-size","widows","z-index","zoom"],qn=(n,o)=>{if(typeof o==="number"&&!Ko.includes(n))o=`${o}px`;if(n.startsWith("_"))if(n.startsWith("__"))n="--"+n.substring(2),o=`var(${n}-default, ${o})`;else n="--"+n.substring(1);return{prop:n,value:String(o)}},Ro=(n,o,c)=>{if(c===void 0)return"";if(c instanceof T)c=c.html;let f=qn(o,c);return`${n}  ${f.prop}: ${f.value};`},To=(n,o,c="")=>{let f=D(n);if(typeof o==="object"&&!(o instanceof T)){let r=Object.keys(o).map((x)=>To(x,o[x],`${c}  `)).join(`
`);return`${c}  ${n} {
${r}
${c}  }`}else return Ro(c,f,o)},u=(n,o="")=>{return Object.keys(n).map((f)=>{let r=n[f];if(typeof r==="string"){if(f==="@import")return`@import url('${r}');`;throw new Error("top-level string value only allowed for `@import`")}let x=Object.keys(r).map((X)=>To(X,r[X])).join(`
`);return`${o}${f} {
${x}
}`}).join(`

`)},jo=(n)=>{console.warn("initVars is deprecated. Just use _ and __ prefixes instead.");let o={};for(let c of Object.keys(n)){let f=n[c],r=D(c);o[`--${r}`]=typeof f==="number"&&f!==0?String(f)+"px":f}return o},_o=(n)=>{console.warn("darkMode is deprecated. Use inverseLuminance instead.");let o={};for(let c of Object.keys(n)){let f=n[c];if(typeof f==="string"&&f.match(/^(#|rgb[a]?\(|hsl[a]?\()/)!=null)f=T.fromCss(f).inverseLuminance.html,o[`--${D(c)}`]=f}return o},Vo=(n)=>{let o={};for(let c of Object.keys(n)){let f=n[c];if(f instanceof T)o[c]=f.inverseLuminance;else if(typeof f==="string"&&f.match(/^(#[0-9a-fA-F]{3}|rgba?\(|hsla?\()/))o[c]=T.fromCss(f).inverseLuminance}return o},fn=new Proxy({},{get(n,o){if(n[o]===void 0){let c=`--${o.replace(/[A-Z]/g,(f)=>`-${f.toLocaleLowerCase()}`)}`;n[o]=(f)=>`var(${c}, ${f})`}return n[o]}}),Bn=new Proxy({},{get(n,o){if(o==="default")return fn;if(n[o]==null){o=o.replace(/[A-Z]/g,(y)=>`-${y.toLocaleLowerCase()}`);let[,c,,f,r,x]=o.match(/^([^\d_]*)((_)?(\d+)(\w*))?$/),X=`--${c}`;if(r!=null){let y=f==null?Number(r)/100:-Number(r)/100;switch(x){case"b":{let E=getComputedStyle(document.body).getPropertyValue(X);n[o]=y>0?T.fromCss(E).brighten(y).rgba:T.fromCss(E).darken(-y).rgba}break;case"s":{let E=getComputedStyle(document.body).getPropertyValue(X);n[o]=y>0?T.fromCss(E).saturate(y).rgba:T.fromCss(E).desaturate(-y).rgba}break;case"h":{let E=getComputedStyle(document.body).getPropertyValue(X);n[o]=T.fromCss(E).rotate(y*100).rgba,console.log(T.fromCss(E).hsla,T.fromCss(E).rotate(y).hsla)}break;case"o":{let E=getComputedStyle(document.body).getPropertyValue(X);n[o]=T.fromCss(E).opacity(y).rgba}break;case"":n[o]=`calc(var(${X}) * ${y})`;break;default:throw console.error(x),new Error(`Unrecognized method ${x} for css variable ${X}`)}}else n[o]=`var(${X})`}return n[o]}});var Io=0;function wn(){return`custom-elt${(Io++).toString(36)}`}var $o=0,v={};function Po(n,o){let c=v[n],f=u(o).replace(/:host\b/g,n);v[n]=c?c+`
`+f:f}function uo(n){if(v[n])document.head.append(k.style({id:n+"-component"},v[n]));delete v[n]}class J extends HTMLElement{static elements=k;static _elementCreator;instanceId;styleNode;static styleSpec;static styleNode;content=k.slot();isSlotted;static _tagName=null;static get tagName(){return this._tagName}static StyleNode(n){return console.warn("StyleNode is deprecated, just assign static styleSpec: XinStyleSheet to the class directly"),k.style(u(n))}static elementCreator(n={}){if(this._elementCreator==null){let{tag:o,styleSpec:c}=n,f=n!=null?o:null;if(f==null)if(typeof this.name==="string"&&this.name!==""){if(f=D(this.name),f.startsWith("-"))f=f.slice(1)}else f=wn();if(customElements.get(f)!=null)console.warn(`${f} is already defined`);if(f.match(/\w+(-\w+)+/)==null)console.warn(`${f} is not a legal tag for a custom-element`),f=wn();while(customElements.get(f)!==void 0)f=wn();if(this._tagName=f,c!==void 0)Po(f,c);window.customElements.define(f,this,n),this._elementCreator=k[f]}return this._elementCreator}initAttributes(...n){let o={},c={};new MutationObserver((r)=>{let x=!1;if(r.forEach((X)=>{x=!!(X.attributeName&&n.includes(Eo(X.attributeName)))}),x&&this.queueRender!==void 0)this.queueRender(!1)}).observe(this,{attributes:!0}),n.forEach((r)=>{o[r]=H(this[r]);let x=D(r);Object.defineProperty(this,r,{enumerable:!1,get(){if(typeof o[r]==="boolean")return this.hasAttribute(x);else if(this.hasAttribute(x))return typeof o[r]==="number"?parseFloat(this.getAttribute(x)):this.getAttribute(x);else if(c[r]!==void 0)return c[r];else return o[r]},set(X){if(typeof o[r]==="boolean"){if(X!==this[r]){if(X)this.setAttribute(x,"");else this.removeAttribute(x);this.queueRender()}}else if(typeof o[r]==="number"){if(X!==parseFloat(this[r]))this.setAttribute(x,X),this.queueRender()}else if(typeof X==="object"||`${X}`!==`${this[r]}`){if(X===null||X===void 0||typeof X==="object")this.removeAttribute(x);else this.setAttribute(x,X);this.queueRender(),c[r]=X}}})})}initValue(){let n=Object.getOwnPropertyDescriptor(this,"value");if(n===void 0||n.get!==void 0||n.set!==void 0)return;let o=this.hasAttribute("value")?this.getAttribute("value"):H(this.value);delete this.value,Object.defineProperty(this,"value",{enumerable:!1,get(){return o},set(c){if(o!==c)o=c,this.queueRender(!0)}})}_parts;get parts(){let n=this.shadowRoot!=null?this.shadowRoot:this;if(this._parts==null)this._parts=new Proxy({},{get(o,c){if(o[c]===void 0){let f=n.querySelector(`[part="${c}"]`);if(f==null)f=n.querySelector(c);if(f==null)throw new Error(`elementRef "${c}" does not exist!`);f.removeAttribute("data-ref"),o[c]=f}return o[c]}});return this._parts}constructor(){super();$o+=1,this.initAttributes("hidden"),this.instanceId=`${this.tagName.toLocaleLowerCase()}-${$o}`,this._value=H(this.defaultValue)}connectedCallback(){if(uo(this.constructor.tagName),this.hydrate(),this.role!=null)this.setAttribute("role",this.role);if(this.onResize!==void 0){if(g.observe(this),this._onResize==null)this._onResize=this.onResize.bind(this);this.addEventListener("resize",this._onResize)}if(this.value!=null&&this.getAttribute("value")!=null)this._value=this.getAttribute("value");this.queueRender()}disconnectedCallback(){g.unobserve(this)}_changeQueued=!1;_renderQueued=!1;queueRender(n=!1){if(!this._hydrated)return;if(!this._changeQueued)this._changeQueued=n;if(!this._renderQueued)this._renderQueued=!0,requestAnimationFrame(()=>{if(this._changeQueued)Hn(this,"change");this._changeQueued=!1,this._renderQueued=!1,this.render()})}_hydrated=!1;hydrate(){if(!this._hydrated){this.initValue();let n=typeof this.content!=="function",o=typeof this.content==="function"?this.content():this.content,{styleSpec:c}=this.constructor,{styleNode:f}=this.constructor;if(c)f=this.constructor.styleNode=k.style(u(c)),delete this.constructor.styleNode;if(this.styleNode)console.warn(this,"styleNode is deprecrated, use static styleNode or statc styleSpec instead"),f=this.styleNode;if(f){let r=this.attachShadow({mode:"open"});r.appendChild(f.cloneNode(!0)),zn(r,o,n)}else if(o!==null){let r=Array.from(this.childNodes);zn(this,o,n),this.isSlotted=this.querySelector("slot,xin-slot")!==void 0;let x=Array.from(this.querySelectorAll("slot"));if(x.length>0)x.forEach(Kn.replaceSlot);if(r.length>0){let X={"":this};Array.from(this.querySelectorAll("xin-slot")).forEach((y)=>{X[y.name]=y}),r.forEach((y)=>{let E=X[""],F=y instanceof Element?X[y.slot]:E;(F!==void 0?F:E).append(y)})}}this._hydrated=!0}}render(){}}class Kn extends J{name="";content=null;static replaceSlot(n){let o=document.createElement("xin-slot");if(n.name!=="")o.setAttribute("name",n.name);n.replaceWith(o)}constructor(){super();this.initAttributes("name")}}var hc=Kn.elementCreator({tag:"xin-slot"});var mo=(n=()=>!0)=>{let o=localStorage.getItem("xin-state");if(o!=null){let f=JSON.parse(o);for(let r of Object.keys(f).filter(n))if($[r]!==void 0)Object.assign($[r],f[r]);else $[r]=f[r]}let c=Zn(()=>{let f={},r=C($);for(let x of Object.keys(r).filter(n))f[x]=r[x];localStorage.setItem("xin-state",JSON.stringify(f)),console.log("xin state saved to localStorage")},500);N(n,c)};var Rn="0.8.10";function rn(n){return Object.assign(I,n),I}var Fo=!1;function jn(n,o=!1){if(o){if(!Fo)console.warn("xinProxy(..., true) is deprecated; use boxedProxy(...) instead"),Fo=!0;return rn(n)}return Object.keys(n).forEach((c)=>{$[c]=n[c]}),$}var po={};async function Xn(n,o){let{type:c,styleSpec:f}=await o(n,{Color:T,Component:J,elements:k,svgElements:Qn,mathML:Yn,varDefault:fn,vars:Bn,xin:$,boxed:I,xinProxy:jn,boxedProxy:rn,makeComponent:Xn,version:Rn}),r={type:c,creator:c.elementCreator({tag:n,styleSpec:f})};return po[n]=r,r}var _n={};class Blueprint extends J{tag="anon-elt";src="";property="default";loaded;onload=()=>{};async packaged(){let{tag,src,property}=this,signature=`${tag}.${property}:${src}`;if(!this.loaded){if(_n[signature]===void 0){let imported=await eval(`import('${src}')`),blueprint=imported[property];_n[signature]=Xn(tag,blueprint)}else console.log(`using cached ${tag}`);this.loaded=await _n[signature],this.onload()}return this.loaded}constructor(){super();this.initAttributes("tag","src","property")}}var No=Blueprint.elementCreator({tag:"xin-blueprint",styleSpec:{":host":{display:"none"}}});class Vn extends J{onload=()=>{};constructor(){super()}async load(){let o=Array.from(this.querySelectorAll(Blueprint.tagName)).filter((c)=>c.src).map((c)=>c.packaged());await Promise.all(o),this.onload()}connectedCallback(){super.connectedCallback(),this.load()}}var go=Vn.elementCreator({tag:"xin-loader",styleSpec:{":host":{display:"none"}}});export{C as xinValue,jn as xinProxy,m as xinPath,$ as xin,Rn as version,Bn as vars,fn as varDefault,mn as updates,nn as unobserve,j as touch,Jn as throttle,Qn as svgElements,U as settings,Dn as on,e as observerShouldBeRemoved,N as observe,Yn as mathML,Xn as makeComponent,Vo as invertLuminance,jo as initVars,mo as hotReload,Fn as getListItem,k as elements,Zn as debounce,_o as darkMode,u as css,rn as boxedProxy,I as boxed,go as blueprintLoader,No as blueprint,on as bindings,P as bind,wo as StyleSheet,Qo as MoreMath,J as Component,T as Color,Vn as BlueprintLoader,Blueprint};

//# debugId=788D140C66B8F70E64756E2164756E21
//# sourceMappingURL=module.js.map
