var H={debug:!1,perf:!1};function C(n){if(n==null||typeof n!=="object")return n;if(n instanceof Set)return new Set(n);else if(Array.isArray(n))return n.map(C);let e={};for(let o in n){let i=n[o];if(n!=null&&typeof n==="object")e[o]=C(i);else e[o]=i}return e}var un="-xin-data",L=`.${un}`,pn="-xin-event",yn=`.${pn}`,b="xinPath",O="xinValue",Yn="xinSet",Jn="xinObserve",Vn="xinBind",Un="xinOn",M=(n)=>{return n&&n[b]||void 0};function w(n){return typeof n==="object"&&n!==null?n[O]||n:n}var $=new WeakMap,v=new WeakMap;var z=(n)=>{let e=n.cloneNode();if(e instanceof Element){let o=v.get(n),i=$.get(n);if(o!=null)v.set(e,C(o));if(i!=null)$.set(e,C(i))}for(let o of Array.from(n instanceof HTMLTemplateElement?n.content.childNodes:n.childNodes))if(o instanceof Element||o instanceof DocumentFragment)e.appendChild(z(o));else e.appendChild(o.cloneNode());return e},_=new WeakMap,mn=(n)=>{let e=document.body.parentElement;while(n.parentElement!=null&&n.parentElement!==e){let o=_.get(n);if(o!=null)return o;n=n.parentElement}return!1};var _n=Symbol("observer should be removed"),N=[],nn=[],xn=!1,hn,bn;class Gn{description;test;callback;constructor(n,e){let o=typeof e==="string"?`"${e}"`:`function ${e.name}`,i;if(typeof n==="string")this.test=(t)=>typeof t==="string"&&t!==""&&(n.startsWith(t)||t.startsWith(n)),i=`test = "${n}"`;else if(n instanceof RegExp)this.test=n.test.bind(n),i=`test = "${n.toString()}"`;else if(n instanceof Function)this.test=n,i=`test = function ${n.name}`;else throw Error("expect listener test to be a string, RegExp, or test function");if(this.description=`${i}, ${o}`,typeof e==="function")this.callback=e;else throw Error("expect callback to be a path or function");N.push(this)}}var Zn=async()=>{if(hn===void 0)return;await hn},ge=()=>{if(H.perf)console.time("xin async update");let n=Array.from(nn);for(let e of n)N.filter((o)=>{let i;try{i=o.test(e)}catch(t){throw Error(`Listener ${o.description} threw "${t}" at "${e}"`)}if(i===_n)return G(o),!1;return i}).forEach((o)=>{let i;try{i=o.callback(e)}catch(t){console.error(`Listener ${o.description} threw "${t}" handling "${e}"`)}if(i===_n)G(o)});if(nn.splice(0),xn=!1,typeof bn==="function")bn();if(H.perf)console.timeEnd("xin async update")},W=(n)=>{let e=typeof n==="string"?n:M(n);if(e===void 0)throw console.error("touch was called on an invalid target",n),Error("touch was called on an invalid target");if(xn===!1)hn=new Promise((o)=>{bn=o}),xn=setTimeout(ge);if(nn.find((o)=>e.startsWith(o))==null)nn.push(e)},wn=(n,e)=>{return new Gn(n,e)},G=(n)=>{let e=N.indexOf(n);if(e>-1)N.splice(e,1);else throw Error("unobserve failed, listener not found")};var Te=(n)=>{try{return JSON.stringify(n)}catch(e){return"{has circular references}"}},gn=(...n)=>Error(n.map(Te).join(" "));var Xe=()=>new Date(parseInt("1000000000",36)+Date.now()).valueOf().toString(36).slice(1),Ee=0,Se=()=>(parseInt("10000",36)+ ++Ee).toString(36).slice(-5),ke=()=>Xe()+Se(),Xn=Symbol("delete"),Kn=Symbol("new-object"),Tn=Symbol("automatic-index");function Rn(n){if(n==="")return[];if(Array.isArray(n))return n;else{let e=[];while(n.length>0){let o=n.search(/\[[^\]]+\]/);if(o===-1){e.push(n.split("."));break}else{let i=n.slice(0,o);if(n=n.slice(o),i!=="")e.push(i.split("."));if(o=n.indexOf("]")+1,e.push(n.slice(1,o-1)),n.slice(o,o+1)===".")o+=1;n=n.slice(o)}}return e}}var D=new WeakMap;function Nn(n,e){if(D.get(n)===void 0)D.set(n,{});if(D.get(n)[e]===void 0)D.get(n)[e]={};let o=D.get(n)[e];if(e==="_auto_")n.forEach((i,t)=>{if(i[Tn]===void 0)i[Tn]=ke();o[i[Tn]+""]=t});else n.forEach((i,t)=>{o[I(i,e)+""]=t});return o}function Ce(n,e){if(D.get(n)===void 0||D.get(n)[e]===void 0)return Nn(n,e);else return D.get(n)[e]}function ve(n,e,o){o=o+"";let i=Ce(n,e)[o];if(i===void 0||I(n[i],e)+""!==o)i=Nn(n,e)[o];return i}function Me(n,e,o){if(n[e]===void 0&&o!==void 0)n[e]=o;return n[e]}function ne(n,e,o,i){let t=e!==""?ve(n,e,o):o;if(i===Xn)return n.splice(t,1),D.delete(n),Symbol("deleted");else if(i===Kn){if(e===""&&n[t]===void 0)n[t]={}}else if(i!==void 0)if(t!==void 0)n[t]=i;else if(e!==""&&I(i,e)+""===o+"")n.push(i),t=n.length-1;else throw Error(`byIdPath insert failed at [${e}=${o}]`);return n[t]}function qn(n){if(!Array.isArray(n))throw gn("setByPath failed: expected array, found",n)}function Qn(n){if(n==null||!(n instanceof Object))throw gn("setByPath failed: expected Object, found",n)}function I(n,e){let o=Rn(e),i=n,t,s,r,c;for(t=0,s=o.length;i!==void 0&&t<s;t++){let d=o[t];if(Array.isArray(d))for(r=0,c=d.length;i!==void 0&&r<c;r++){let l=d[r];i=i[l]}else if(i.length===0){if(i=i[Number(d.slice(1))],d[0]!=="=")return}else if(d.includes("=")){let[l,...p]=d.split("=");i=ne(i,l,p.join("="))}else r=parseInt(d,10),i=i[r]}return i}function ee(n,e,o){let i=n;if(e==="")throw Error("setByPath cannot be used to set the root object");let t=Rn(e);while(i!=null&&t.length>0){let s=t.shift();if(typeof s==="string"){let r=s.indexOf("=");if(r>-1){if(r===0)Qn(i);else qn(i);let c=s.slice(0,r),d=s.slice(r+1);if(i=ne(i,c,d,t.length>0?Kn:o),t.length===0)return!0}else{qn(i);let c=parseInt(s,10);if(t.length>0)i=i[c];else{if(o!==Xn){if(i[c]===o)return!1;i[c]=o}else i.splice(c,1);return!0}}}else if(Array.isArray(s)&&s.length>0){Qn(i);while(s.length>0){let r=s.shift();if(s.length>0||t.length>0)i=Me(i,r,s.length>0?{}:[]);else{if(o!==Xn){if(i[r]===o)return!1;i[r]=o}else{if(!Object.prototype.hasOwnProperty.call(i,r))return!1;delete i[r]}return!0}}}else throw Error(`setByPath failed, bad path ${e}`)}throw Error(`setByPath(${n}, ${e}, ${o}) failed`)}var De=["sort","splice","copyWithin","fill","pop","push","reverse","shift","unshift"],Sn={},Fe=!0,Le=/^\.?([^.[\](),])+(\.[^.[\](),]+|\[\d+\]|\[[^=[\](),]*=[^[\]()]+\])*$/,Be=(n)=>Le.test(n),A=(n="",e="")=>{if(n==="")return e;else if(e.match(/^\d+$/)!==null||e.includes("="))return`${n}[${e}]`;else return`${n}.${e}`},He={string(n){return new String(n)},boolean(n){return new Boolean(n)},bigint(n){return n},symbol(n){return n},number(n){return new Number(n)}};function En(n,e){let o=typeof n;if(n===void 0||o==="object"||o==="function")return n;else return new Proxy(He[typeof n](n),Y(e,!0))}var Y=(n,e)=>({get(o,i){switch(i){case b:return n;case O:return o.valueOf?o.valueOf():o;case Yn:return(r)=>f[n]=r;case Jn:return(r)=>{let c=wn(n,r);return()=>G(c)};case Un:return(r,c)=>j(r,c,w(o));case Vn:return(r,c,d)=>{g(r,n,c,d)}}if(typeof i==="symbol")return o[i];let t=i,s=t.match(/^([^.[]+)\.(.+)$/)??t.match(/^([^\]]+)(\[.+)/)??t.match(/^(\[[^\]]+\])\.(.+)$/)??t.match(/^(\[[^\]]+\])\[(.+)$/);if(s!==null){let[,r,c]=s,d=A(n,r),l=I(o,r);return l!==null&&typeof l==="object"?new Proxy(l,Y(d,e))[c]:l}if(t.startsWith("[")&&t.endsWith("]"))t=t.substring(1,t.length-1);if(!Array.isArray(o)&&o[t]!==void 0||Array.isArray(o)&&t.includes("=")){let r;if(t.includes("=")){let[c,d]=t.split("=");r=o.find((l)=>`${I(l,c)}`===d)}else r=o[t];if(r instanceof Object){let c=A(n,t);return new Proxy(r instanceof Function?r.bind(o):r,Y(c,e))}else return e?En(r,A(n,t)):r}else if(Array.isArray(o)){let r=o[t];return typeof r==="function"?(...c)=>{let d=r.apply(o,c);if(De.includes(t))W(n);return d}:typeof r==="object"?new Proxy(r,Y(A(n,t),e)):e?En(r,A(n,t)):r}else return e?En(o[t],A(n,t)):o[t]},set(o,i,t){t=w(t);let s=i!==O?A(n,i):n;if(Fe&&!Be(s))throw Error(`setting invalid path ${s}`);if(w(f[s])!==t&&ee(Sn,s,t))W(s);return!0}}),Z=(n,e)=>{let o=typeof e==="function"?e:f[e];if(typeof o!=="function")throw Error(`observe expects a function or path to a function, ${e} is neither`);return wn(n,o)},f=new Proxy(Sn,Y("",!1)),J=new Proxy(Sn,Y("",!0));var kn=(n,e)=>{let o=new Event(e);n.dispatchEvent(o)},ie=(n)=>{if(n instanceof HTMLInputElement)return n.type;else if(n instanceof HTMLSelectElement&&n.hasAttribute("multiple"))return"multi-select";else return"other"},te=(n,e)=>{switch(ie(n)){case"radio":n.checked=n.value===e;break;case"checkbox":n.checked=!!e;break;case"date":n.valueAsDate=new Date(e);break;case"multi-select":for(let o of Array.from(n.querySelectorAll("option")))o.selected=e[o.value];break;default:n.value=e}},re=(n)=>{switch(ie(n)){case"radio":{let e=n.parentElement?.querySelector(`[name="${n.name}"]:checked`);return e!=null?e.value:null}case"checkbox":return n.checked;case"date":return n.valueAsDate?.toISOString();case"multi-select":return Array.from(n.querySelectorAll("option")).reduce((e,o)=>{return e[o.value]=o.selected,e},{});default:return n.value}},{ResizeObserver:oe}=globalThis,q=oe!=null?new oe((n)=>{for(let e of n){let o=e.target;kn(o,"resize")}}):{observe(){},unobserve(){}},Cn=(n,e,o=!0)=>{if(n!=null&&e!=null)if(typeof e==="string")n.textContent=e;else if(Array.isArray(e))e.forEach((i)=>{n.append(i instanceof Node&&o?z(i):i)});else if(e instanceof Node)n.append(o?z(e):e);else throw Error("expect text content or document node")};var vn=(n,e=250)=>{let o;return(...i)=>{if(o!==void 0)clearTimeout(o);o=setTimeout(()=>{n(...i)},e)}},en=(n,e=250)=>{let o,i=Date.now()-e,t=!1;return(...s)=>{if(clearTimeout(o),o=setTimeout(()=>{n(...s),i=Date.now()},e),!t&&Date.now()-i>=e){t=!0;try{n(...s),i=Date.now()}finally{t=!1}}}};var on=Symbol("list-binding"),$e=16,Oe=100;function se(n,e){let o=Array.from(n.querySelectorAll(L));if(n.matches(L))o.unshift(n);for(let i of o){let t=v.get(i);for(let s of t){if(s.path.startsWith("^"))s.path=`${e}${s.path.substring(1)}`;if(s.binding.toDOM!=null)s.binding.toDOM(i,f[s.path])}}}class ce{boundElement;listTop;listBottom;template;options;itemToElement;_array=[];_update;_previousSlice;static filterBoundObservers=new WeakMap;constructor(n,e,o={}){if(this.boundElement=n,this.itemToElement=new WeakMap,n.children.length!==1)throw Error("ListBinding expects an element with exactly one child element");if(n.children[0]instanceof HTMLTemplateElement){let i=n.children[0];if(i.content.children.length!==1)throw Error("ListBinding expects a template with exactly one child element");this.template=z(i.content.children[0])}else this.template=n.children[0],this.template.remove();if(this.options=o,this.listTop=document.createElement("div"),this.listBottom=document.createElement("div"),this.listTop.classList.add("virtual-list-padding"),this.listBottom.classList.add("virtual-list-padding"),this.boundElement.append(this.listTop),this.boundElement.append(this.listBottom),o.virtual!=null)q.observe(this.boundElement),this._update=en(()=>{this.update(this._array,!0)},$e),this.boundElement.addEventListener("scroll",this._update),this.boundElement.addEventListener("resize",this._update)}visibleSlice(){let{virtual:n,hiddenProp:e,visibleProp:o}=this.options,i=this._array;if(e!==void 0)i=i.filter((d)=>d[e]!==!0);if(o!==void 0)i=i.filter((d)=>d[o]===!0);if(this.options.filter&&this.needle!==void 0)i=this.options.filter(i,this.needle);let t=0,s=i.length-1,r=0,c=0;if(n!=null&&this.boundElement instanceof HTMLElement){let d=this.boundElement.offsetWidth,l=this.boundElement.offsetHeight;if(n.visibleColumns==null)n.visibleColumns=n.width!=null?Math.max(1,Math.floor(d/n.width)):1;let p=Math.ceil(l/n.height)+(n.rowChunkSize||1),E=Math.ceil(i.length/n.visibleColumns),S=n.visibleColumns*p,y=Math.floor(this.boundElement.scrollTop/n.height);if(y>E-p+1)y=Math.max(0,E-p+1);if(n.rowChunkSize)y-=y%n.rowChunkSize;t=y*n.visibleColumns,s=t+S-1,r=y*n.height,c=Math.max((E-p)*n.height-r,0)}return{items:i,firstItem:t,lastItem:s,topBuffer:r,bottomBuffer:c}}needle;filter=en((n)=>{if(this.needle!==n)this.needle=n,this.update(this._array)},Oe);update(n,e){if(n==null)n=[];this._array=n;let{hiddenProp:o,visibleProp:i}=this.options,t=M(n),s=this.visibleSlice();this.boundElement.classList.toggle("-xin-empty-list",s.items.length===0);let r=this._previousSlice,{firstItem:c,lastItem:d,topBuffer:l,bottomBuffer:p}=s;if(o===void 0&&i===void 0&&e===!0&&r!=null&&c===r.firstItem&&d===r.lastItem)return;this._previousSlice=s;let E=0,S=0,y=0;for(let u of Array.from(this.boundElement.children)){if(u===this.listTop||u===this.listBottom)continue;let k=_.get(u);if(k==null)u.remove();else{let h=s.items.indexOf(k);if(h<c||h>d)u.remove(),this.itemToElement.delete(k),_.delete(u),E++}}this.listTop.style.height=String(l)+"px",this.listBottom.style.height=String(p)+"px";let x=[],{idPath:ln}=this.options;for(let u=c;u<=d;u++){let k=s.items[u];if(k===void 0)continue;let h=this.itemToElement.get(w(k));if(h==null){if(y++,h=z(this.template),typeof k==="object")this.itemToElement.set(w(k),h),_.set(h,w(k));if(this.boundElement.insertBefore(h,this.listBottom),ln!=null){let fn=k[ln],we=`${t}[${ln}=${fn}]`;se(h,we)}else{let fn=`${t}[${u}]`;se(h,fn)}}x.push(h)}let R=null;for(let u of x){if(u.previousElementSibling!==R)if(S++,R?.nextElementSibling!=null)this.boundElement.insertBefore(u,R.nextElementSibling);else this.boundElement.insertBefore(u,this.listBottom);R=u}if(H.perf)console.log(t,"updated",{removed:E,created:y,moved:S})}}var de=(n,e,o)=>{let i=n[on];if(i===void 0)i=new ce(n,e,o),n[on]=i;return i};var{document:Q,MutationObserver:ae}=globalThis,Mn=(n,e)=>{let o=v.get(n);if(o==null)return;for(let i of o){let{binding:t,options:s}=i,{path:r}=i,{toDOM:c}=t;if(c!=null){if(r.startsWith("^")){let d=mn(n);if(d!=null&&d[b]!=null)r=i.path=`${d[b]}${r.substring(1)}`;else throw console.error(`Cannot resolve relative binding ${r}`,n,"is not part of a list"),Error(`Cannot resolve relative binding ${r}`)}if(e==null||r.startsWith(e))c(n,f[r],s)}}};if(ae!=null)new ae((e)=>{e.forEach((o)=>{Array.from(o.addedNodes).forEach((i)=>{if(i instanceof Element)Array.from(i.querySelectorAll(L)).forEach((t)=>Mn(t))})})}).observe(Q.body,{subtree:!0,childList:!0});Z(()=>!0,(n)=>{let e=Array.from(Q.querySelectorAll(L));for(let o of e)Mn(o,n)});var le=(n)=>{let e=n.target.closest(L);while(e!=null){let o=v.get(e);for(let i of o){let{binding:t,path:s}=i,{fromDOM:r}=t;if(r!=null){let c;try{c=r(e,i.options)}catch(d){throw console.error("Cannot get value from",e,"via",i),Error("Cannot obtain value fromDOM")}if(c!=null){let d=f[s];if(d==null)f[s]=c;else{let l=d[b]!=null?d[O]:d,p=c[b]!=null?c[O]:c;if(l!==p)f[s]=p}}}}e=e.parentElement.closest(L)}};if(globalThis.document!=null)Q.body.addEventListener("change",le,!0),Q.body.addEventListener("input",le,!0);function g(n,e,o,i){if(n instanceof DocumentFragment)throw Error("bind cannot bind to a DocumentFragment");let t;if(typeof e==="object"&&e[b]===void 0&&i===void 0){let{value:c}=e;t=typeof c==="string"?c:c[b],i=e,delete i.value}else t=typeof e==="string"?e:e[b];if(t==null)throw Error("bind requires a path or object with xin Proxy");let{toDOM:s}=o;n.classList?.add(un);let r=v.get(n);if(r==null)r=[],v.set(n,r);if(r.push({path:t,binding:o,options:i}),s!=null&&!t.startsWith("^"))W(t);if(i?.filter&&i?.needle)g(n,i.needle,{toDOM(c,d){console.log({needle:d}),c[on]?.filter(d)}});return n}var fe=new Set,ze=(n)=>{let e=n?.target.closest(yn),o=!1,i=new Proxy(n,{get(s,r){if(r==="stopPropagation")return()=>{n.stopPropagation(),o=!0};else{let c=s[r];return typeof c==="function"?c.bind(s):c}}}),t=new Set;while(!o&&e!=null){let r=$.get(e)[n.type]||t;for(let c of r){if(typeof c==="function")c(i);else{let d=f[c];if(typeof d==="function")d(i);else throw Error(`no event handler found at path ${c}`)}if(o)continue}e=e.parentElement!=null?e.parentElement.closest(yn):null}};function j(n,e,o){let i=$.get(n);if(n.classList.add(pn),i==null)i={},$.set(n,i);if(!i[e])i[e]=new Set;if(i[e].add(o),!fe.has(e))fe.add(e),Q.body.addEventListener(e,ze,!0);return()=>{i[e].delete(o)}}var tn={value:{toDOM:te,fromDOM(n){return re(n)}},text:{toDOM(n,e){n.textContent=e}},enabled:{toDOM(n,e){n.disabled=!e}},disabled:{toDOM(n,e){n.disabled=Boolean(e)}},list:{toDOM(n,e,o){de(n,e,o).update(e)}}};var Ae=180/Math.PI,je=Math.PI/180;function T(n,e,o){return o<n?NaN:e<n?n:e>o?o:e}function F(n,e,o,i=!0){if(i)o=T(0,o,1);return o*(e-n)+n}var Pe={RADIANS_TO_DEGREES:Ae,DEGREES_TO_RADIANS:je,clamp:T,lerp:F};function Dn(n,e=document.body){let o=getComputedStyle(e);if(n.endsWith(")")&&n.startsWith("var("))n=n.slice(4,-1);return o.getPropertyValue(n).trim()}var We=(n,e,o)=>{return(0.299*n+0.587*e+0.114*o)/255},P=(n)=>("00"+Math.round(Number(n)).toString(16)).slice(-2);class ue{h;s;l;constructor(n,e,o){n/=255,e/=255,o/=255;let i=Math.max(n,e,o),t=i-Math.min(n,e,o),s=t!==0?i===n?(e-o)/t:i===e?2+(o-n)/t:4+(n-e)/t:0;this.h=60*s<0?60*s+360:60*s,this.s=t!==0?i<=0.5?t/(2*i-t):t/(2-(2*i-t)):0,this.l=(2*i-t)/2}}var V=globalThis.document!==void 0?globalThis.document.createElement("span"):void 0;class a{r;g;b;a;static fromVar(n,e=document.body){return a.fromCss(Dn(n,e))}static fromCss(n){let e=n;if(V instanceof HTMLSpanElement)V.style.color="black",V.style.color=n,document.body.appendChild(V),e=getComputedStyle(V).color,V.remove();let[o,i,t,s]=e.match(/[\d.]+/g)||["0","0","0","0"],r=e.startsWith("color(srgb")?255:1;return new a(Number(o)*r,Number(i)*r,Number(t)*r,s==null?1:Number(s))}static fromHsl(n,e,o,i=1){let t,s,r;if(e===0)t=s=r=o;else{let d=(S,y,x)=>{if(x<0)x+=1;if(x>1)x-=1;if(x<0.16666666666666666)return S+(y-S)*6*x;if(x<0.5)return y;if(x<0.6666666666666666)return S+(y-S)*(0.6666666666666666-x)*6;return S},l=o<0.5?o*(1+e):o+e-o*e,p=2*o-l,E=(n%360+360)%360/360;t=d(p,l,E+0.3333333333333333),s=d(p,l,E),r=d(p,l,E-0.3333333333333333)}let c=new a(t*255,s*255,r*255,i);return c.hslCached={h:(n%360+360)%360,s:e,l:o},c}static black=new a(0,0,0);static white=new a(255,255,255);constructor(n,e,o,i=1){this.r=T(0,n,255),this.g=T(0,e,255),this.b=T(0,o,255),this.a=T(0,i,1)}get inverse(){return new a(255-this.r,255-this.g,255-this.b,this.a)}get inverseLuminance(){let{h:n,s:e,l:o}=this._hsl;return a.fromHsl(n,e,1-o,this.a)}get opaque(){return this.a===1?this:new a(this.r,this.g,this.b,1)}contrasting(n=1){return this.opaque.blend(this.brightness>0.5?a.black:a.white,n)}get rgb(){let{r:n,g:e,b:o}=this;return`rgb(${n.toFixed(0)},${e.toFixed(0)},${o.toFixed(0)})`}get rgba(){let{r:n,g:e,b:o,a:i}=this;return`rgba(${n.toFixed(0)},${e.toFixed(0)},${o.toFixed(0)},${i.toFixed(2)})`}get RGBA(){return[this.r/255,this.g/255,this.b/255,this.a]}get ARGB(){return[this.a,this.r/255,this.g/255,this.b/255]}hslCached;get _hsl(){if(this.hslCached==null)this.hslCached=new ue(this.r,this.g,this.b);return this.hslCached}get hsl(){let{h:n,s:e,l:o}=this._hsl;return`hsl(${n.toFixed(0)}deg ${(e*100).toFixed(0)}% ${(o*100).toFixed(0)}%)`}get hsla(){let{h:n,s:e,l:o}=this._hsl;return`hsl(${n.toFixed(0)}deg ${(e*100).toFixed(0)}% ${(o*100).toFixed(0)}% / ${(this.a*100).toFixed(0)}%)`}get mono(){let n=this.brightness*255;return new a(n,n,n)}get brightness(){return We(this.r,this.g,this.b)}get html(){return this.toString()}toString(){return this.a===1?"#"+P(this.r)+P(this.g)+P(this.b):"#"+P(this.r)+P(this.g)+P(this.b)+P(Math.floor(255*this.a))}brighten(n){let{h:e,s:o,l:i}=this._hsl,t=T(0,i+n*(1-i),1);return a.fromHsl(e,o,t,this.a)}darken(n){let{h:e,s:o,l:i}=this._hsl,t=T(0,i*(1-n),1);return a.fromHsl(e,o,t,this.a)}saturate(n){let{h:e,s:o,l:i}=this._hsl,t=T(0,o+n*(1-o),1);return a.fromHsl(e,t,i,this.a)}desaturate(n){let{h:e,s:o,l:i}=this._hsl,t=T(0,o*(1-n),1);return a.fromHsl(e,t,i,this.a)}rotate(n){let{h:e,s:o,l:i}=this._hsl,t=(e+360+n)%360;return a.fromHsl(t,o,i,this.a)}opacity(n){let{h:e,s:o,l:i}=this._hsl;return a.fromHsl(e,o,i,n)}swatch(){return console.log(`%c      %c ${this.html}, ${this.rgba}`,`background-color: ${this.html}`,"background-color: transparent"),this}blend(n,e){return new a(F(this.r,n.r,e),F(this.g,n.g,e),F(this.b,n.b,e),F(this.a,n.a,e))}static blendHue(n,e,o){let i=(e-n+720)%360;if(i<180)return n+o*i;else return n-(360-i)*o}mix(n,e){let o=this._hsl,i=n._hsl;return a.fromHsl(o.s===0?i.h:i.s===0?o.h:a.blendHue(o.h,i.h,e),F(o.s,i.s,e),F(o.l,i.l,e),F(this.a,n.a,e))}colorMix(n,e){return a.fromCss(`color-mix(in hsl, ${this.html}, ${n.html} ${(e*100).toFixed(0)}%)`)}}function X(n){return n.replace(/[A-Z]/g,(e)=>{return`-${e.toLocaleLowerCase()}`})}function pe(n){return n.replace(/-([a-z])/g,(e,o)=>{return o.toLocaleUpperCase()})}var Ie="http://www.w3.org/1998/Math/MathML",Ye="http://www.w3.org/2000/svg",rn={},ye=(n,e,o)=>{let i=$n(X(e),o);if(i.prop.startsWith("--"))n.style.setProperty(i.prop,i.value);else n.style[e]=i.value},Je=(n)=>{return{toDOM(e,o){ye(e,n,o)}}},me=(n,e,o)=>{if(e==="style")if(typeof o==="object")for(let i of Object.keys(o))if(M(o[i]))g(n,o[i],Je(i));else ye(n,i,o[i]);else n.setAttribute("style",o);else if(n[e]!==void 0){let{MathMLElement:i}=globalThis;if(n instanceof SVGElement||i!==void 0&&n instanceof i)n.setAttribute(e,o);else n[e]=o}else{let i=X(e);if(i==="class")o.split(" ").forEach((t)=>{n.classList.add(t)});else if(n[i]!==void 0)n[i]=o;else if(typeof o==="boolean")o?n.setAttribute(i,""):n.removeAttribute(i);else n.setAttribute(i,o)}},Ve=(n)=>{return{toDOM(e,o){me(e,n,o)}}},Ue=(n,e,o)=>{if(e==="apply")o(n);else if(e.match(/^on[A-Z]/)!=null){let i=e.substring(2).toLowerCase();j(n,i,o)}else if(e==="bind")if((typeof o.binding==="string"?tn[o.binding]:o.binding)!==void 0&&o.value!==void 0)g(n,o.value,o.binding instanceof Function?{toDOM:o.binding}:o.binding);else throw Error("bad binding");else if(e.match(/^bind[A-Z]/)!=null){let i=e.substring(4,5).toLowerCase()+e.substring(5),t=tn[i];if(t!==void 0)g(n,o,t);else throw Error(`${e} is not allowed, bindings.${i} is not defined`)}else if(M(o))g(n,o,Ve(e));else me(n,e,o)},Fn=(n,...e)=>{if(rn[n]===void 0){let[t,s]=n.split("|");if(s===void 0)rn[n]=globalThis.document.createElement(t);else rn[n]=globalThis.document.createElementNS(s,t)}let o=rn[n].cloneNode(),i={};for(let t of e)if(t instanceof Element||t instanceof DocumentFragment||typeof t==="string"||typeof t==="number")if(o instanceof HTMLTemplateElement)o.content.append(t);else o.append(t);else if(M(t))o.append(m.span({bindText:t}));else Object.assign(i,t);for(let t of Object.keys(i)){let s=i[t];Ue(o,t,s)}return o},Ln=(...n)=>{let e=globalThis.document.createDocumentFragment();for(let o of n)e.append(o);return e},m=new Proxy({fragment:Ln},{get(n,e){if(e=e.replace(/[A-Z]/g,(o)=>`-${o.toLocaleLowerCase()}`),n[e]===void 0)n[e]=(...o)=>Fn(e,...o);return n[e]},set(){throw Error("You may not add new properties to elements")}}),Bn=new Proxy({fragment:Ln},{get(n,e){if(n[e]===void 0)n[e]=(...o)=>Fn(`${e}|${Ye}`,...o);return n[e]},set(){throw Error("You may not add new properties to elements")}}),Hn=new Proxy({fragment:Ln},{get(n,e){if(n[e]===void 0)n[e]=(...o)=>Fn(`${e}|${Ie}`,...o);return n[e]},set(){throw Error("You may not add new properties to elements")}});function _e(n,e){let o=m.style(U(e));o.id=n,document.head.append(o)}var Ge=["animation-iteration-count","flex","flex-base","flex-grow","flex-shrink","opacity","order","tab-size","widows","z-index","zoom"],$n=(n,e)=>{if(typeof e==="number"&&!Ge.includes(n))e=`${e}px`;if(n.startsWith("_"))if(n.startsWith("__"))n="--"+n.substring(2),e=`var(${n}-default, ${e})`;else n="--"+n.substring(1);return{prop:n,value:String(e)}},Ze=(n,e,o)=>{if(o===void 0)return"";if(o instanceof a)o=o.html;let i=$n(e,o);return`${n}  ${i.prop}: ${i.value};`},xe=(n,e,o="")=>{let i=X(n);if(typeof e==="object"&&!(e instanceof a)){let t=Object.keys(e).map((s)=>xe(s,e[s],`${o}  `)).join(`
`);return`${o}  ${n} {
${t}
${o}  }`}else return Ze(o,i,e)},U=(n,e="")=>{return Object.keys(n).map((i)=>{let t=n[i];if(typeof t==="string"){if(i==="@import")return`@import url('${t}');`;throw Error("top-level string value only allowed for `@import`")}let s=Object.keys(t).map((r)=>xe(r,t[r])).join(`
`);return`${e}${i} {
${s}
}`}).join(`

`)},qe=(n)=>{console.warn("initVars is deprecated. Just use _ and __ prefixes instead.");let e={};for(let o of Object.keys(n)){let i=n[o],t=X(o);e[`--${t}`]=typeof i==="number"&&i!==0?String(i)+"px":i}return e},Qe=(n)=>{let e={};for(let o of Object.keys(n)){let i=n[o];if(i instanceof a)e[o]=i.inverseLuminance;else if(typeof i==="string"&&i.match(/^(#[0-9a-fA-F]{3}|rgba?\(|hsla?\()/))e[o]=a.fromCss(i).inverseLuminance}return e},sn=new Proxy({},{get(n,e){if(n[e]===void 0){let o="--"+X(e);n[e]=(i)=>`var(${o}, ${i})`}return n[e]}}),On=new Proxy({},{get(n,e){if(e==="default")return sn;if(n[e]==null){e=X(e);let[,o,,i,t,s]=e.match(/^([-\w]*?)((_)?(\d+)(\w?))?$/)||["",e],r=`--${o}`;if(t!=null){let c=i==null?Number(t)/100:-Number(t)/100;switch(s){case"b":{let d=a.fromVar(r);n[e]=c>0?d.brighten(c).rgba:d.darken(-c).rgba}break;case"s":{let d=a.fromVar(r);n[e]=c>0?d.saturate(c).rgba:d.desaturate(-c).rgba}break;case"h":{let d=a.fromVar(r);n[e]=d.rotate(c*100).rgba}break;case"o":{let d=a.fromVar(r);n[e]=d.opacity(c).rgba}break;case"":n[e]=`calc(var(${r}) * ${c})`;break;default:throw console.error(s),Error(`Unrecognized method ${s} for css variable ${r}`)}}else n[e]=`var(${r})`}return n[e]}});var Ke=0;function zn(){return`custom-elt${(Ke++).toString(36)}`}var he=0,K={};function Re(n,e){let o=K[n],i=U(e).replace(/:host\b/g,n);K[n]=o?o+`
`+i:i}function Ne(n){if(K[n])document.head.append(m.style({id:n+"-component"},K[n]));delete K[n]}class B extends HTMLElement{static elements=m;static _elementCreator;instanceId;styleNode;static styleSpec;static styleNode;content=m.slot();isSlotted;static _tagName=null;static get tagName(){return this._tagName}static StyleNode(n){return console.warn("StyleNode is deprecated, just assign static styleSpec: XinStyleSheet to the class directly"),m.style(U(n))}static elementCreator(n={}){if(this._elementCreator==null){let{tag:e,styleSpec:o}=n,i=n!=null?e:null;if(i==null)if(typeof this.name==="string"&&this.name!==""){if(i=X(this.name),i.startsWith("-"))i=i.slice(1)}else i=zn();if(customElements.get(i)!=null)console.warn(`${i} is already defined`);if(i.match(/\w+(-\w+)+/)==null)console.warn(`${i} is not a legal tag for a custom-element`),i=zn();while(customElements.get(i)!==void 0)i=zn();if(this._tagName=i,o!==void 0)Re(i,o);window.customElements.define(i,this,n),this._elementCreator=m[i]}return this._elementCreator}initAttributes(...n){let e={},o={};new MutationObserver((t)=>{let s=!1;if(t.forEach((r)=>{s=!!(r.attributeName&&n.includes(pe(r.attributeName)))}),s&&this.queueRender!==void 0)this.queueRender(!1)}).observe(this,{attributes:!0}),n.forEach((t)=>{e[t]=C(this[t]);let s=X(t);Object.defineProperty(this,t,{enumerable:!1,get(){if(typeof e[t]==="boolean")return this.hasAttribute(s);else if(this.hasAttribute(s))return typeof e[t]==="number"?parseFloat(this.getAttribute(s)):this.getAttribute(s);else if(o[t]!==void 0)return o[t];else return e[t]},set(r){if(typeof e[t]==="boolean"){if(r!==this[t]){if(r)this.setAttribute(s,"");else this.removeAttribute(s);this.queueRender()}}else if(typeof e[t]==="number"){if(r!==parseFloat(this[t]))this.setAttribute(s,r),this.queueRender()}else if(typeof r==="object"||`${r}`!==`${this[t]}`){if(r===null||r===void 0||typeof r==="object")this.removeAttribute(s);else this.setAttribute(s,r);this.queueRender(),o[t]=r}}})})}initValue(){let n=Object.getOwnPropertyDescriptor(this,"value");if(n===void 0||n.get!==void 0||n.set!==void 0)return;let e=this.hasAttribute("value")?this.getAttribute("value"):C(this.value);delete this.value,Object.defineProperty(this,"value",{enumerable:!1,get(){return e},set(o){if(e!==o)e=o,this.queueRender(!0)}})}_parts;get parts(){let n=this.shadowRoot!=null?this.shadowRoot:this;if(this._parts==null)this._parts=new Proxy({},{get(e,o){if(e[o]===void 0){let i=n.querySelector(`[part="${o}"]`);if(i==null)i=n.querySelector(o);if(i==null)throw Error(`elementRef "${o}" does not exist!`);i.removeAttribute("data-ref"),e[o]=i}return e[o]}});return this._parts}constructor(){super();he+=1,this.initAttributes("hidden"),this.instanceId=`${this.tagName.toLocaleLowerCase()}-${he}`,this._value=C(this.defaultValue)}connectedCallback(){if(Ne(this.constructor.tagName),this.hydrate(),this.role!=null)this.setAttribute("role",this.role);if(this.onResize!==void 0){if(q.observe(this),this._onResize==null)this._onResize=this.onResize.bind(this);this.addEventListener("resize",this._onResize)}if(this.value!=null&&this.getAttribute("value")!=null)this._value=this.getAttribute("value");this.queueRender()}disconnectedCallback(){q.unobserve(this)}_changeQueued=!1;_renderQueued=!1;queueRender(n=!1){if(!this._hydrated)return;if(!this._changeQueued)this._changeQueued=n;if(!this._renderQueued)this._renderQueued=!0,requestAnimationFrame(()=>{if(this._changeQueued)kn(this,"change");this._changeQueued=!1,this._renderQueued=!1,this.render()})}_hydrated=!1;hydrate(){if(!this._hydrated){this.initValue();let n=typeof this.content!=="function",e=typeof this.content==="function"?this.content():this.content,{styleSpec:o}=this.constructor,{styleNode:i}=this.constructor;if(o)i=this.constructor.styleNode=m.style(U(o)),delete this.constructor.styleNode;if(this.styleNode)console.warn(this,"styleNode is deprecrated, use static styleNode or statc styleSpec instead"),i=this.styleNode;if(i){let t=this.attachShadow({mode:"open"});t.appendChild(i.cloneNode(!0)),Cn(t,e,n)}else if(e!==null){let t=Array.from(this.childNodes);Cn(this,e,n),this.isSlotted=this.querySelector("slot,xin-slot")!==void 0;let s=Array.from(this.querySelectorAll("slot"));if(s.length>0)s.forEach(An.replaceSlot);if(t.length>0){let r={"":this};Array.from(this.querySelectorAll("xin-slot")).forEach((c)=>{r[c.name]=c}),t.forEach((c)=>{let d=r[""],l=c instanceof Element?r[c.slot]:d;(l!==void 0?l:d).append(c)})}}this._hydrated=!0}}render(){}}class An extends B{name="";content=null;static replaceSlot(n){let e=document.createElement("xin-slot");if(n.name!=="")e.setAttribute("name",n.name);n.replaceWith(e)}constructor(){super();this.initAttributes("name")}}var fi=An.elementCreator({tag:"xin-slot"});var no=(n=()=>!0)=>{let e=localStorage.getItem("xin-state");if(e!=null){let i=JSON.parse(e);for(let t of Object.keys(i).filter(n))if(f[t]!==void 0)Object.assign(f[t],i[t]);else f[t]=i[t]}let o=vn(()=>{let i={},t=w(f);for(let s of Object.keys(t).filter(n))i[s]=t[s];localStorage.setItem("xin-state",JSON.stringify(i)),console.log("xin state saved to localStorage")},500);Z(n,o)};var jn="1.0.6";function be(n){return Object.assign(J,n),J}function cn(n){return console.warn("boxedProxy is deprecated, please use tosi() instead"),be(n)}function Pn(n,e=!1){if(e)return console.warn("xinProxy(..., true) is deprecated; use tosi(...) instead"),cn(n);return Object.keys(n).forEach((o)=>{f[o]=n[o]}),f}var eo={};async function dn(n,e){let{type:o,styleSpec:i}=await e(n,{Color:a,Component:B,elements:m,svgElements:Bn,mathML:Hn,varDefault:sn,vars:On,xin:f,boxed:J,xinProxy:Pn,boxedProxy:cn,makeComponent:dn,bind:g,on:j,version:jn}),t={type:o,creator:o.elementCreator({tag:n,styleSpec:i})};return eo[n]=t,t}var Wn={},oo=(n)=>import(n);class an extends B{tag="anon-elt";src="";property="default";loaded;blueprintLoaded=(n)=>{};async packaged(){let{tag:n,src:e,property:o}=this,i=`${n}.${o}:${e}`;if(!this.loaded){if(Wn[i]===void 0)Wn[i]=oo(e).then((t)=>{let s=t[o];return dn(n,s)});else console.log(`using cached ${n} with signature ${i}`);this.loaded=await Wn[i],this.blueprintLoaded(this.loaded)}return this.loaded}constructor(){super();this.initAttributes("tag","src","property")}}var io=an.elementCreator({tag:"xin-blueprint",styleSpec:{":host":{display:"none"}}});class In extends B{allLoaded=()=>{};constructor(){super()}async load(){let e=Array.from(this.querySelectorAll(an.tagName)).filter((o)=>o.src).map((o)=>o.packaged());await Promise.all(e),this.allLoaded()}connectedCallback(){super.connectedCallback(),this.load()}}var to=In.elementCreator({tag:"xin-loader",styleSpec:{":host":{display:"none"}}});export{w as xinValue,Pn as xinProxy,M as xinPath,f as xin,jn as version,On as vars,sn as varDefault,Zn as updates,G as unobserve,Mn as touchElement,W as touch,be as tosi,en as throttle,Bn as svgElements,H as settings,j as on,Z as observe,Hn as mathML,dn as makeComponent,Qe as invertLuminance,qe as initVars,no as hotReload,mn as getListItem,Dn as getCssVar,m as elements,vn as debounce,U as css,cn as boxedProxy,J as boxed,to as blueprintLoader,io as blueprint,tn as bindings,g as bind,_e as StyleSheet,Pe as MoreMath,B as Component,a as Color,In as BlueprintLoader,an as Blueprint};

//# debugId=F8B9F9886F12440F64756E2164756E21
//# sourceMappingURL=module.js.map
