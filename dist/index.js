(()=>{var{defineProperty:gn,getOwnPropertyNames:Se,getOwnPropertyDescriptor:Me}=Object,De=Object.prototype.hasOwnProperty;var Yn=new WeakMap,Le=(n)=>{var e=Yn.get(n),o;if(e)return e;if(e=gn({},"__esModule",{value:!0}),n&&typeof n==="object"||typeof n==="function")Se(n).map((i)=>!De.call(e,i)&&gn(e,i,{get:()=>n[i],enumerable:!(o=Me(n,i))||o.enumerable}));return Yn.set(n,e),e};var Fe=(n,e)=>{for(var o in e)gn(n,o,{get:e[o],enumerable:!0,configurable:!0,set:(i)=>e[o]=()=>i})};var ao={};Fe(ao,{xinValue:()=>m,xinProxy:()=>yn,xinPath:()=>C,xin:()=>a,version:()=>mn,vars:()=>un,varDefault:()=>_,updates:()=>vn,unobserve:()=>q,touch:()=>H,throttle:()=>dn,svgElements:()=>fn,settings:()=>M,on:()=>L,observe:()=>P,mathML:()=>pn,makeComponent:()=>nn,invertLuminance:()=>we,initVars:()=>be,hotReload:()=>Ee,getListItem:()=>sn,elements:()=>u,debounce:()=>ln,darkMode:()=>ge,css:()=>z,boxedProxy:()=>N,boxed:()=>B,blueprintLoader:()=>Ce,blueprint:()=>ke,bindings:()=>V,bind:()=>h,StyleSheet:()=>xe,MoreMath:()=>fe,Component:()=>S,Color:()=>d,BlueprintLoader:()=>xn,Blueprint:()=>en});var M={debug:!1,perf:!1};function T(n){if(n==null||typeof n!=="object")return n;if(Array.isArray(n))return n.map(T);let e={};for(let o in n){let i=n[o];if(n!=null&&typeof n==="object")e[o]=T(i);else e[o]=i}return e}var wn="-xin-data",D=`.${wn}`,Xn="-xin-event",En=`.${Xn}`,x="xinPath",$="xinValue",qn="xinObserve",Un="xinBind",Jn="xinOn",C=(n)=>{return n&&n[x]};function m(n){return typeof n==="object"&&n!==null?n[$]||n:n}var O=new WeakMap,k=new WeakMap;var A=(n)=>{let e=n.cloneNode();if(e instanceof Element){let o=k.get(n),i=O.get(n);if(o!=null)k.set(e,T(o));if(i!=null)O.set(e,T(i))}for(let o of n instanceof HTMLTemplateElement?n.content.childNodes:n.childNodes)if(o instanceof Element||o instanceof DocumentFragment)e.appendChild(A(o));else e.appendChild(o.cloneNode());return e},G=new WeakMap,sn=(n)=>{let e=document.body.parentElement;while(n.parentElement!=null&&n.parentElement!==e){let o=G.get(n);if(o!=null)return o;n=n.parentElement}return!1};var Pn=Symbol("observer should be removed"),rn=[],cn=[],Tn=!1,kn,Cn;class Gn{description;test;callback;constructor(n,e){let o=typeof e==="string"?`"${e}"`:`function ${e.name}`,i;if(typeof n==="string")this.test=(t)=>typeof t==="string"&&t!==""&&(n.startsWith(t)||t.startsWith(n)),i=`test = "${n}"`;else if(n instanceof RegExp)this.test=n.test.bind(n),i=`test = "${n.toString()}"`;else if(n instanceof Function)this.test=n,i=`test = function ${n.name}`;else throw new Error("expect listener test to be a string, RegExp, or test function");if(this.description=`${i}, ${o}`,typeof e==="function")this.callback=e;else throw new Error("expect callback to be a path or function");rn.push(this)}}var vn=async()=>{if(kn===void 0)return;await kn},Oe=()=>{if(M.perf)console.time("xin async update");let n=Array.from(cn);for(let e of n)rn.filter((o)=>{let i;try{i=o.test(e)}catch(t){throw new Error(`Listener ${o.description} threw "${t}" at "${e}"`)}if(i===Pn)return q(o),!1;return i}).forEach((o)=>{let i;try{i=o.callback(e)}catch(t){console.error(`Listener ${o.description} threw "${t}" handling "${e}"`)}if(i===Pn)q(o)});if(cn.splice(0),Tn=!1,typeof Cn==="function")Cn();if(M.perf)console.timeEnd("xin async update")},H=(n)=>{let e=typeof n==="string"?n:C(n);if(e===void 0)throw console.error("touch was called on an invalid target",n),new Error("touch was called on an invalid target");if(Tn===!1)kn=new Promise((o)=>{Cn=o}),Tn=setTimeout(Oe);if(cn.find((o)=>e.startsWith(o))==null)cn.push(e)},Sn=(n,e)=>{return new Gn(n,e)},q=(n)=>{let e=rn.indexOf(n);if(e>-1)rn.splice(e,1);else throw new Error("unobserve failed, listener not found")};var $e=(n)=>{try{return JSON.stringify(n)}catch(e){return"{has circular references}"}},Mn=(...n)=>new Error(n.map($e).join(" "));var Ae=()=>new Date(parseInt("1000000000",36)+Date.now()).valueOf().toString(36).slice(1),He=0,je=()=>(parseInt("10000",36)+ ++He).toString(36).slice(-5),Be=()=>Ae()+je(),Dn={},Vn={};function Qn(n){if(n==="")return[];if(Array.isArray(n))return n;else{let e=[];while(n.length>0){let o=n.search(/\[[^\]]+\]/);if(o===-1){e.push(n.split("."));break}else{let i=n.slice(0,o);if(n=n.slice(o),i!=="")e.push(i.split("."));if(o=n.indexOf("]")+1,e.push(n.slice(1,o-1)),n.slice(o,o+1)===".")o+=1;n=n.slice(o)}}return e}}var v=new WeakMap;function _n(n,e){if(v.get(n)===void 0)v.set(n,{});if(v.get(n)[e]===void 0)v.get(n)[e]={};let o=v.get(n)[e];if(e==="_auto_")n.forEach((i,t)=>{if(i._auto_===void 0)i._auto_=Be();o[i._auto_+""]=t});else n.forEach((i,t)=>{o[U(i,e)+""]=t});return o}function Ie(n,e){if(v.get(n)===void 0||v.get(n)[e]===void 0)return _n(n,e);else return v.get(n)[e]}function ze(n,e,o){o=o+"";let i=Ie(n,e)[o];if(i===void 0||U(n[i],e)+""!==o)i=_n(n,e)[o];return i}function We(n,e,o){if(n[e]===void 0&&o!==void 0)n[e]=o;return n[e]}function Kn(n,e,o,i){let t=e!==""?ze(n,e,o):o;if(i===Dn)return n.splice(t,1),v.delete(n),Symbol("deleted");else if(i===Vn){if(e===""&&n[t]===void 0)n[t]={}}else if(i!==void 0)if(t!==void 0)n[t]=i;else if(e!==""&&U(i,e)+""===o+"")n.push(i),t=n.length-1;else throw new Error(`byIdPath insert failed at [${e}=${o}]`);return n[t]}function Zn(n){if(!Array.isArray(n))throw Mn("setByPath failed: expected array, found",n)}function Rn(n){if(n==null||!(n instanceof Object))throw Mn("setByPath failed: expected Object, found",n)}function U(n,e){let o=Qn(e),i=n,t,r,s,c;for(t=0,r=o.length;i!==void 0&&t<r;t++){let l=o[t];if(Array.isArray(l))for(s=0,c=l.length;i!==void 0&&s<c;s++){let f=l[s];i=i[f]}else if(i.length===0){if(i=i[l.slice(1)],l[0]!=="=")return}else if(l.includes("=")){let[f,...g]=l.split("=");i=Kn(i,f,g.join("="))}else s=parseInt(l,10),i=i[s]}return i}function Nn(n,e,o){let i=n,t=Qn(e);while(i!=null&&t.length>0){let r=t.shift();if(typeof r==="string"){let s=r.indexOf("=");if(s>-1){if(s===0)Rn(i);else Zn(i);let c=r.slice(0,s),l=r.slice(s+1);if(i=Kn(i,c,l,t.length>0?Vn:o),t.length===0)return!0}else{Zn(i);let c=parseInt(r,10);if(t.length>0)i=i[c];else{if(o!==Dn){if(i[c]===o)return!1;i[c]=o}else i.splice(c,1);return!0}}}else if(Array.isArray(r)&&r.length>0){Rn(i);while(r.length>0){let s=r.shift();if(r.length>0||t.length>0)i=We(i,s,r.length>0?{}:[]);else{if(o!==Dn){if(i[s]===o)return!1;i[s]=o}else{if(!Object.prototype.hasOwnProperty.call(i,s))return!1;delete i[s]}return!0}}}else throw new Error(`setByPath failed, bad path ${e}`)}throw new Error(`setByPath(${n}, ${e}, ${o}) failed`)}var Ye=["sort","splice","copyWithin","fill","pop","push","reverse","shift","unshift"],Fn={},qe=!0,Ue=/^\.?([^.[\](),])+(\.[^.[\](),]+|\[\d+\]|\[[^=[\](),]*=[^[\]()]+\])*$/,Je=(n)=>Ue.test(n),j=(n="",e="")=>{if(n==="")return e;else if(e.match(/^\d+$/)!==null||e.includes("="))return`${n}[${e}]`;else return`${n}.${e}`},Pe={string(n){return new String(n)},boolean(n){return new Boolean(n)},bigint(n){return n},symbol(n){return n},number(n){return new Number(n)}};function Ln(n,e){let o=typeof n;if(n===void 0||o==="object"||o==="function")return n;else return new Proxy(Pe[typeof n](n),J(e,!0))}var J=(n,e)=>({get(o,i){switch(i){case x:return n;case $:return m(o);case qn:return(s)=>{let c=Sn(n,s);return()=>q(c)};case Jn:return(s,c)=>L(s,c,m(o));case Un:return(s,c,l)=>{h(s,n,c,l)}}if(typeof i==="symbol")return o[i];let t=i,r=t.match(/^([^.[]+)\.(.+)$/)??t.match(/^([^\]]+)(\[.+)/)??t.match(/^(\[[^\]]+\])\.(.+)$/)??t.match(/^(\[[^\]]+\])\[(.+)$/);if(r!==null){let[,s,c]=r,l=j(n,s),f=U(o,s);return f!==null&&typeof f==="object"?new Proxy(f,J(l,e))[c]:f}if(t.startsWith("[")&&t.endsWith("]"))t=t.substring(1,t.length-1);if(!Array.isArray(o)&&o[t]!==void 0||Array.isArray(o)&&t.includes("=")){let s;if(t.includes("=")){let[c,l]=t.split("=");s=o.find((f)=>`${U(f,c)}`===l)}else s=o[t];if(s instanceof Object){let c=j(n,t);return new Proxy(s instanceof Function?s.bind(o):s,J(c,e))}else return e?Ln(s,j(n,t)):s}else if(Array.isArray(o)){let s=o[t];return typeof s==="function"?(...c)=>{let l=s.apply(o,c);if(Ye.includes(t))H(n);return l}:typeof s==="object"?new Proxy(s,J(j(n,t),e)):e?Ln(s,j(n,t)):s}else return e?Ln(o[t],j(n,t)):o[t]},set(o,i,t){t=m(t);let r=i!==$?j(n,i):n;if(qe&&!Je(r))throw new Error(`setting invalid path ${r}`);if(m(a[r])!==t&&Nn(Fn,r,t))H(r);return!0}}),P=(n,e)=>{let o=typeof e==="function"?e:a[e];if(typeof o!=="function")throw new Error(`observe expects a function or path to a function, ${e} is neither`);return Sn(n,o)},a=new Proxy(Fn,J("",!1)),B=new Proxy(Fn,J("",!0));var{document:Z,MutationObserver:ne}=globalThis,ie=(n,e)=>{let o=k.get(n);if(o==null)return;for(let i of o){let{binding:t,options:r}=i,{path:s}=i,{toDOM:c}=t;if(c!=null){if(s.startsWith("^")){let l=sn(n);if(l!=null&&l[x]!=null)s=i.path=`${l[x]}${s.substring(1)}`;else throw console.error(`Cannot resolve relative binding ${s}`,n,"is not part of a list"),new Error(`Cannot resolve relative binding ${s}`)}if(e==null||s.startsWith(e))c(n,a[s],r)}}};if(ne!=null)new ne((e)=>{e.forEach((o)=>{Array.from(o.addedNodes).forEach((i)=>{if(i instanceof Element)Array.from(i.querySelectorAll(D)).forEach((t)=>ie(t))})})}).observe(Z.body,{subtree:!0,childList:!0});P(()=>!0,(n)=>{let e=Array.from(Z.querySelectorAll(D));for(let o of e)ie(o,n)});var ee=(n)=>{let e=n.target.closest(D);while(e!=null){let o=k.get(e);for(let i of o){let{binding:t,path:r}=i,{fromDOM:s}=t;if(s!=null){let c;try{c=s(e,i.options)}catch(l){throw console.error("Cannot get value from",e,"via",i),new Error("Cannot obtain value fromDOM")}if(c!=null){let l=a[r];if(l==null)a[r]=c;else{let f=l[x]!=null?l[$]:l,g=c[x]!=null?c[$]:c;if(f!==g)a[r]=g}}}}e=e.parentElement.closest(D)}};if(globalThis.document!=null)Z.body.addEventListener("change",ee,!0),Z.body.addEventListener("input",ee,!0);function h(n,e,o,i){if(n instanceof DocumentFragment)throw new Error("bind cannot bind to a DocumentFragment");let t;if(typeof e==="object"&&e[x]===void 0&&i===void 0){let{value:c}=e;t=typeof c==="string"?c:c[x],i=e,delete i.value}else t=typeof e==="string"?e:e[x];if(t==null)throw new Error("bind requires a path or object with xin Proxy");let{toDOM:r}=o;n.classList?.add(wn);let s=k.get(n);if(s==null)s=[],k.set(n,s);if(s.push({path:t,binding:o,options:i}),r!=null&&!t.startsWith("^"))H(t);return n}var oe=new Set,Ge=(n)=>{let e=n?.target.closest(En),o=!1,i=new Proxy(n,{get(r,s){if(s==="stopPropagation")return()=>{n.stopPropagation(),o=!0};else{let c=r[s];return typeof c==="function"?c.bind(r):c}}}),t=new Set;while(!o&&e!=null){let s=O.get(e)[n.type]||t;for(let c of s){if(typeof c==="function")c(i);else{let l=a[c];if(typeof l==="function")l(i);else throw new Error(`no event handler found at path ${c}`)}if(o)continue}e=e.parentElement!=null?e.parentElement.closest(En):null}};function L(n,e,o){let i=O.get(n);if(n.classList.add(Xn),i==null)i={},O.set(n,i);if(!i[e])i[e]=new Set;if(i[e].add(o),!oe.has(e))oe.add(e),Z.body.addEventListener(e,Ge,!0);return()=>{i[e].delete(o)}}var On=(n,e)=>{let o=new Event(e);n.dispatchEvent(o)},se=(n)=>{if(n instanceof HTMLInputElement)return n.type;else if(n instanceof HTMLSelectElement&&n.hasAttribute("multiple"))return"multi-select";else return"other"},$n=(n,e)=>{switch(se(n)){case"radio":n.checked=n.value===e;break;case"checkbox":n.checked=!!e;break;case"date":n.valueAsDate=new Date(e);break;case"multi-select":for(let o of Array.from(n.querySelectorAll("option")))o.selected=e[o.value];break;default:n.value=e}},re=(n)=>{switch(se(n)){case"radio":{let e=n.parentElement?.querySelector(`[name="${n.name}"]:checked`);return e!=null?e.value:null}case"checkbox":return n.checked;case"date":return n.valueAsDate?.toISOString();case"multi-select":return Array.from(n.querySelectorAll("option")).reduce((e,o)=>{return e[o.value]=o.selected,e},{});default:return n.value}},{ResizeObserver:te}=globalThis,R=te!=null?new te((n)=>{for(let e of n){let o=e.target;On(o,"resize")}}):{observe(){},unobserve(){}},An=(n,e,o=!0)=>{if(n!=null&&e!=null)if(typeof e==="string")n.textContent=e;else if(Array.isArray(e))e.forEach((i)=>{n.append(i instanceof Node&&o?A(i):i)});else if(e instanceof Node)n.append(o?A(e):e);else throw new Error("expect text content or document node")};var ln=(n,e=250)=>{let o;return(...i)=>{if(o!==void 0)clearTimeout(o);o=setTimeout(()=>{n(...i)},e)}},dn=(n,e=250)=>{let o,i=Date.now()-e,t=!1;return(...r)=>{if(clearTimeout(o),o=setTimeout(async()=>{n(...r),i=Date.now()},e),!t&&Date.now()-i>=e){t=!0;try{n(...r),i=Date.now()}finally{t=!1}}}};var ce=Symbol("list-binding"),Ze=16;function le(n,e){let o=Array.from(n.querySelectorAll(D));if(n.matches(D))o.unshift(n);for(let i of o){let t=k.get(i);for(let r of t){if(r.path.startsWith("^"))r.path=`${e}${r.path.substring(1)}`;if(r.binding.toDOM!=null)r.binding.toDOM(i,a[r.path])}}}class de{boundElement;listTop;listBottom;template;options;itemToElement;_array=[];_update;_previousSlice;constructor(n,e={}){if(this.boundElement=n,this.itemToElement=new WeakMap,n.children.length!==1)throw new Error("ListBinding expects an element with exactly one child element");if(n.children[0]instanceof HTMLTemplateElement){let o=n.children[0];if(o.content.children.length!==1)throw new Error("ListBinding expects a template with exactly one child element");this.template=A(o.content.children[0])}else this.template=n.children[0],this.template.remove();if(this.listTop=document.createElement("div"),this.listBottom=document.createElement("div"),this.boundElement.append(this.listTop),this.boundElement.append(this.listBottom),this.options=e,e.virtual!=null)R.observe(this.boundElement),this._update=dn(()=>{this.update(this._array,!0)},Ze),this.boundElement.addEventListener("scroll",this._update),this.boundElement.addEventListener("resize",this._update)}visibleSlice(){let{virtual:n,hiddenProp:e,visibleProp:o}=this.options,i=this._array;if(e!==void 0)i=i.filter((l)=>l[e]!==!0);if(o!==void 0)i=i.filter((l)=>l[o]===!0);let t=0,r=i.length-1,s=0,c=0;if(n!=null&&this.boundElement instanceof HTMLElement){let l=this.boundElement.offsetWidth,f=this.boundElement.offsetHeight,g=n.width!=null?Math.max(1,Math.floor(l/n.width)):1,W=Math.ceil(f/n.height)+1,Y=Math.ceil(i.length/g),on=g*W,F=Math.floor(this.boundElement.scrollTop/n.height);if(F>Y-W+1)F=Math.max(0,Y-W+1);t=F*g,r=t+on-1,s=F*n.height,c=Math.max(Y*n.height-f-s,0)}return{items:i,firstItem:t,lastItem:r,topBuffer:s,bottomBuffer:c}}update(n,e){if(n==null)n=[];this._array=n;let{hiddenProp:o,visibleProp:i}=this.options,t=C(n),r=this.visibleSlice();this.boundElement.classList.toggle("-xin-empty-list",r.items.length===0);let s=this._previousSlice,{firstItem:c,lastItem:l,topBuffer:f,bottomBuffer:g}=r;if(o===void 0&&i===void 0&&e===!0&&s!=null&&c===s.firstItem&&l===s.lastItem)return;this._previousSlice=r;let W=0,Y=0,on=0;for(let p of Array.from(this.boundElement.children)){if(p===this.listTop||p===this.listBottom)continue;let w=G.get(p);if(w==null)p.remove();else{let y=r.items.indexOf(w);if(y<c||y>l)p.remove(),this.itemToElement.delete(w),G.delete(p),W++}}this.listTop.style.height=String(f)+"px",this.listBottom.style.height=String(g)+"px";let F=[],{idPath:hn}=this.options;for(let p=c;p<=l;p++){let w=r.items[p];if(w===void 0)continue;let y=this.itemToElement.get(m(w));if(y==null){if(on++,y=A(this.template),typeof w==="object")this.itemToElement.set(m(w),y),G.set(y,m(w));if(this.boundElement.insertBefore(y,this.listBottom),hn!=null){let bn=w[hn],ve=`${t}[${hn}=${bn}]`;le(y,ve)}else{let bn=`${t}[${p}]`;le(y,bn)}}F.push(y)}let tn=null;for(let p of F){if(p.previousElementSibling!==tn)if(Y++,tn?.nextElementSibling!=null)this.boundElement.insertBefore(p,tn.nextElementSibling);else this.boundElement.insertBefore(p,this.listBottom);tn=p}if(M.perf)console.log(t,"updated",{removed:W,created:on,moved:Y})}}var ae=(n,e)=>{let o=n[ce];if(o===void 0)o=new de(n,e),n[ce]=o;return o};var V={value:{toDOM:$n,fromDOM(n){return re(n)}},set:{toDOM:$n},text:{toDOM(n,e){n.textContent=e}},enabled:{toDOM(n,e){n.disabled=!e}},disabled:{toDOM(n,e){n.disabled=Boolean(e)}},style:{toDOM(n,e){}},callback:{toDOM(n,e,o){if(o?.callback)o.callback(n,e);else if(e instanceof Function)e(n)}},list:{toDOM(n,e,o){ae(n,o).update(e)}}};var Re=180/Math.PI,Ve=Math.PI/180;function b(n,e,o){return e<n?n:e>o?o:e}function X(n,e,o){return o=b(0,o,1),o*(e-n)+n}var fe={RADIANS_TO_DEGREES:Re,DEGREES_TO_RADIANS:Ve,clamp:b,lerp:X};var Qe=(n,e,o)=>{return(0.299*n+0.587*e+0.114*o)/255},I=(n)=>("00"+Math.round(Number(n)).toString(16)).slice(-2);class pe{h;s;l;constructor(n,e,o){n/=255,e/=255,o/=255;let i=Math.max(n,e,o),t=i-Math.min(n,e,o),r=t!==0?i===n?(e-o)/t:i===e?2+(o-n)/t:4+(n-e)/t:0;this.h=60*r<0?60*r+360:60*r,this.s=t!==0?i<=0.5?t/(2*i-t):t/(2-(2*i-t)):0,this.l=(2*i-t)/2}}var Q=globalThis.document!==void 0?globalThis.document.createElement("span"):void 0;class d{r;g;b;a;static fromCss(n){let e=n;if(Q instanceof HTMLSpanElement)Q.style.color=n,document.body.appendChild(Q),e=getComputedStyle(Q).color,Q.remove();let[o,i,t,r]=e.match(/[\d.]+/g);return new d(Number(o),Number(i),Number(t),r==null?1:Number(r))}static fromHsl(n,e,o,i=1){return d.fromCss(`hsla(${n.toFixed(0)}, ${(e*100).toFixed(0)}%, ${(o*100).toFixed(0)}%, ${i.toFixed(2)})`)}constructor(n,e,o,i=1){this.r=b(0,n,255),this.g=b(0,e,255),this.b=b(0,o,255),this.a=i!==void 0?b(0,i,1):i=1}get inverse(){return new d(255-this.r,255-this.g,255-this.b,this.a)}get inverseLuminance(){let{h:n,s:e,l:o}=this._hsl;return d.fromHsl(n,e,1-o,this.a)}get rgb(){let{r:n,g:e,b:o}=this;return`rgb(${n.toFixed(0)},${e.toFixed(0)},${o.toFixed(0)})`}get rgba(){let{r:n,g:e,b:o,a:i}=this;return`rgba(${n.toFixed(0)},${e.toFixed(0)},${o.toFixed(0)},${i.toFixed(2)})`}get RGBA(){return[this.r/255,this.g/255,this.b/255,this.a]}get ARGB(){return[this.a,this.r/255,this.g/255,this.b/255]}hslCached;get _hsl(){if(this.hslCached==null)this.hslCached=new pe(this.r,this.g,this.b);return this.hslCached}get hsl(){let{h:n,s:e,l:o}=this._hsl;return`hsl(${n.toFixed(0)}, ${(e*100).toFixed(0)}%, ${(o*100).toFixed(0)}%)`}get hsla(){let{h:n,s:e,l:o}=this._hsl;return`hsla(${n.toFixed(0)}, ${(e*100).toFixed(0)}%, ${(o*100).toFixed(0)}%, ${this.a.toFixed(2)})`}get mono(){let n=this.brightness*255;return new d(n,n,n)}get brightness(){return Qe(this.r,this.g,this.b)}get html(){return this.toString()}toString(){return this.a===1?"#"+I(this.r)+I(this.g)+I(this.b):"#"+I(this.r)+I(this.g)+I(this.b)+I(Math.floor(255*this.a))}brighten(n){let{h:e,s:o,l:i}=this._hsl,t=b(0,i+n*(1-i),1);return d.fromHsl(e,o,t,this.a)}darken(n){let{h:e,s:o,l:i}=this._hsl,t=b(0,i*(1-n),1);return d.fromHsl(e,o,t,this.a)}saturate(n){let{h:e,s:o,l:i}=this._hsl,t=b(0,o+n*(1-o),1);return d.fromHsl(e,t,i,this.a)}desaturate(n){let{h:e,s:o,l:i}=this._hsl,t=b(0,o*(1-n),1);return d.fromHsl(e,t,i,this.a)}rotate(n){let{h:e,s:o,l:i}=this._hsl,t=(e+360+n)%360;return d.fromHsl(t,o,i,this.a)}opacity(n){let{h:e,s:o,l:i}=this._hsl;return d.fromHsl(e,o,i,n)}swatch(){let{r:n,g:e,b:o,a:i}=this;return console.log(`%c      %c ${this.html}, rgba(${n}, ${e}, ${o}, ${i}), ${this.hsla}`,`background-color: rgba(${n}, ${e}, ${o}, ${i})`,"background-color: transparent"),this}blend(n,e){return new d(X(this.r,n.r,e),X(this.g,n.g,e),X(this.b,n.b,e),X(this.a,n.a,e))}mix(n,e){let o=this._hsl,i=n._hsl;return d.fromHsl(X(o.h,i.h,e),X(o.s,i.s,e),X(o.l,i.l,e),X(this.a,n.a,e))}}function E(n){return n.replace(/[A-Z]/g,(e)=>{return`-${e.toLocaleLowerCase()}`})}function ue(n){return n.replace(/-([a-z])/g,(e,o)=>{return o.toLocaleUpperCase()})}var _e="http://www.w3.org/1998/Math/MathML",Ke="http://www.w3.org/2000/svg",an={},me=(n,e,o)=>{let i=Bn(E(e),o);if(i.prop.startsWith("--"))n.style.setProperty(i.prop,i.value);else n.style[e]=i.value},Ne=(n)=>{return{toDOM(e,o){me(e,n,o)}}},ye=(n,e,o)=>{if(e==="style")if(typeof o==="object")for(let i of Object.keys(o))if(C(o[i]))console.log(i,o[i]),h(n,o[i],Ne(i));else me(n,i,o[i]);else n.setAttribute("style",o);else if(n[e]!==void 0){let{MathMLElement:i}=globalThis;if(n instanceof SVGElement||i!==void 0&&n instanceof i)n.setAttribute(e,o);else n[e]=o}else{let i=E(e);if(i==="class")o.split(" ").forEach((t)=>{n.classList.add(t)});else if(n[i]!==void 0)n[i]=o;else if(typeof o==="boolean")o?n.setAttribute(i,""):n.removeAttribute(i);else n.setAttribute(i,o)}},no=(n)=>{return{toDOM(e,o){ye(e,n,o)}}},eo=(n,e,o)=>{if(e==="apply")o(n);else if(e.match(/^on[A-Z]/)!=null){let i=e.substring(2).toLowerCase();L(n,i,o)}else if(e==="bind")if((typeof o.binding==="string"?V[o.binding]:o.binding)!==void 0&&o.value!==void 0)h(n,o.value,o.binding instanceof Function?{toDOM:o.binding}:o.binding);else throw new Error("bad binding");else if(e.match(/^bind[A-Z]/)!=null){let i=e.substring(4,5).toLowerCase()+e.substring(5),t=V[i];if(t!==void 0)h(n,o,t);else throw new Error(`${e} is not allowed, bindings.${i} is not defined`)}else if(C(o))h(n,o,no(e));else ye(n,e,o)},Hn=(n,...e)=>{if(an[n]===void 0){let[t,r]=n.split("|");if(r===void 0)an[n]=globalThis.document.createElement(t);else an[n]=globalThis.document.createElementNS(r,t)}let o=an[n].cloneNode(),i={};for(let t of e)if(t instanceof Element||t instanceof DocumentFragment||typeof t==="string"||typeof t==="number")if(o instanceof HTMLTemplateElement)o.content.append(t);else o.append(t);else if(t.xinPath)o.append(u.span({bindText:t}));else Object.assign(i,t);for(let t of Object.keys(i)){let r=i[t];eo(o,t,r)}return o},jn=(...n)=>{let e=globalThis.document.createDocumentFragment();for(let o of n)e.append(o);return e},u=new Proxy({fragment:jn},{get(n,e){if(e=e.replace(/[A-Z]/g,(o)=>`-${o.toLocaleLowerCase()}`),n[e]===void 0)n[e]=(...o)=>Hn(e,...o);return n[e]},set(){throw new Error("You may not add new properties to elements")}}),fn=new Proxy({fragment:jn},{get(n,e){if(n[e]===void 0)n[e]=(...o)=>Hn(`${e}|${Ke}`,...o);return n[e]},set(){throw new Error("You may not add new properties to elements")}}),pn=new Proxy({fragment:jn},{get(n,e){if(n[e]===void 0)n[e]=(...o)=>Hn(`${e}|${_e}`,...o);return n[e]},set(){throw new Error("You may not add new properties to elements")}});function xe(n,e){let o=u.style(z(e));o.id=n,document.head.append(o)}var oo=["animation-iteration-count","flex","flex-base","flex-grow","flex-shrink","opacity","order","tab-size","widows","z-index","zoom"],Bn=(n,e)=>{if(typeof e==="number"&&!oo.includes(n))e=`${e}px`;if(n.startsWith("_"))if(n.startsWith("__"))n="--"+n.substring(2),e=`var(${n}-default, ${e})`;else n="--"+n.substring(1);return{prop:n,value:String(e)}},io=(n,e,o)=>{if(o===void 0)return"";if(o instanceof d)o=o.html;let i=Bn(e,o);return`${n}  ${i.prop}: ${i.value};`},he=(n,e,o="")=>{let i=E(n);if(typeof e==="object"&&!(e instanceof d)){let t=Object.keys(e).map((r)=>he(r,e[r],`${o}  `)).join(`
`);return`${o}  ${n} {
${t}
${o}  }`}else return io(o,i,e)},z=(n,e="")=>{return Object.keys(n).map((i)=>{let t=n[i];if(typeof t==="string"){if(i==="@import")return`@import url('${t}');`;throw new Error("top-level string value only allowed for `@import`")}let r=Object.keys(t).map((s)=>he(s,t[s])).join(`
`);return`${e}${i} {
${r}
}`}).join(`

`)},be=(n)=>{console.warn("initVars is deprecated. Just use _ and __ prefixes instead.");let e={};for(let o of Object.keys(n)){let i=n[o],t=E(o);e[`--${t}`]=typeof i==="number"&&i!==0?String(i)+"px":i}return e},ge=(n)=>{console.warn("darkMode is deprecated. Use inverseLuminance instead.");let e={};for(let o of Object.keys(n)){let i=n[o];if(typeof i==="string"&&i.match(/^(#|rgb[a]?\(|hsl[a]?\()/)!=null)i=d.fromCss(i).inverseLuminance.html,e[`--${E(o)}`]=i}return e},we=(n)=>{let e={};for(let o of Object.keys(n)){let i=n[o];if(i instanceof d)e[o]=i.inverseLuminance;else if(typeof i==="string"&&i.match(/^(#[0-9a-fA-F]{3}|rgba?\(|hsla?\()/))e[o]=d.fromCss(i).inverseLuminance}return e},_=new Proxy({},{get(n,e){if(n[e]===void 0){let o=`--${e.replace(/[A-Z]/g,(i)=>`-${i.toLocaleLowerCase()}`)}`;n[e]=(i)=>`var(${o}, ${i})`}return n[e]}}),un=new Proxy({},{get(n,e){if(e==="default")return _;if(n[e]==null){e=e.replace(/[A-Z]/g,(c)=>`-${c.toLocaleLowerCase()}`);let[,o,,i,t,r]=e.match(/^([^\d_]*)((_)?(\d+)(\w*))?$/),s=`--${o}`;if(t!=null){let c=i==null?Number(t)/100:-Number(t)/100;switch(r){case"b":{let l=getComputedStyle(document.body).getPropertyValue(s);n[e]=c>0?d.fromCss(l).brighten(c).rgba:d.fromCss(l).darken(-c).rgba}break;case"s":{let l=getComputedStyle(document.body).getPropertyValue(s);n[e]=c>0?d.fromCss(l).saturate(c).rgba:d.fromCss(l).desaturate(-c).rgba}break;case"h":{let l=getComputedStyle(document.body).getPropertyValue(s);n[e]=d.fromCss(l).rotate(c*100).rgba,console.log(d.fromCss(l).hsla,d.fromCss(l).rotate(c).hsla)}break;case"o":{let l=getComputedStyle(document.body).getPropertyValue(s);n[e]=d.fromCss(l).opacity(c).rgba}break;case"":n[e]=`calc(var(${s}) * ${c})`;break;default:throw console.error(r),new Error(`Unrecognized method ${r} for css variable ${s}`)}}else n[e]=`var(${s})`}return n[e]}});var to=0;function In(){return`custom-elt${(to++).toString(36)}`}var Xe=0,K={};function so(n,e){let o=K[n],i=z(e).replace(/:host\b/g,n);K[n]=o?o+`
`+i:i}function ro(n){if(K[n])document.head.append(u.style({id:n+"-component"},K[n]));delete K[n]}class S extends HTMLElement{static elements=u;static _elementCreator;instanceId;styleNode;static styleSpec;static styleNode;content=u.slot();isSlotted;static _tagName=null;static get tagName(){return this._tagName}static StyleNode(n){return console.warn("StyleNode is deprecated, just assign static styleSpec: XinStyleSheet to the class directly"),u.style(z(n))}static elementCreator(n={}){if(this._elementCreator==null){let{tag:e,styleSpec:o}=n,i=n!=null?e:null;if(i==null)if(typeof this.name==="string"&&this.name!==""){if(i=E(this.name),i.startsWith("-"))i=i.slice(1)}else i=In();if(customElements.get(i)!=null)console.warn(`${i} is already defined`);if(i.match(/\w+(-\w+)+/)==null)console.warn(`${i} is not a legal tag for a custom-element`),i=In();while(customElements.get(i)!==void 0)i=In();if(this._tagName=i,o!==void 0)so(i,o);window.customElements.define(i,this,n),this._elementCreator=u[i]}return this._elementCreator}initAttributes(...n){let e={},o={};new MutationObserver((t)=>{let r=!1;if(t.forEach((s)=>{r=!!(s.attributeName&&n.includes(ue(s.attributeName)))}),r&&this.queueRender!==void 0)this.queueRender(!1)}).observe(this,{attributes:!0}),n.forEach((t)=>{e[t]=T(this[t]);let r=E(t);Object.defineProperty(this,t,{enumerable:!1,get(){if(typeof e[t]==="boolean")return this.hasAttribute(r);else if(this.hasAttribute(r))return typeof e[t]==="number"?parseFloat(this.getAttribute(r)):this.getAttribute(r);else if(o[t]!==void 0)return o[t];else return e[t]},set(s){if(typeof e[t]==="boolean"){if(s!==this[t]){if(s)this.setAttribute(r,"");else this.removeAttribute(r);this.queueRender()}}else if(typeof e[t]==="number"){if(s!==parseFloat(this[t]))this.setAttribute(r,s),this.queueRender()}else if(typeof s==="object"||`${s}`!==`${this[t]}`){if(s===null||s===void 0||typeof s==="object")this.removeAttribute(r);else this.setAttribute(r,s);this.queueRender(),o[t]=s}}})})}initValue(){let n=Object.getOwnPropertyDescriptor(this,"value");if(n===void 0||n.get!==void 0||n.set!==void 0)return;let e=this.hasAttribute("value")?this.getAttribute("value"):T(this.value);delete this.value,Object.defineProperty(this,"value",{enumerable:!1,get(){return e},set(o){if(e!==o)e=o,this.queueRender(!0)}})}_parts;get parts(){let n=this.shadowRoot!=null?this.shadowRoot:this;if(this._parts==null)this._parts=new Proxy({},{get(e,o){if(e[o]===void 0){let i=n.querySelector(`[part="${o}"]`);if(i==null)i=n.querySelector(o);if(i==null)throw new Error(`elementRef "${o}" does not exist!`);i.removeAttribute("data-ref"),e[o]=i}return e[o]}});return this._parts}constructor(){super();Xe+=1,this.initAttributes("hidden"),this.instanceId=`${this.tagName.toLocaleLowerCase()}-${Xe}`,this._value=T(this.defaultValue)}connectedCallback(){if(ro(this.constructor.tagName),this.hydrate(),this.role!=null)this.setAttribute("role",this.role);if(this.onResize!==void 0){if(R.observe(this),this._onResize==null)this._onResize=this.onResize.bind(this);this.addEventListener("resize",this._onResize)}if(this.value!=null&&this.getAttribute("value")!=null)this._value=this.getAttribute("value");this.queueRender()}disconnectedCallback(){R.unobserve(this)}_changeQueued=!1;_renderQueued=!1;queueRender(n=!1){if(!this._hydrated)return;if(!this._changeQueued)this._changeQueued=n;if(!this._renderQueued)this._renderQueued=!0,requestAnimationFrame(()=>{if(this._changeQueued)On(this,"change");this._changeQueued=!1,this._renderQueued=!1,this.render()})}_hydrated=!1;hydrate(){if(!this._hydrated){this.initValue();let n=typeof this.content!=="function",e=typeof this.content==="function"?this.content():this.content,{styleSpec:o}=this.constructor,{styleNode:i}=this.constructor;if(o)i=this.constructor.styleNode=u.style(z(o)),delete this.constructor.styleNode;if(this.styleNode)console.warn(this,"styleNode is deprecrated, use static styleNode or statc styleSpec instead"),i=this.styleNode;if(i){let t=this.attachShadow({mode:"open"});t.appendChild(i.cloneNode(!0)),An(t,e,n)}else if(e!==null){let t=Array.from(this.childNodes);An(this,e,n),this.isSlotted=this.querySelector("slot,xin-slot")!==void 0;let r=Array.from(this.querySelectorAll("slot"));if(r.length>0)r.forEach(zn.replaceSlot);if(t.length>0){let s={"":this};Array.from(this.querySelectorAll("xin-slot")).forEach((c)=>{s[c.name]=c}),t.forEach((c)=>{let l=s[""],f=c instanceof Element?s[c.slot]:l;(f!==void 0?f:l).append(c)})}}this._hydrated=!0}}render(){}}class zn extends S{name="";content=null;static replaceSlot(n){let e=document.createElement("xin-slot");if(n.name!=="")e.setAttribute("name",n.name);n.replaceWith(e)}constructor(){super();this.initAttributes("name")}}var ui=zn.elementCreator({tag:"xin-slot"});var Ee=(n=()=>!0)=>{let e=localStorage.getItem("xin-state");if(e!=null){let i=JSON.parse(e);for(let t of Object.keys(i).filter(n))if(a[t]!==void 0)Object.assign(a[t],i[t]);else a[t]=i[t]}let o=ln(()=>{let i={},t=m(a);for(let r of Object.keys(t).filter(n))i[r]=t[r];localStorage.setItem("xin-state",JSON.stringify(i)),console.log("xin state saved to localStorage")},500);P(n,o)};var mn="0.9.1";function N(n){return Object.assign(B,n),B}var Te=!1;function yn(n,e=!1){if(e){if(!Te)console.warn("xinProxy(..., true) is deprecated; use boxedProxy(...) instead"),Te=!0;return N(n)}return Object.keys(n).forEach((o)=>{a[o]=n[o]}),a}var co={};async function nn(n,e){let{type:o,styleSpec:i}=await e(n,{Color:d,Component:S,elements:u,svgElements:fn,mathML:pn,varDefault:_,vars:un,xin:a,boxed:B,xinProxy:yn,boxedProxy:N,makeComponent:nn,bind:h,on:L,version:mn}),t={type:o,creator:o.elementCreator({tag:n,styleSpec:i})};return co[n]=t,t}var Wn={},lo=(n)=>import(n);class en extends S{tag="anon-elt";src="";property="default";loaded;blueprintLoaded=(n)=>{};async packaged(){let{tag:n,src:e,property:o}=this,i=`${n}.${o}:${e}`;if(!this.loaded){if(Wn[i]===void 0)Wn[i]=lo(e).then((t)=>{let r=t[o];return nn(n,r)});else console.log(`using cached ${n}`);this.loaded=await Wn[i],this.blueprintLoaded(this.loaded)}return this.loaded}constructor(){super();this.initAttributes("tag","src","property")}}var ke=en.elementCreator({tag:"xin-blueprint",styleSpec:{":host":{display:"none"}}});class xn extends S{allLoaded=()=>{};constructor(){super()}async load(){let e=Array.from(this.querySelectorAll(en.tagName)).filter((o)=>o.src).map((o)=>o.packaged());await Promise.all(e),this.allLoaded()}connectedCallback(){super.connectedCallback(),this.load()}}var Ce=xn.elementCreator({tag:"xin-loader",styleSpec:{":host":{display:"none"}}});})();

//# debugId=283FC464F6F7264064756E2164756E21
//# sourceMappingURL=index.js.map
