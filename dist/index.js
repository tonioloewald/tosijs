(()=>{var{defineProperty:Fe,getOwnPropertyNames:Bo,getOwnPropertyDescriptor:_o}=Object,No=Object.prototype.hasOwnProperty;var io=new WeakMap,en=(e)=>{var o=io.get(e),n;if(o)return o;if(o=Fe({},"__esModule",{value:!0}),e&&typeof e==="object"||typeof e==="function")Bo(e).map((r)=>!No.call(o,r)&&Fe(o,r,{get:()=>e[r],enumerable:!(n=_o(e,r))||n.enumerable}));return io.set(e,o),o};var on=(e,o)=>{for(var n in o)Fe(e,n,{get:o[n],enumerable:!0,configurable:!0,set:(r)=>o[n]=()=>r})};var Dn={};on(Dn,{xinValue:()=>fo,xinProxy:()=>$e,xinPath:()=>mo,xin:()=>a,warnDeprecated:()=>q,version:()=>Xe,vars:()=>be,varDefault:()=>se,updates:()=>Oe,unobserve:()=>z,touchElement:()=>ge,touch:()=>G,tosiValue:()=>w,tosiSetValue:()=>co,tosiPath:()=>b,tosi:()=>fe,throttle:()=>re,svgElements:()=>Me,settings:()=>W,on:()=>K,observe:()=>ke,mathML:()=>Te,makeComponent:()=>ue,invertLuminance:()=>Do,initVars:()=>zo,hotReload:()=>Ro,getListItem:()=>He,getListInstance:()=>Se,getListBinding:()=>ie,getCssVar:()=>Ee,elements:()=>d,deprecated:()=>ye,deleteListItem:()=>Zo,debounce:()=>Ce,css:()=>U,boxedProxy:()=>le,boxed:()=>I,blueprintLoader:()=>Io,blueprint:()=>Vo,bindings:()=>te,bind:()=>L,StyleSheet:()=>Xo,MoreMath:()=>Ho,Component:()=>Y,Color:()=>l,BlueprintLoader:()=>ze,Blueprint:()=>de});function g(e){if(e==null||typeof e!=="object")return e;if(e instanceof Set)return new Set(e);else if(Array.isArray(e))return e.map(g);let o={};for(let n in e){let r=e[n];if(e!=null&&typeof e==="object")o[n]=g(r);else o[n]=r}return o}var Ye="-xin-data",J=`.${Ye}`,Je="-xin-event",We=`.${Je}`,E=Symbol.for("xin-path"),$=Symbol.for("xin-value"),je="xinObserve",Ae="xinBind",qe="xinOn",_=Symbol("list-binding"),ae=Symbol("list-instance"),so=new Set;function q(e,o){if(!so.has(e))console.warn(o),so.add(e)}function ye(e,o){let n=!1;return(...r)=>{if(!n)console.warn(o),n=!0;return e(...r)}}var b=(e)=>{return e&&e[E]||void 0};function w(e){if(typeof e==="object"&&e!==null){let o=e[$];return o!==void 0?o:e}return e}function co(e,o){if(b(e)===void 0)throw Error("tosiSetValue requires a xin or boxed proxy");e[$]=o}var mo=ye(b,"xinPath is deprecated. Use tosiPath instead."),fo=ye(w,"xinValue is deprecated. Use tosiValue instead."),A=new WeakMap,X=new WeakMap;var Q=(e)=>{let o=e.cloneNode();if(o instanceof Element){let n=X.get(e),r=A.get(e);if(n!=null)X.set(o,g(n));if(r!=null)A.set(o,g(r))}for(let n of Array.from(e instanceof HTMLTemplateElement?e.content.childNodes:e.childNodes))if(n instanceof Element||n instanceof DocumentFragment)o.appendChild(Q(n));else o.appendChild(n.cloneNode());return o};var W={debug:!1,perf:!1};var lo=Symbol("observer should be removed"),he=[],we=[],Qe=!1,Ge,Ze;class uo{description;test;callback;constructor(e,o){let n=typeof o==="string"?`"${o}"`:`function ${o.name}`,r;if(typeof e==="string")this.test=(t)=>typeof t==="string"&&t!==""&&(e.startsWith(t)||t.startsWith(e)),r=`test = "${e}"`;else if(e instanceof RegExp)this.test=e.test.bind(e),r=`test = "${e.toString()}"`;else if(e instanceof Function)this.test=e,r=`test = function ${e.name}`;else throw Error("expect listener test to be a string, RegExp, or test function");if(this.description=`${r}, ${n}`,typeof o==="function")this.callback=o;else throw Error("expect callback to be a path or function");he.push(this)}}var Oe=async()=>{if(Ge===void 0)return;await Ge},nn=()=>{if(W.perf)console.time("xin async update");let e=Array.from(we);for(let o of e)he.filter((n)=>{let r;try{r=n.test(o)}catch(t){throw Error(`Listener ${n.description} threw "${t}" at "${o}"`)}if(r===lo)return z(n),!1;return r}).forEach((n)=>{let r;try{r=n.callback(o)}catch(t){console.error(`Listener ${n.description} threw "${t}" handling "${o}"`)}if(r===lo)z(n)});if(we.splice(0),Qe=!1,typeof Ze==="function")Ze();if(W.perf)console.timeEnd("xin async update")},G=(e)=>{let o=typeof e==="string"?e:b(e);if(o===void 0)throw console.error("touch was called on an invalid target",e),Error("touch was called on an invalid target");if(Qe===!1)Ge=new Promise((n)=>{Ze=n}),Qe=setTimeout(nn);if(we.find((n)=>o.startsWith(n))==null)we.push(o)},j=(e,o)=>{return new uo(e,o)},z=(e)=>{let o=he.indexOf(e);if(o>-1)he.splice(o,1);else throw Error("unobserve failed, listener not found")};var N={},Ue=null,ao=(e)=>{Ue=e},pe=()=>{if(Ue===null)throw Error("xin proxy not initialized");return Ue},Ke=null,ve=null,yo=(e,o)=>{Ke=e,ve=o},ee=()=>{if(Ke===null)throw Error("bind not initialized");return Ke},oe=()=>{if(ve===null)throw Error("on not initialized");return ve};var Re=(e,o)=>{let n=new Event(o);e.dispatchEvent(n)},wo=(e)=>{if(e instanceof HTMLInputElement)return e.type;else if(e instanceof HTMLSelectElement&&e.hasAttribute("multiple"))return"multi-select";else return"other"},po=(e,o)=>{switch(wo(e)){case"radio":e.checked=e.value===o;break;case"checkbox":e.checked=!!o;break;case"date":e.valueAsDate=new Date(o);break;case"multi-select":for(let n of Array.from(e.querySelectorAll("option")))n.selected=o[n.value];break;default:e.value=o}},Co=(e)=>{switch(wo(e)){case"radio":{let o=e.parentElement?.querySelector(`[name="${e.name}"]:checked`);return o!=null?o.value:null}case"checkbox":return e.checked;case"date":return e.valueAsDate?.toISOString();case"multi-select":return Array.from(e.querySelectorAll("option")).reduce((o,n)=>{return o[n.value]=n.selected,o},{});default:return e.value}},{ResizeObserver:ho}=globalThis,ne=ho!=null?new ho((e)=>{for(let o of e){let n=o.target;Re(n,"resize")}}):{observe(){},unobserve(){}},Ve=(e,o,n=!0)=>{if(e!=null&&o!=null)if(typeof o==="string")e.textContent=o;else if(Array.isArray(o))o.forEach((r)=>{e.append(r instanceof Node&&n?Q(r):r)});else if(o instanceof Node)e.append(n?Q(o):o);else throw Error("expect text content or document node")};var Ce=(e,o=250)=>{let n;return(...r)=>{if(n!==void 0)clearTimeout(n);n=setTimeout(()=>{e(...r)},o)}},re=(e,o=250)=>{let n,r=Date.now()-o,t=!1;return(...i)=>{if(clearTimeout(n),n=setTimeout(()=>{e(...i),r=Date.now()},o),!t&&Date.now()-r>=o){t=!0;try{e(...i),r=Date.now()}finally{t=!1}}}};var rn=(e)=>{try{return JSON.stringify(e)}catch(o){return"{has circular references}"}},Ie=(...e)=>Error(e.map(rn).join(" "));var tn=()=>new Date(parseInt("1000000000",36)+Date.now()).valueOf().toString(36).slice(1),sn=0,cn=()=>(parseInt("10000",36)+ ++sn).toString(36).slice(-5),mn=()=>tn()+cn(),Be=Symbol("delete"),xo=Symbol("new-object"),Pe=Symbol("automatic-index");function Mo(e){if(e==="")return[];if(Array.isArray(e))return e;else{let o=[];while(e.length>0){let n=e.search(/\[[^\]]+\]/);if(n===-1){o.push(e.split("."));break}else{let r=e.slice(0,n);if(e=e.slice(n),r!=="")o.push(r.split("."));if(n=e.indexOf("]")+1,o.push(e.slice(1,n-1)),e.slice(n,n+1)===".")n+=1;e=e.slice(n)}}return o}}var D=new WeakMap;function To(e,o){if(D.get(e)===void 0)D.set(e,{});if(D.get(e)[o]===void 0)D.get(e)[o]={};let n=D.get(e)[o];if(o==="_auto_")e.forEach((r,t)=>{if(r[Pe]===void 0)r[Pe]=mn();n[r[Pe]+""]=t});else e.forEach((r,t)=>{n[Z(r,o)+""]=t});return n}function fn(e,o){if(D.get(e)===void 0||D.get(e)[o]===void 0)return To(e,o);else return D.get(e)[o]}function ln(e,o,n){n=n+"";let r=fn(e,o)[n];if(r===void 0||Z(e[r],o)+""!==n)r=To(e,o)[n];return r}function un(e,o,n){if(e[o]===void 0&&n!==void 0)e[o]=n;return e[o]}function Lo(e,o,n,r){let t=o!==""?ln(e,o,n):n;if(r===Be)return e.splice(t,1),D.delete(e),Symbol("deleted");else if(r===xo){if(o===""&&e[t]===void 0)e[t]={}}else if(r!==void 0)if(t!==void 0)e[t]=r;else if(o!==""&&Z(r,o)+""===n+"")e.push(r),t=e.length-1;else throw Error(`byIdPath insert failed at [${o}=${n}]`);return e[t]}function Eo(e){if(!Array.isArray(e))throw Ie("setByPath failed: expected array, found",e)}function bo(e){if(e==null||!(e instanceof Object))throw Ie("setByPath failed: expected Object, found",e)}function Z(e,o){let n=Mo(o),r=e,t,i,m,s;for(t=0,i=n.length;r!==void 0&&t<i;t++){let c=n[t];if(Array.isArray(c))for(m=0,s=c.length;r!==void 0&&m<s;m++){let f=c[m];r=r[f]}else if(r.length===0){if(r=r[Number(c.slice(1))],c[0]!=="=")return}else if(c.includes("=")){let[f,...u]=c.split("=");r=Lo(r,f,u.join("="))}else m=parseInt(c,10),r=r[m]}return r}function ko(e,o,n){let r=e;if(o==="")throw Error("setByPath cannot be used to set the root object");let t=Mo(o);while(r!=null&&t.length>0){let i=t.shift();if(typeof i==="string"){let m=i.indexOf("=");if(m>-1){if(m===0)bo(r);else Eo(r);let s=i.slice(0,m),c=i.slice(m+1);if(r=Lo(r,s,c,t.length>0?xo:n),t.length===0)return!0}else{Eo(r);let s=parseInt(i,10);if(t.length>0)r=r[s];else{if(n!==Be){if(r[s]===n)return!1;r[s]=n}else r.splice(s,1);return!0}}}else if(Array.isArray(i)&&i.length>0){bo(r);while(i.length>0){let m=i.shift();if(i.length>0||t.length>0)r=un(r,m,i.length>0?{}:[]);else{if(n!==Be){if(r[m]===n)return!1;r[m]=n}else{if(!Object.prototype.hasOwnProperty.call(r,m))return!1;delete r[m]}return!0}}}else throw Error(`setByPath failed, bad path ${o}`)}throw Error(`setByPath(${e}, ${o}, ${n}) failed`)}var te={value:{toDOM:po,fromDOM(e){return Co(e)}},text:{toDOM(e,o){e.textContent=o}},enabled:{toDOM(e,o){e.disabled=!o}},disabled:{toDOM(e,o){e.disabled=Boolean(o)}},list:{toDOM(e,o,n){ie(e,o,n).update(o)}}};function M(e){return e.replace(/[A-Z]/g,(o)=>{return`-${o.toLocaleLowerCase()}`})}function So(e){return e.replace(/-([a-z])/g,(o,n)=>{return n.toLocaleUpperCase()})}var dn=180/Math.PI,an=Math.PI/180;function T(e,o,n){return n<e?NaN:o<e?e:o>n?n:o}function F(e,o,n,r=!0){if(r)n=T(0,n,1);return n*(o-e)+e}var Ho={RADIANS_TO_DEGREES:dn,DEGREES_TO_RADIANS:an,clamp:T,lerp:F};function Ee(e,o=document.body){let n=getComputedStyle(o);if(e.endsWith(")")&&e.startsWith("var("))e=e.slice(4,-1);return n.getPropertyValue(e).trim()}var yn=(e,o,n)=>{return(0.299*e+0.587*o+0.114*n)/255},O=(e)=>("00"+Math.round(Number(e)).toString(16)).slice(-2);class go{h;s;l;constructor(e,o,n){e/=255,o/=255,n/=255;let r=Math.max(e,o,n),t=r-Math.min(e,o,n),i=t!==0?r===e?(o-n)/t:r===o?2+(n-e)/t:4+(e-o)/t:0;this.h=60*i<0?60*i+360:60*i,this.s=t!==0?r<=0.5?t/(2*r-t):t/(2-(2*r-t)):0,this.l=(2*r-t)/2}}var B=globalThis.document!==void 0?globalThis.document.createElement("span"):void 0;class l{r;g;b;a;static fromVar(e,o=document.body){return l.fromCss(Ee(e,o))}static fromCss(e){let o=e;if(B instanceof HTMLSpanElement)B.style.color="black",B.style.color=e,document.body.appendChild(B),o=getComputedStyle(B).color,B.remove();let[n,r,t,i]=o.match(/[\d.]+/g)||["0","0","0","0"],m=o.startsWith("color(srgb")?255:1;return new l(Number(n)*m,Number(r)*m,Number(t)*m,i==null?1:Number(i))}static fromHsl(e,o,n,r=1){let t,i,m;if(o===0)t=i=m=n;else{let c=(C,k,p)=>{if(p<0)p+=1;if(p>1)p-=1;if(p<0.16666666666666666)return C+(k-C)*6*p;if(p<0.5)return k;if(p<0.6666666666666666)return C+(k-C)*(0.6666666666666666-p)*6;return C},f=n<0.5?n*(1+o):n+o-n*o,u=2*n-f,y=(e%360+360)%360/360;t=c(u,f,y+0.3333333333333333),i=c(u,f,y),m=c(u,f,y-0.3333333333333333)}let s=new l(t*255,i*255,m*255,r);return s.hslCached={h:(e%360+360)%360,s:o,l:n},s}static black=new l(0,0,0);static white=new l(255,255,255);constructor(e,o,n,r=1){this.r=T(0,e,255),this.g=T(0,o,255),this.b=T(0,n,255),this.a=T(0,r,1)}get inverse(){return new l(255-this.r,255-this.g,255-this.b,this.a)}get inverseLuminance(){let{h:e,s:o,l:n}=this._hsl;return l.fromHsl(e,o,1-n,this.a)}get opaque(){return this.a===1?this:new l(this.r,this.g,this.b,1)}contrasting(e=1){return this.opaque.blend(this.brightness>0.5?l.black:l.white,e)}get rgb(){let{r:e,g:o,b:n}=this;return`rgb(${e.toFixed(0)},${o.toFixed(0)},${n.toFixed(0)})`}get rgba(){let{r:e,g:o,b:n,a:r}=this;return`rgba(${e.toFixed(0)},${o.toFixed(0)},${n.toFixed(0)},${r.toFixed(2)})`}get RGBA(){return[this.r/255,this.g/255,this.b/255,this.a]}get ARGB(){return[this.a,this.r/255,this.g/255,this.b/255]}hslCached;get _hsl(){if(this.hslCached==null)this.hslCached=new go(this.r,this.g,this.b);return this.hslCached}get hsl(){let{h:e,s:o,l:n}=this._hsl;return`hsl(${e.toFixed(0)}deg ${(o*100).toFixed(0)}% ${(n*100).toFixed(0)}%)`}get hsla(){let{h:e,s:o,l:n}=this._hsl;return`hsl(${e.toFixed(0)}deg ${(o*100).toFixed(0)}% ${(n*100).toFixed(0)}% / ${(this.a*100).toFixed(0)}%)`}get mono(){let e=this.brightness*255;return new l(e,e,e)}get brightness(){return yn(this.r,this.g,this.b)}get html(){return this.toString()}toString(){return this.a===1?"#"+O(this.r)+O(this.g)+O(this.b):"#"+O(this.r)+O(this.g)+O(this.b)+O(Math.floor(255*this.a))}brighten(e){let{h:o,s:n,l:r}=this._hsl,t=T(0,r+e*(1-r),1);return l.fromHsl(o,n,t,this.a)}darken(e){let{h:o,s:n,l:r}=this._hsl,t=T(0,r*(1-e),1);return l.fromHsl(o,n,t,this.a)}saturate(e){let{h:o,s:n,l:r}=this._hsl,t=T(0,n+e*(1-n),1);return l.fromHsl(o,t,r,this.a)}desaturate(e){let{h:o,s:n,l:r}=this._hsl,t=T(0,n*(1-e),1);return l.fromHsl(o,t,r,this.a)}rotate(e){let{h:o,s:n,l:r}=this._hsl,t=(o+360+e)%360;return l.fromHsl(t,n,r,this.a)}opacity(e){let{h:o,s:n,l:r}=this._hsl;return l.fromHsl(o,n,r,e)}swatch(){return console.log(`%c      %c ${this.html}, ${this.rgba}`,`background-color: ${this.html}`,"background-color: transparent"),this}blend(e,o){return new l(F(this.r,e.r,o),F(this.g,e.g,o),F(this.b,e.b,o),F(this.a,e.a,o))}static blendHue(e,o,n){let r=(o-e+720)%360;if(r<180)return e+n*r;else return e-(360-r)*n}mix(e,o){let n=this._hsl,r=e._hsl;return l.fromHsl(n.s===0?r.h:r.s===0?n.h:l.blendHue(n.h,r.h,o),F(n.s,r.s,o),F(n.l,r.l,o),F(this.a,e.a,o))}colorMix(e,o){return l.fromCss(`color-mix(in hsl, ${this.html}, ${e.html} ${(o*100).toFixed(0)}%)`)}}function Xo(e,o){let n=d.style(U(o));n.id=e,document.head.append(n)}var hn=["animation-iteration-count","flex","flex-base","flex-grow","flex-shrink","opacity","order","tab-size","widows","z-index","zoom"],_e=(e,o)=>{if(typeof o==="number"&&!hn.includes(e))o=`${o}px`;if(e.startsWith("_"))if(e.startsWith("__"))e="--"+e.substring(2),o=`var(${e}-default, ${o})`;else e="--"+e.substring(1);return{prop:e,value:String(o)}},wn=(e,o,n)=>{if(n===void 0)return"";if(n instanceof l)n=n.html;let r=_e(o,n);return`${e}  ${r.prop}: ${r.value};`},$o=(e,o,n="")=>{let r=M(e);if(typeof o==="object"&&!(o instanceof l)){let t=Object.keys(o).map((i)=>$o(i,o[i],`${n}  `)).join(`
`);return`${n}  ${e} {
${t}
${n}  }`}else return wn(n,r,o)},U=(e,o="")=>{return Object.keys(e).map((r)=>{let t=e[r];if(typeof t==="string"){if(r==="@import")return`@import url('${t}');`;throw Error("top-level string value only allowed for `@import`")}let i=Object.keys(t).map((m)=>$o(m,t[m])).join(`
`);return`${o}${r} {
${i}
}`}).join(`

`)},zo=(e)=>{q("initVars","initVars is deprecated. Just use _ and __ prefixes instead.");let o={};for(let n of Object.keys(e)){let r=e[n],t=M(n);o[`--${t}`]=typeof r==="number"&&r!==0?String(r)+"px":r}return o},Do=(e)=>{let o={};for(let n of Object.keys(e)){let r=e[n];if(r instanceof l)o[n]=r.inverseLuminance;else if(typeof r==="string"&&r.match(/^(#[0-9a-fA-F]{3}|rgba?\(|hsla?\()/))o[n]=l.fromCss(r).inverseLuminance}return o},se=new Proxy({},{get(e,o){if(e[o]===void 0){let n="--"+M(o);e[o]=(r)=>`var(${n}, ${r})`}return e[o]}}),be=new Proxy({},{get(e,o){if(o==="default")return se;if(e[o]==null){o=M(o);let[,n,,r,t,i]=o.match(/^([-\w]*?)((_)?(\d+)(\w?))?$/)||["",o],m=`--${n}`;if(t!=null){let s=r==null?Number(t)/100:-Number(t)/100;switch(i){case"b":{let c=l.fromVar(m);e[o]=s>0?c.brighten(s).rgba:c.darken(-s).rgba}break;case"s":{let c=l.fromVar(m);e[o]=s>0?c.saturate(s).rgba:c.desaturate(-s).rgba}break;case"h":{let c=l.fromVar(m);e[o]=c.rotate(s*100).rgba}break;case"o":{let c=l.fromVar(m);e[o]=c.opacity(s).rgba}break;case"":e[o]=`calc(var(${m}) * ${s})`;break;default:throw console.error(i),Error(`Unrecognized method ${i} for css variable ${m}`)}}else e[o]=`var(${m})`}return e[o]}});var Fo="http://www.w3.org/1998/Math/MathML",Yo="http://www.w3.org/2000/svg";var xe={},Jo=(e,o,n)=>{let r=_e(M(o),n);if(r.prop.startsWith("--"))e.style.setProperty(r.prop,r.value);else e.style[o]=r.value},pn=(e)=>{return{toDOM(o,n){Jo(o,e,n)}}},Wo=(e,o,n)=>{if(o==="style")if(typeof n==="object")for(let r of Object.keys(n))if(b(n[r]))L(e,n[r],pn(r));else Jo(e,r,n[r]);else e.setAttribute("style",n);else if(e[o]!==void 0){let{MathMLElement:r}=globalThis;if(e instanceof SVGElement||r!==void 0&&e instanceof r)e.setAttribute(o,n);else e[o]=n}else{let r=M(o);if(r==="class")n.split(" ").forEach((t)=>{e.classList.add(t)});else if(e[r]!==void 0)e[r]=n;else if(typeof n==="boolean")n?e.setAttribute(r,""):e.removeAttribute(r);else e.setAttribute(r,n)}},Cn=(e)=>{return{toDOM(o,n){Wo(o,e,n)}}},En=(e,o,n)=>{if(o==="apply")n(e);else if(o.match(/^on[A-Z]/)!=null){let r=o.substring(2).toLowerCase();K(e,r,n)}else if(o==="bind")if((typeof n.binding==="string"?te[n.binding]:n.binding)!==void 0&&n.value!==void 0)L(e,n.value,n.binding instanceof Function?{toDOM:n.binding}:n.binding);else throw Error("bad binding");else if(o.match(/^bind[A-Z]/)!=null){let r=o.substring(4,5).toLowerCase()+o.substring(5),t=te[r];if(t!==void 0)L(e,n,t);else throw Error(`${o} is not allowed, bindings.${r} is not defined`)}else if(b(n))L(e,n,Cn(o));else Wo(e,o,n)},Ne=(e,...o)=>{if(xe[e]===void 0){let[t,i]=e.split("|");if(i===void 0)xe[e]=globalThis.document.createElement(t);else xe[e]=globalThis.document.createElementNS(i,t)}let n=xe[e].cloneNode(),r={};for(let t of o)if(t instanceof Element||t instanceof DocumentFragment||typeof t==="string"||typeof t==="number")if(n instanceof HTMLTemplateElement)n.content.append(t);else n.append(t);else if(b(t))n.append(d.span({bindText:t}));else Object.assign(r,t);for(let t of Object.keys(r)){let i=r[t];En(n,t,i)}return n},eo=(...e)=>{let o=globalThis.document.createDocumentFragment();for(let n of e)o.append(n);return o},d=new Proxy({fragment:eo},{get(e,o){if(o=o.replace(/[A-Z]/g,(n)=>`-${n.toLocaleLowerCase()}`),e[o]===void 0)e[o]=(...n)=>Ne(o,...n);return e[o]},set(){throw Error("You may not add new properties to elements")}}),Me=new Proxy({fragment:eo},{get(e,o){if(e[o]===void 0)e[o]=(...n)=>Ne(`${o}|${Yo}`,...n);return e[o]},set(){throw Error("You may not add new properties to elements")}}),Te=new Proxy({fragment:eo},{get(e,o){if(e[o]===void 0)e[o]=(...n)=>Ne(`${o}|${Fo}`,...n);return e[o]},set(){throw Error("You may not add new properties to elements")}});var bn=["sort","splice","copyWithin","fill","pop","push","reverse","shift","unshift"],xn=!0,Mn=/^\.?([^.[\](),])+(\.[^.[\](),]+|\[\d+\]|\[[^=[\](),]*=[^[\]()]+\])*$/,Tn=(e)=>Mn.test(e),v=(e="",o="")=>{if(e==="")return o;else if(o.match(/^\d+$/)!==null||o.includes("="))return`${e}[${o}]`;else return`${e}.${o}`},qo={};function oo(e,o){if(e!==null&&(typeof e==="object"||typeof e==="function"))return e;return new Proxy(qo,V(o,!0))}var Le=()=>new Proxy({},V("^",!0)),jo=!1;function R(){if(!jo)console.warn("xinValue, tosiValue, xinPath, tosiPath, etc. are deprecated. Use value, path, observe, bind, on, binding, listBinding instead."),jo=!0}var Ao=(e)=>{return e===qo},V=(e,o)=>({get(n,r){if(Ao(n)){let s=()=>Z(N,e);switch(r){case"path":return e;case"value":return s();case"valueOf":case"toJSON":return()=>s();case Symbol.toPrimitive:return(c)=>{let f=s();if(c==="number")return Number(f);if(c==="string")return String(f);return f};case"toString":return()=>String(s());case"observe":return(c)=>{let f=j(e,c);return()=>z(f)};case"on":return(c,f)=>oe()(c,f,s());case"bind":return(c,f,u)=>{ee()(c,e,f,u)};case"binding":return(c)=>({bind:{value:e,binding:c}});case"listBinding":return(c=({span:u})=>u({bindText:"^"}),f={})=>[{bindList:{value:e,...f}},d.template(c(d,Le()))];case $:case"xinValue":case"tosiValue":return R(),s();case E:case"xinPath":case"tosiPath":return R(),e;case je:case"tosiObserve":return R(),(c)=>{let f=j(e,c);return()=>z(f)};case qe:case"tosiOn":return R(),(c,f)=>oe()(c,f,s());case Ae:case"tosiBind":return R(),(c,f,u)=>{ee()(c,e,f,u)};case"tosiBinding":return R(),(c)=>({bind:{value:e,binding:c}});case"tosiListBinding":return R(),(c=({span:u})=>u({bindText:"^"}),f={})=>[{bindList:{value:e,...f}},d.template(c(d,Le()))]}if(typeof r==="string"&&/^\d+$/.test(r)){let c=s();if(typeof c==="string")return c[parseInt(r,10)]}if(r==="length"){let c=s();if(typeof c==="string")return c.length}return}if(o&&!(r in n))switch(r){case"path":return e;case"value":return n.valueOf?n.valueOf():n;case"valueOf":case"toJSON":return()=>n.valueOf?n.valueOf():n;case"observe":return(s)=>{let c=j(e,s);return()=>z(c)};case"on":return(s,c)=>oe()(s,c,w(n));case"bind":return(s,c,f)=>{ee()(s,e,c,f)};case"binding":return(s)=>({bind:{value:e,binding:s}});case"listBinding":return(s=({span:f})=>f({bindText:"^"}),c={})=>[{bindList:{value:e,...c}},d.template(s(d,Le()))]}switch(r){case E:case"xinPath":case"tosiPath":return e;case $:case"xinValue":case"tosiValue":return n.valueOf?n.valueOf():n;case je:case"xinObserve":case"tosiObserve":return(s)=>{let c=j(e,s);return()=>z(c)};case qe:case"xinOn":case"tosiOn":return(s,c)=>oe()(s,c,w(n));case Ae:case"xinBind":case"tosiBind":return(s,c,f)=>{ee()(s,e,c,f)};case"tosiBinding":return(s)=>({bind:{value:e,binding:s}});case"tosiListBinding":return(s=({span:f})=>f({bindText:"^"}),c={})=>[{bindList:{value:e,...c}},d.template(s(d,Le()))]}if(typeof r==="symbol")return n[r];let t=Object.getOwnPropertyDescriptor(n,r);if(t&&!t.configurable&&!t.writable&&"value"in t)return t.value;let i=r,m=i.match(/^([^.[]+)\.(.+)$/)??i.match(/^([^\]]+)(\[.+)/)??i.match(/^(\[[^\]]+\])\.(.+)$/)??i.match(/^(\[[^\]]+\])\[(.+)$/);if(m!==null){let[,s,c]=m,f=v(e,s),u=Z(n,s);return u!==null&&typeof u==="object"?new Proxy(u,V(f,o))[c]:u}if(i.startsWith("[")&&i.endsWith("]"))i=i.substring(1,i.length-1);if(!Array.isArray(n)&&n[i]!==void 0||Array.isArray(n)&&i.includes("=")){let s;if(i.includes("=")){let[c,f]=i.split("=");s=n.find((u)=>`${Z(u,c)}`===f)}else s=n[i];if(s instanceof Object){let c=v(e,i);return new Proxy(s instanceof Function?s.bind(n):s,V(c,o))}else return o?oo(s,v(e,i)):s}else if(Array.isArray(n)){let s=n[i];return typeof s==="function"?(...c)=>{let f=c.map((y)=>w(y)),u=s.apply(n,f);if(bn.includes(i))G(e);return u}:typeof s==="object"?new Proxy(s,V(v(e,i),o)):o?oo(s,v(e,i)):s}else return o?oo(n[i],v(e,i)):n[i]},set(n,r,t){t=w(t);let m=r===$||r==="xinValue"||r==="tosiValue"||r==="value"&&(Ao(n)||o)?e:v(e,r);if(xn&&!Tn(m))throw Error(`setting invalid path ${m}`);if(w(a[m])!==t&&ko(N,m,t))G(m);return!0}}),ke=(e,o)=>{let n=typeof o==="function"?o:a[o];if(typeof n!=="function")throw Error(`observe expects a function or path to a function, ${o} is neither`);return j(e,n)},a=new Proxy(N,V("",!1));ao(a);var I=new Proxy(N,V("",!0));var Ln=16,kn=100;function Qo(e,o){let n=Array.from(e.querySelectorAll(J));if(e.matches(J))n.unshift(e);for(let r of n){let t=X.get(r);for(let i of t){if(i.path.startsWith("^"))i.path=`${o}${i.path.substring(1)}`;if(i.binding.toDOM!=null)i.binding.toDOM(r,a[i.path])}}}class Go{boundElement;listTop;listBottom;template;options;itemToElement;array=[];_update;_previousSlice;static filterBoundObservers=new WeakMap;constructor(e,o,n={}){if(this.boundElement=e,this.itemToElement=new WeakMap,e.children.length!==1)throw Error("ListBinding expects an element with exactly one child element");if(e.children[0]instanceof HTMLTemplateElement){let r=e.children[0];if(r.content.children.length!==1)throw Error("ListBinding expects a template with exactly one child element");this.template=Q(r.content.children[0])}else this.template=e.children[0],this.template.remove();if(this.options=n,this.listTop=document.createElement("div"),this.listBottom=document.createElement("div"),this.listTop.classList.add("virtual-list-padding"),this.listBottom.classList.add("virtual-list-padding"),this.boundElement.append(this.listTop),this.boundElement.append(this.listBottom),n.virtual!=null)if(ne.observe(this.boundElement),this._update=re(()=>{this.update(this.array,!0)},Ln),this.boundElement.addEventListener("resize",this._update),n.virtual.scrollContainer==="window")window.addEventListener("scroll",this._update),window.addEventListener("resize",this._update);else this.boundElement.addEventListener("scroll",this._update)}visibleSlice(){let{virtual:e,hiddenProp:o,visibleProp:n}=this.options,r=this.array;if(o!==void 0)r=r.filter((c)=>c[o]!==!0);if(n!==void 0)r=r.filter((c)=>c[n]===!0);if(this.options.filter&&this.needle!==void 0)r=this.options.filter(r,this.needle);let t=0,i=r.length-1,m=0,s=0;if(e!=null&&this.boundElement instanceof HTMLElement){let c=this.boundElement.offsetWidth,f=e.scrollContainer==="window",u,y;if(f){u=window.innerHeight;let P=this.boundElement.getBoundingClientRect();y=Math.max(0,-P.top)}else u=this.boundElement.offsetHeight,y=this.boundElement.scrollTop;if(e.visibleColumns==null)e.visibleColumns=e.width!=null?Math.max(1,Math.floor(c/e.width)):1;let C=Math.ceil(u/e.height)+(e.rowChunkSize||1),k=Math.ceil(r.length/e.visibleColumns),p=e.visibleColumns*C,S=Math.floor(y/e.height);if(S>k-C+1)S=Math.max(0,k-C+1);if(e.rowChunkSize)S-=S%e.rowChunkSize;t=S*e.visibleColumns,i=t+p-1,m=S*e.height,s=Math.max((k-C)*e.height-m,0)}return{items:r,firstItem:t,lastItem:i,topBuffer:m,bottomBuffer:s}}needle;filter=re((e)=>{if(this.needle!==e)this.needle=e,this.update(this.array)},kn);update(e,o){if(e==null)e=[];this.array=e;let{hiddenProp:n,visibleProp:r}=this.options,t=b(e),i=this.visibleSlice();this.boundElement.classList.toggle("-xin-empty-list",i.items.length===0);let m=this._previousSlice,{firstItem:s,lastItem:c,topBuffer:f,bottomBuffer:u}=i;if(n===void 0&&r===void 0&&o===!0&&m!=null&&s===m.firstItem&&c===m.lastItem)return;this._previousSlice=i;let y=0,C=0,k=0;for(let h of Array.from(this.boundElement.children)){if(h===this.listTop||h===this.listBottom)continue;let H=h[ae];if(H==null)h.remove();else{let x=i.items.indexOf(H);if(x<s||x>c)h.remove(),this.itemToElement.delete(H),y++}}this.listTop.style.height=String(f)+"px",this.listBottom.style.height=String(u)+"px";let p=[],{idPath:S}=this.options;for(let h=s;h<=c;h++){let H=i.items[h];if(H===void 0)continue;let x=this.itemToElement.get(w(H));if(x==null){if(k++,x=Q(this.template),typeof H==="object")this.itemToElement.set(w(H),x),x[ae]=w(H);if(this.boundElement.insertBefore(x,this.listBottom),S!=null){let De=H[S],Po=`${t}[${S}=${De}]`;Qo(x,Po)}else{let De=`${t}[${h}]`;Qo(x,De)}}p.push(x)}let P=null;for(let h of p){if(h.previousElementSibling!==P)if(C++,P?.nextElementSibling!=null)this.boundElement.insertBefore(h,P.nextElementSibling);else this.boundElement.insertBefore(h,this.listBottom);P=h}if(W.perf)console.log(t,"updated",{removed:y,created:k,moved:C})}}var ie=(e,o,n)=>{let r=e[_];if(o&&r===void 0)r=new Go(e,o,n),e[_]=r;return r},Se=(e)=>{let o;while(!(o=e[ae])&&e&&e.parentElement)e=e.parentElement;return o?{element:e,item:o}:void 0},He=(e)=>{let o=Se(e);return o?o.item:void 0},Zo=(e)=>{let o=Se(e);if(!o)return console.error("deleteListItem failed, element is not part of a list instance",e),!1;let n=ie(o.element.parentElement);if(!n.options.idPath)return console.error("deleteListItem failed, list binding has no idPath",e.parentElement,n),!1;let r=n.array.indexOf(o.item);if(r>-1)return n.array.splice(r,1),!0;return!1};var{document:ce,MutationObserver:Oo}=globalThis,ge=(e,o)=>{let n=X.get(e);if(n==null)return;for(let r of n){let{binding:t,options:i}=r,{path:m}=r,{toDOM:s}=t;if(s!=null){if(m.startsWith("^")){let c=He(e);if(c!=null&&c[E]!=null)m=r.path=`${c[E]}${m.substring(1)}`;else throw console.error(`Cannot resolve relative binding ${m}`,e,"is not part of a list"),Error(`Cannot resolve relative binding ${m}`)}if(o==null||m.startsWith(o))s(e,pe()[m],i)}}};if(Oo!=null)new Oo((o)=>{o.forEach((n)=>{Array.from(n.addedNodes).forEach((r)=>{if(r instanceof Element)Array.from(r.querySelectorAll(J)).forEach((t)=>ge(t))})})}).observe(ce.body,{subtree:!0,childList:!0});j(()=>!0,(e)=>{let o=Array.from(ce.querySelectorAll(J));for(let n of o)ge(n,e)});var Uo=(e)=>{let o=e.target?.closest(J);while(o!=null){let n=X.get(o);for(let r of n){let{binding:t,path:i}=r,{fromDOM:m}=t;if(m!=null){let s;try{s=m(o,r.options)}catch(c){throw console.error("Cannot get value from",o,"via",r),Error("Cannot obtain value fromDOM")}if(s!=null){let c=pe(),f=c[i];if(f==null)c[i]=s;else{let u=f[E]!=null?f[$]:f,y=s[E]!=null?s[$]:s;if(u!==y)c[i]=y}}}}o=o.parentElement.closest(J)}};if(globalThis.document!=null)ce.body.addEventListener("change",Uo,!0),ce.body.addEventListener("input",Uo,!0);function L(e,o,n,r){if(e instanceof DocumentFragment)throw Error("bind cannot bind to a DocumentFragment");let t;if(typeof o==="object"&&o[E]===void 0&&r===void 0){let{value:s}=o;t=typeof s==="string"?s:s[E],r=o,delete r.value}else t=typeof o==="string"?o:o[E];if(t==null)throw Error("bind requires a path or object with xin Proxy");let{toDOM:i}=n;e.classList?.add(Ye);let m=X.get(e);if(m==null)m=[],X.set(e,m);if(m.push({path:t,binding:n,options:r}),i!=null&&!t.startsWith("^"))G(t);if(r?.filter&&r?.needle)L(e,r.needle,{toDOM(s,c){console.log({needle:c}),s[_]?.filter(c)}});return e}var Ko=new Set,Sn=(e)=>{let o=e?.target?.closest(We),n=!1,r=new Proxy(e,{get(i,m){if(m==="stopPropagation")return()=>{e.stopPropagation(),n=!0};else{let s=i[m];return typeof s==="function"?s.bind(i):s}}}),t=new Set;while(!n&&o!=null){let m=A.get(o)[e.type]||t;for(let s of m){if(typeof s==="function")s(r);else{let c=pe()[s];if(typeof c==="function")c(r);else throw Error(`no event handler found at path ${s}`)}if(n)continue}o=o.parentElement!=null?o.parentElement.closest(We):null}};function K(e,o,n){let r=A.get(e);if(e.classList.add(Je),r==null)r={},A.set(e,r);if(!r[o])r[o]=new Set;if(r[o].add(n),!Ko.has(o))Ko.add(o),ce.body.addEventListener(o,Sn,!0);return()=>{r[o].delete(n)}}yo(L,K);var Hn=0;function no(){return`custom-elt${(Hn++).toString(36)}`}var vo=0,me={};function gn(e,o){let n=me[e],r=U(o).replace(/:host\b/g,e);me[e]=n?n+`
`+r:r}function Xn(e){if(me[e])document.head.append(d.style({id:e+"-component"},me[e]));delete me[e]}class Y extends HTMLElement{static elements=d;static _elementCreator;instanceId;styleNode;static styleSpec;static styleNode;content=d.slot();isSlotted;static _tagName=null;static get tagName(){return this._tagName}static StyleNode(e){return console.warn("StyleNode is deprecated, just assign static styleSpec: XinStyleSheet to the class directly"),d.style(U(e))}static elementCreator(e={}){let o=this;if(o._elementCreator==null){let{tag:n,styleSpec:r}=e,t=e!=null?n:null;if(t==null)if(typeof o.name==="string"&&o.name!==""){if(t=M(o.name),t.startsWith("-"))t=t.slice(1)}else t=no();if(customElements.get(t)!=null)console.warn(`${t} is already defined`);if(t.match(/\w+(-\w+)+/)==null)console.warn(`${t} is not a legal tag for a custom-element`),t=no();while(customElements.get(t)!==void 0)t=no();if(o._tagName=t,r!==void 0)gn(t,r);window.customElements.define(t,this,e),o._elementCreator=d[t]}return o._elementCreator}initAttributes(...e){let o={},n={};new MutationObserver((t)=>{let i=!1;if(t.forEach((m)=>{i=!!(m.attributeName&&e.includes(So(m.attributeName)))}),i&&this.queueRender!==void 0)this.queueRender(!1)}).observe(this,{attributes:!0}),e.forEach((t)=>{o[t]=g(this[t]);let i=M(t);Object.defineProperty(this,t,{enumerable:!1,get(){if(typeof o[t]==="boolean")return this.hasAttribute(i);else if(this.hasAttribute(i))return typeof o[t]==="number"?parseFloat(this.getAttribute(i)):this.getAttribute(i);else if(n[t]!==void 0)return n[t];else return o[t]},set(m){if(typeof o[t]==="boolean"){if(m!==this[t]){if(m)this.setAttribute(i,"");else this.removeAttribute(i);this.queueRender()}}else if(typeof o[t]==="number"){if(m!==parseFloat(this[t]))this.setAttribute(i,m),this.queueRender()}else if(typeof m==="object"||`${m}`!==`${this[t]}`){if(m===null||m===void 0||typeof m==="object")this.removeAttribute(i);else this.setAttribute(i,m);this.queueRender(),n[t]=m}}})})}initValue(){let e=Object.getOwnPropertyDescriptor(this,"value");if(e===void 0||e.get!==void 0||e.set!==void 0)return;let o=this.hasAttribute("value")?this.getAttribute("value"):g(this.value);delete this.value,Object.defineProperty(this,"value",{enumerable:!1,get(){return o},set(n){if(o!==n)o=n,this.queueRender(!0)}})}_parts;get parts(){let e=this.shadowRoot!=null?this.shadowRoot:this;if(this._parts==null)this._parts=new Proxy({},{get(o,n){if(o[n]===void 0){let r=e.querySelector(`[part="${n}"]`);if(r==null)r=e.querySelector(n);if(r==null)throw Error(`elementRef "${n}" does not exist!`);r.removeAttribute("data-ref"),o[n]=r}return o[n]}});return this._parts}constructor(){super();vo+=1,this.initAttributes("hidden"),this.instanceId=`${this.tagName.toLocaleLowerCase()}-${vo}`,this._value=g(this.defaultValue)}connectedCallback(){if(Xn(this.constructor.tagName),this.hydrate(),this.role!=null)this.setAttribute("role",this.role);if(this.onResize!==void 0){if(ne.observe(this),this._onResize==null)this._onResize=this.onResize.bind(this);this.addEventListener("resize",this._onResize)}if(this.value!=null&&this.getAttribute("value")!=null)this._value=this.getAttribute("value");this.queueRender()}disconnectedCallback(){ne.unobserve(this)}_changeQueued=!1;_renderQueued=!1;queueRender(e=!1){if(!this._hydrated)return;if(!this._changeQueued)this._changeQueued=e;if(!this._renderQueued)this._renderQueued=!0,requestAnimationFrame(()=>{if(this._changeQueued)Re(this,"change");this._changeQueued=!1,this._renderQueued=!1,this.render()})}_hydrated=!1;hydrate(){if(!this._hydrated){this.initValue();let e=typeof this.content!=="function",o=typeof this.content==="function"?this.content(d):this.content,{styleSpec:n}=this.constructor,{styleNode:r}=this.constructor;if(n)r=this.constructor.styleNode=d.style(U(n)),delete this.constructor.styleNode;if(this.styleNode)console.warn(this,"styleNode is deprecrated, use static styleNode or statc styleSpec instead"),r=this.styleNode;if(r){let t=this.attachShadow({mode:"open"});t.appendChild(r.cloneNode(!0)),Ve(t,o,e)}else if(o!==null){let t=Array.from(this.childNodes);Ve(this,o,e),this.isSlotted=this.querySelector("slot,xin-slot")!==void 0;let i=Array.from(this.querySelectorAll("slot"));if(i.length>0)i.forEach(ro.replaceSlot);if(t.length>0){let m={"":this};Array.from(this.querySelectorAll("xin-slot")).forEach((s)=>{m[s.name]=s}),t.forEach((s)=>{let c=m[""],f=s instanceof Element?m[s.slot]:c;(f!==void 0?f:c).append(s)})}}this._hydrated=!0}}render(){}}class ro extends Y{name="";content=null;static replaceSlot(e){let o=document.createElement("xin-slot");if(e.name!=="")o.setAttribute("name",e.name);e.replaceWith(o)}constructor(){super();this.initAttributes("name")}}var Kr=ro.elementCreator({tag:"xin-slot"});var Ro=(e=()=>!0)=>{let o=localStorage.getItem("xin-state");if(o!=null){let r=JSON.parse(o);for(let t of Object.keys(r).filter(e))if(a[t]!==void 0)Object.assign(a[t],r[t]);else a[t]=r[t]}let n=Ce(()=>{let r={},t=w(a);for(let i of Object.keys(t).filter(e))r[i]=t[i];localStorage.setItem("xin-state",JSON.stringify(r)),console.log("xin state saved to localStorage")},500);ke(e,n)};var Xe="1.1.4";function fe(e){return Object.assign(I,e),I}function le(e){return q("boxedProxy","boxedProxy is deprecated, please use tosi() instead"),fe(e)}function $e(e,o=!1){if(o)return q("xinProxy-boxed","xinProxy(..., true) is deprecated; use tosi(...) instead"),le(e);return Object.keys(e).forEach((n)=>{a[n]=e[n]}),a}var $n={};async function ue(e,o){let{type:n,styleSpec:r}=await o(e,{Color:l,Component:Y,elements:d,svgElements:Me,mathML:Te,varDefault:se,vars:be,xin:a,boxed:I,xinProxy:$e,boxedProxy:le,tosi:fe,makeComponent:ue,bind:L,on:K,version:Xe}),t={type:n,creator:n.elementCreator({tag:e,styleSpec:r})};return $n[e]=t,t}var to={},zn=(e)=>import(e);class de extends Y{tag="anon-elt";src="";property="default";loaded;blueprintLoaded=(e)=>{};async packaged(){let{tag:e,src:o,property:n}=this,r=`${e}.${n}:${o}`;if(!this.loaded){if(to[r]===void 0)to[r]=zn(o).then((t)=>{let i=t[n];return ue(e,i)});else console.log(`using cached ${e} with signature ${r}`);this.loaded=await to[r],this.blueprintLoaded(this.loaded)}return this.loaded}constructor(){super();this.initAttributes("tag","src","property")}}var Vo=de.elementCreator({tag:"xin-blueprint",styleSpec:{":host":{display:"none"}}});class ze extends Y{allLoaded=()=>{};constructor(){super()}async load(){let o=Array.from(this.querySelectorAll(de.tagName)).filter((n)=>n.src).map((n)=>n.packaged());await Promise.all(o),this.allLoaded()}connectedCallback(){super.connectedCallback(),this.load()}}var Io=ze.elementCreator({tag:"xin-loader",styleSpec:{":host":{display:"none"}}});})();

//# debugId=E77F18B478008BCC64756E2164756E21
//# sourceMappingURL=index.js.map
