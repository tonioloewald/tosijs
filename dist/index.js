(()=>{var{defineProperty:we,getOwnPropertyNames:Dn,getOwnPropertyDescriptor:Bn}=Object,Fn=Object.prototype.hasOwnProperty;var Je=new WeakMap,Pn=(e)=>{var n=Je.get(e),o;if(n)return n;if(n=we({},"__esModule",{value:!0}),e&&typeof e==="object"||typeof e==="function")Dn(e).map((t)=>!Fn.call(n,t)&&we(n,t,{get:()=>e[t],enumerable:!(o=Bn(e,t))||o.enumerable}));return Je.set(e,n),n};var On=(e,n)=>{for(var o in n)we(e,o,{get:n[o],enumerable:!0,configurable:!0,set:(t)=>n[o]=()=>t})};var po={};On(po,{xinValue:()=>h,xinProxy:()=>Ee,xinPath:()=>S,xin:()=>d,version:()=>he,vars:()=>fe,varDefault:()=>R,updates:()=>He,unobserve:()=>U,touchElement:()=>xe,touch:()=>j,tosi:()=>ne,throttle:()=>Z,svgElements:()=>pe,settings:()=>B,on:()=>P,observe:()=>_,mathML:()=>ye,makeComponent:()=>te,invertLuminance:()=>En,initVars:()=>hn,hotReload:()=>Ln,getListItem:()=>se,getCssVar:()=>de,elements:()=>f,debounce:()=>ae,css:()=>I,boxedProxy:()=>oe,boxed:()=>V,blueprintLoader:()=>Hn,blueprint:()=>kn,bindings:()=>K,bind:()=>E,StyleSheet:()=>yn,MoreMath:()=>un,Component:()=>D,Color:()=>a,BlueprintLoader:()=>be,Blueprint:()=>re});var B={debug:!1,perf:!1};function L(e){if(e==null||typeof e!=="object")return e;if(e instanceof Set)return new Set(e);else if(Array.isArray(e))return e.map(L);let n={};for(let o in e){let t=e[o];if(e!=null&&typeof e==="object")n[o]=L(t);else n[o]=t}return n}var Ce="-xin-data",F=`.${Ce}`,Xe="-xin-event",Me=`.${Xe}`,T="xinPath",z="xinValue",Ge="xinObserve",_e="xinBind",qe="xinOn",S=(e)=>{return e&&e[T]||void 0};function h(e){return typeof e==="object"&&e!==null?e[z]||e:e}var $=new WeakMap,k=new WeakMap;var A=(e)=>{let n=e.cloneNode();if(n instanceof Element){let o=k.get(e),t=$.get(e);if(o!=null)k.set(n,L(o));if(t!=null)$.set(n,L(t))}for(let o of Array.from(e instanceof HTMLTemplateElement?e.content.childNodes:e.childNodes))if(o instanceof Element||o instanceof DocumentFragment)n.appendChild(A(o));else n.appendChild(o.cloneNode());return n},q=new WeakMap,se=(e)=>{let n=document.body.parentElement;while(e.parentElement!=null&&e.parentElement!==n){let o=q.get(e);if(o!=null)return o;e=e.parentElement}return!1};var Qe=Symbol("observer should be removed"),le=[],ce=[],Se=!1,Le,ke;class Ze{description;test;callback;constructor(e,n){let o=typeof n==="string"?`"${n}"`:`function ${n.name}`,t;if(typeof e==="string")this.test=(r)=>typeof r==="string"&&r!==""&&(e.startsWith(r)||r.startsWith(e)),t=`test = "${e}"`;else if(e instanceof RegExp)this.test=e.test.bind(e),t=`test = "${e.toString()}"`;else if(e instanceof Function)this.test=e,t=`test = function ${e.name}`;else throw Error("expect listener test to be a string, RegExp, or test function");if(this.description=`${t}, ${o}`,typeof n==="function")this.callback=n;else throw Error("expect callback to be a path or function");le.push(this)}}var He=async()=>{if(Le===void 0)return;await Le},$n=()=>{if(B.perf)console.time("xin async update");let e=Array.from(ce);for(let n of e)le.filter((o)=>{let t;try{t=o.test(n)}catch(r){throw Error(`Listener ${o.description} threw "${r}" at "${n}"`)}if(t===Qe)return U(o),!1;return t}).forEach((o)=>{let t;try{t=o.callback(n)}catch(r){console.error(`Listener ${o.description} threw "${r}" handling "${n}"`)}if(t===Qe)U(o)});if(ce.splice(0),Se=!1,typeof ke==="function")ke();if(B.perf)console.timeEnd("xin async update")},j=(e)=>{let n=typeof e==="string"?e:S(e);if(n===void 0)throw console.error("touch was called on an invalid target",e),Error("touch was called on an invalid target");if(Se===!1)Le=new Promise((o)=>{ke=o}),Se=setTimeout($n);if(ce.find((o)=>n.startsWith(o))==null)ce.push(n)},ve=(e,n)=>{return new Ze(e,n)},U=(e)=>{let n=le.indexOf(e);if(n>-1)le.splice(n,1);else throw Error("unobserve failed, listener not found")};var zn=(e)=>{try{return JSON.stringify(e)}catch(n){return"{has circular references}"}},De=(...e)=>Error(e.map(zn).join(" "));var An=()=>new Date(parseInt("1000000000",36)+Date.now()).valueOf().toString(36).slice(1),jn=0,Wn=()=>(parseInt("10000",36)+ ++jn).toString(36).slice(-5),In=()=>An()+Wn(),Fe=Symbol("delete"),Ne=Symbol("new-object"),Be=Symbol("automatic-index");function en(e){if(e==="")return[];if(Array.isArray(e))return e;else{let n=[];while(e.length>0){let o=e.search(/\[[^\]]+\]/);if(o===-1){n.push(e.split("."));break}else{let t=e.slice(0,o);if(e=e.slice(o),t!=="")n.push(t.split("."));if(o=e.indexOf("]")+1,n.push(e.slice(1,o-1)),e.slice(o,o+1)===".")o+=1;e=e.slice(o)}}return n}}var H=new WeakMap;function nn(e,n){if(H.get(e)===void 0)H.set(e,{});if(H.get(e)[n]===void 0)H.get(e)[n]={};let o=H.get(e)[n];if(n==="_auto_")e.forEach((t,r)=>{if(t[Be]===void 0)t[Be]=In();o[t[Be]+""]=r});else e.forEach((t,r)=>{o[J(t,n)+""]=r});return o}function Yn(e,n){if(H.get(e)===void 0||H.get(e)[n]===void 0)return nn(e,n);else return H.get(e)[n]}function Vn(e,n,o){o=o+"";let t=Yn(e,n)[o];if(t===void 0||J(e[t],n)+""!==o)t=nn(e,n)[o];return t}function Un(e,n,o){if(e[n]===void 0&&o!==void 0)e[n]=o;return e[n]}function on(e,n,o,t){let r=n!==""?Vn(e,n,o):o;if(t===Fe)return e.splice(r,1),H.delete(e),Symbol("deleted");else if(t===Ne){if(n===""&&e[r]===void 0)e[r]={}}else if(t!==void 0)if(r!==void 0)e[r]=t;else if(n!==""&&J(t,n)+""===o+"")e.push(t),r=e.length-1;else throw Error(`byIdPath insert failed at [${n}=${o}]`);return e[r]}function Ke(e){if(!Array.isArray(e))throw De("setByPath failed: expected array, found",e)}function Re(e){if(e==null||!(e instanceof Object))throw De("setByPath failed: expected Object, found",e)}function J(e,n){let o=en(n),t=e,r,s,i,l;for(r=0,s=o.length;t!==void 0&&r<s;r++){let c=o[r];if(Array.isArray(c))for(i=0,l=c.length;t!==void 0&&i<l;i++){let m=c[i];t=t[m]}else if(t.length===0){if(t=t[Number(c.slice(1))],c[0]!=="=")return}else if(c.includes("=")){let[m,...p]=c.split("=");t=on(t,m,p.join("="))}else i=parseInt(c,10),t=t[i]}return t}function tn(e,n,o){let t=e;if(n==="")throw Error("setByPath cannot be used to set the root object");let r=en(n);while(t!=null&&r.length>0){let s=r.shift();if(typeof s==="string"){let i=s.indexOf("=");if(i>-1){if(i===0)Re(t);else Ke(t);let l=s.slice(0,i),c=s.slice(i+1);if(t=on(t,l,c,r.length>0?Ne:o),r.length===0)return!0}else{Ke(t);let l=parseInt(s,10);if(r.length>0)t=t[l];else{if(o!==Fe){if(t[l]===o)return!1;t[l]=o}else t.splice(l,1);return!0}}}else if(Array.isArray(s)&&s.length>0){Re(t);while(s.length>0){let i=s.shift();if(s.length>0||r.length>0)t=Un(t,i,s.length>0?{}:[]);else{if(o!==Fe){if(t[i]===o)return!1;t[i]=o}else{if(!Object.prototype.hasOwnProperty.call(t,i))return!1;delete t[i]}return!0}}}else throw Error(`setByPath failed, bad path ${n}`)}throw Error(`setByPath(${e}, ${n}, ${o}) failed`)}var Pe=(e,n)=>{let o=new Event(n);e.dispatchEvent(o)},sn=(e)=>{if(e instanceof HTMLInputElement)return e.type;else if(e instanceof HTMLSelectElement&&e.hasAttribute("multiple"))return"multi-select";else return"other"},ln=(e,n)=>{switch(sn(e)){case"radio":e.checked=e.value===n;break;case"checkbox":e.checked=!!n;break;case"date":e.valueAsDate=new Date(n);break;case"multi-select":for(let o of Array.from(e.querySelectorAll("option")))o.selected=n[o.value];break;default:e.value=n}},cn=(e)=>{switch(sn(e)){case"radio":{let n=e.parentElement?.querySelector(`[name="${e.name}"]:checked`);return n!=null?n.value:null}case"checkbox":return e.checked;case"date":return e.valueAsDate?.toISOString();case"multi-select":return Array.from(e.querySelectorAll("option")).reduce((n,o)=>{return n[o.value]=o.selected,n},{});default:return e.value}},{ResizeObserver:rn}=globalThis,Q=rn!=null?new rn((e)=>{for(let n of e){let o=n.target;Pe(o,"resize")}}):{observe(){},unobserve(){}},Oe=(e,n,o=!0)=>{if(e!=null&&n!=null)if(typeof n==="string")e.textContent=n;else if(Array.isArray(n))n.forEach((t)=>{e.append(t instanceof Node&&o?A(t):t)});else if(n instanceof Node)e.append(o?A(n):n);else throw Error("expect text content or document node")};var ae=(e,n=250)=>{let o;return(...t)=>{if(o!==void 0)clearTimeout(o);o=setTimeout(()=>{e(...t)},n)}},Z=(e,n=250)=>{let o,t=Date.now()-n,r=!1;return(...s)=>{if(clearTimeout(o),o=setTimeout(()=>{e(...s),t=Date.now()},n),!r&&Date.now()-t>=n){r=!0;try{e(...s),t=Date.now()}finally{r=!1}}}};var me=Symbol("list-binding"),Jn=16,Gn=100;function an(e,n){let o=Array.from(e.querySelectorAll(F));if(e.matches(F))o.unshift(e);for(let t of o){let r=k.get(t);for(let s of r){if(s.path.startsWith("^"))s.path=`${n}${s.path.substring(1)}`;if(s.binding.toDOM!=null)s.binding.toDOM(t,d[s.path])}}}class mn{boundElement;listTop;listBottom;template;options;itemToElement;_array=[];_update;_previousSlice;static filterBoundObservers=new WeakMap;constructor(e,n,o={}){if(this.boundElement=e,this.itemToElement=new WeakMap,e.children.length!==1)throw Error("ListBinding expects an element with exactly one child element");if(e.children[0]instanceof HTMLTemplateElement){let t=e.children[0];if(t.content.children.length!==1)throw Error("ListBinding expects a template with exactly one child element");this.template=A(t.content.children[0])}else this.template=e.children[0],this.template.remove();if(this.options=o,this.listTop=document.createElement("div"),this.listBottom=document.createElement("div"),this.listTop.classList.add("virtual-list-padding"),this.listBottom.classList.add("virtual-list-padding"),this.boundElement.append(this.listTop),this.boundElement.append(this.listBottom),o.virtual!=null)Q.observe(this.boundElement),this._update=Z(()=>{this.update(this._array,!0)},Jn),this.boundElement.addEventListener("scroll",this._update),this.boundElement.addEventListener("resize",this._update)}visibleSlice(){let{virtual:e,hiddenProp:n,visibleProp:o}=this.options,t=this._array;if(n!==void 0)t=t.filter((c)=>c[n]!==!0);if(o!==void 0)t=t.filter((c)=>c[o]===!0);if(this.options.filter&&this.needle!==void 0)t=this.options.filter(t,this.needle);let r=0,s=t.length-1,i=0,l=0;if(e!=null&&this.boundElement instanceof HTMLElement){let c=this.boundElement.offsetWidth,m=this.boundElement.offsetHeight;if(e.visibleColumns==null)e.visibleColumns=e.width!=null?Math.max(1,Math.floor(c/e.width)):1;let p=Math.ceil(m/e.height)+(e.rowChunkSize||1),C=Math.ceil(t.length/e.visibleColumns),X=e.visibleColumns*p,y=Math.floor(this.boundElement.scrollTop/e.height);if(y>C-p+1)y=Math.max(0,C-p+1);if(e.rowChunkSize)y-=y%e.rowChunkSize;r=y*e.visibleColumns,s=r+X-1,i=y*e.height,l=Math.max((C-p)*e.height-i,0)}return{items:t,firstItem:r,lastItem:s,topBuffer:i,bottomBuffer:l}}needle;filter=Z((e)=>{if(this.needle!==e)this.needle=e,this.update(this._array)},Gn);update(e,n){if(e==null)e=[];this._array=e;let{hiddenProp:o,visibleProp:t}=this.options,r=S(e),s=this.visibleSlice();this.boundElement.classList.toggle("-xin-empty-list",s.items.length===0);let i=this._previousSlice,{firstItem:l,lastItem:c,topBuffer:m,bottomBuffer:p}=s;if(o===void 0&&t===void 0&&n===!0&&i!=null&&l===i.firstItem&&c===i.lastItem)return;this._previousSlice=s;let C=0,X=0,y=0;for(let u of Array.from(this.boundElement.children)){if(u===this.listTop||u===this.listBottom)continue;let M=q.get(u);if(M==null)u.remove();else{let b=s.items.indexOf(M);if(b<l||b>c)u.remove(),this.itemToElement.delete(M),q.delete(u),C++}}this.listTop.style.height=String(m)+"px",this.listBottom.style.height=String(p)+"px";let x=[],{idPath:Te}=this.options;for(let u=l;u<=c;u++){let M=s.items[u];if(M===void 0)continue;let b=this.itemToElement.get(h(M));if(b==null){if(y++,b=A(this.template),typeof M==="object")this.itemToElement.set(h(M),b),q.set(b,h(M));if(this.boundElement.insertBefore(b,this.listBottom),Te!=null){let ge=M[Te],vn=`${r}[${Te}=${ge}]`;an(b,vn)}else{let ge=`${r}[${u}]`;an(b,ge)}}x.push(b)}let ie=null;for(let u of x){if(u.previousElementSibling!==ie)if(X++,ie?.nextElementSibling!=null)this.boundElement.insertBefore(u,ie.nextElementSibling);else this.boundElement.insertBefore(u,this.listBottom);ie=u}if(B.perf)console.log(r,"updated",{removed:C,created:y,moved:X})}}var dn=(e,n,o)=>{let t=e[me];if(t===void 0)t=new mn(e,n,o),e[me]=t;return t};var K={value:{toDOM:ln,fromDOM(e){return cn(e)}},text:{toDOM(e,n){e.textContent=n}},enabled:{toDOM(e,n){e.disabled=!n}},disabled:{toDOM(e,n){e.disabled=Boolean(n)}},list:{toDOM(e,n,o){dn(e,n,o).update(n)}}};function g(e){return e.replace(/[A-Z]/g,(n)=>{return`-${n.toLocaleLowerCase()}`})}function fn(e){return e.replace(/-([a-z])/g,(n,o)=>{return o.toLocaleUpperCase()})}var _n=180/Math.PI,qn=Math.PI/180;function w(e,n,o){return o<e?NaN:n<e?e:n>o?o:n}function v(e,n,o,t=!0){if(t)o=w(0,o,1);return o*(n-e)+e}var un={RADIANS_TO_DEGREES:_n,DEGREES_TO_RADIANS:qn,clamp:w,lerp:v};function de(e,n=document.body){let o=getComputedStyle(n);if(e.endsWith(")")&&e.startsWith("var("))e=e.slice(4,-1);return o.getPropertyValue(e).trim()}var Qn=(e,n,o)=>{return(0.299*e+0.587*n+0.114*o)/255},W=(e)=>("00"+Math.round(Number(e)).toString(16)).slice(-2);class pn{h;s;l;constructor(e,n,o){e/=255,n/=255,o/=255;let t=Math.max(e,n,o),r=t-Math.min(e,n,o),s=r!==0?t===e?(n-o)/r:t===n?2+(o-e)/r:4+(e-n)/r:0;this.h=60*s<0?60*s+360:60*s,this.s=r!==0?t<=0.5?r/(2*t-r):r/(2-(2*t-r)):0,this.l=(2*t-r)/2}}var G=globalThis.document!==void 0?globalThis.document.createElement("span"):void 0;class a{r;g;b;a;static fromVar(e,n=document.body){return a.fromCss(de(e,n))}static fromCss(e){let n=e;if(G instanceof HTMLSpanElement)G.style.color="black",G.style.color=e,document.body.appendChild(G),n=getComputedStyle(G).color,G.remove();let[o,t,r,s]=n.match(/[\d.]+/g)||["0","0","0","0"],i=n.startsWith("color(srgb")?255:1;return new a(Number(o)*i,Number(t)*i,Number(r)*i,s==null?1:Number(s))}static fromHsl(e,n,o,t=1){let r,s,i;if(n===0)r=s=i=o;else{let c=(X,y,x)=>{if(x<0)x+=1;if(x>1)x-=1;if(x<0.16666666666666666)return X+(y-X)*6*x;if(x<0.5)return y;if(x<0.6666666666666666)return X+(y-X)*(0.6666666666666666-x)*6;return X},m=o<0.5?o*(1+n):o+n-o*n,p=2*o-m,C=(e%360+360)%360/360;r=c(p,m,C+0.3333333333333333),s=c(p,m,C),i=c(p,m,C-0.3333333333333333)}let l=new a(r*255,s*255,i*255,t);return l.hslCached={h:(e%360+360)%360,s:n,l:o},l}static black=new a(0,0,0);static white=new a(255,255,255);constructor(e,n,o,t=1){this.r=w(0,e,255),this.g=w(0,n,255),this.b=w(0,o,255),this.a=w(0,t,1)}get inverse(){return new a(255-this.r,255-this.g,255-this.b,this.a)}get inverseLuminance(){let{h:e,s:n,l:o}=this._hsl;return a.fromHsl(e,n,1-o,this.a)}get opaque(){return this.a===1?this:new a(this.r,this.g,this.b,1)}contrasting(e=1){return this.opaque.blend(this.brightness>0.5?a.black:a.white,e)}get rgb(){let{r:e,g:n,b:o}=this;return`rgb(${e.toFixed(0)},${n.toFixed(0)},${o.toFixed(0)})`}get rgba(){let{r:e,g:n,b:o,a:t}=this;return`rgba(${e.toFixed(0)},${n.toFixed(0)},${o.toFixed(0)},${t.toFixed(2)})`}get RGBA(){return[this.r/255,this.g/255,this.b/255,this.a]}get ARGB(){return[this.a,this.r/255,this.g/255,this.b/255]}hslCached;get _hsl(){if(this.hslCached==null)this.hslCached=new pn(this.r,this.g,this.b);return this.hslCached}get hsl(){let{h:e,s:n,l:o}=this._hsl;return`hsl(${e.toFixed(0)}deg ${(n*100).toFixed(0)}% ${(o*100).toFixed(0)}%)`}get hsla(){let{h:e,s:n,l:o}=this._hsl;return`hsl(${e.toFixed(0)}deg ${(n*100).toFixed(0)}% ${(o*100).toFixed(0)}% / ${(this.a*100).toFixed(0)}%)`}get mono(){let e=this.brightness*255;return new a(e,e,e)}get brightness(){return Qn(this.r,this.g,this.b)}get html(){return this.toString()}toString(){return this.a===1?"#"+W(this.r)+W(this.g)+W(this.b):"#"+W(this.r)+W(this.g)+W(this.b)+W(Math.floor(255*this.a))}brighten(e){let{h:n,s:o,l:t}=this._hsl,r=w(0,t+e*(1-t),1);return a.fromHsl(n,o,r,this.a)}darken(e){let{h:n,s:o,l:t}=this._hsl,r=w(0,t*(1-e),1);return a.fromHsl(n,o,r,this.a)}saturate(e){let{h:n,s:o,l:t}=this._hsl,r=w(0,o+e*(1-o),1);return a.fromHsl(n,r,t,this.a)}desaturate(e){let{h:n,s:o,l:t}=this._hsl,r=w(0,o*(1-e),1);return a.fromHsl(n,r,t,this.a)}rotate(e){let{h:n,s:o,l:t}=this._hsl,r=(n+360+e)%360;return a.fromHsl(r,o,t,this.a)}opacity(e){let{h:n,s:o,l:t}=this._hsl;return a.fromHsl(n,o,t,e)}swatch(){return console.log(`%c      %c ${this.html}, ${this.rgba}`,`background-color: ${this.html}`,"background-color: transparent"),this}blend(e,n){return new a(v(this.r,e.r,n),v(this.g,e.g,n),v(this.b,e.b,n),v(this.a,e.a,n))}static blendHue(e,n,o){let t=(n-e+720)%360;if(t<180)return e+o*t;else return e-(360-t)*o}mix(e,n){let o=this._hsl,t=e._hsl;return a.fromHsl(o.s===0?t.h:t.s===0?o.h:a.blendHue(o.h,t.h,n),v(o.s,t.s,n),v(o.l,t.l,n),v(this.a,e.a,n))}colorMix(e,n){return a.fromCss(`color-mix(in hsl, ${this.html}, ${e.html} ${(n*100).toFixed(0)}%)`)}}function yn(e,n){let o=f.style(I(n));o.id=e,document.head.append(o)}var Zn=["animation-iteration-count","flex","flex-base","flex-grow","flex-shrink","opacity","order","tab-size","widows","z-index","zoom"],$e=(e,n)=>{if(typeof n==="number"&&!Zn.includes(e))n=`${n}px`;if(e.startsWith("_"))if(e.startsWith("__"))e="--"+e.substring(2),n=`var(${e}-default, ${n})`;else e="--"+e.substring(1);return{prop:e,value:String(n)}},Kn=(e,n,o)=>{if(o===void 0)return"";if(o instanceof a)o=o.html;let t=$e(n,o);return`${e}  ${t.prop}: ${t.value};`},xn=(e,n,o="")=>{let t=g(e);if(typeof n==="object"&&!(n instanceof a)){let r=Object.keys(n).map((s)=>xn(s,n[s],`${o}  `)).join(`
`);return`${o}  ${e} {
${r}
${o}  }`}else return Kn(o,t,n)},I=(e,n="")=>{return Object.keys(e).map((t)=>{let r=e[t];if(typeof r==="string"){if(t==="@import")return`@import url('${r}');`;throw Error("top-level string value only allowed for `@import`")}let s=Object.keys(r).map((i)=>xn(i,r[i])).join(`
`);return`${n}${t} {
${s}
}`}).join(`

`)},hn=(e)=>{console.warn("initVars is deprecated. Just use _ and __ prefixes instead.");let n={};for(let o of Object.keys(e)){let t=e[o],r=g(o);n[`--${r}`]=typeof t==="number"&&t!==0?String(t)+"px":t}return n},En=(e)=>{let n={};for(let o of Object.keys(e)){let t=e[o];if(t instanceof a)n[o]=t.inverseLuminance;else if(typeof t==="string"&&t.match(/^(#[0-9a-fA-F]{3}|rgba?\(|hsla?\()/))n[o]=a.fromCss(t).inverseLuminance}return n},R=new Proxy({},{get(e,n){if(e[n]===void 0){let o="--"+g(n);e[n]=(t)=>`var(${o}, ${t})`}return e[n]}}),fe=new Proxy({},{get(e,n){if(n==="default")return R;if(e[n]==null){n=g(n);let[,o,,t,r,s]=n.match(/^([-\w]*?)((_)?(\d+)(\w?))?$/)||["",n],i=`--${o}`;if(r!=null){let l=t==null?Number(r)/100:-Number(r)/100;switch(s){case"b":{let c=a.fromVar(i);e[n]=l>0?c.brighten(l).rgba:c.darken(-l).rgba}break;case"s":{let c=a.fromVar(i);e[n]=l>0?c.saturate(l).rgba:c.desaturate(-l).rgba}break;case"h":{let c=a.fromVar(i);e[n]=c.rotate(l*100).rgba}break;case"o":{let c=a.fromVar(i);e[n]=c.opacity(l).rgba}break;case"":e[n]=`calc(var(${i}) * ${l})`;break;default:throw console.error(s),Error(`Unrecognized method ${s} for css variable ${i}`)}}else e[n]=`var(${i})`}return e[n]}});var bn="http://www.w3.org/1998/Math/MathML",Tn="http://www.w3.org/2000/svg";var ue={},gn=(e,n,o)=>{let t=$e(g(n),o);if(t.prop.startsWith("--"))e.style.setProperty(t.prop,t.value);else e.style[n]=t.value},Rn=(e)=>{return{toDOM(n,o){gn(n,e,o)}}},wn=(e,n,o)=>{if(n==="style")if(typeof o==="object")for(let t of Object.keys(o))if(S(o[t]))E(e,o[t],Rn(t));else gn(e,t,o[t]);else e.setAttribute("style",o);else if(e[n]!==void 0){let{MathMLElement:t}=globalThis;if(e instanceof SVGElement||t!==void 0&&e instanceof t)e.setAttribute(n,o);else e[n]=o}else{let t=g(n);if(t==="class")o.split(" ").forEach((r)=>{e.classList.add(r)});else if(e[t]!==void 0)e[t]=o;else if(typeof o==="boolean")o?e.setAttribute(t,""):e.removeAttribute(t);else e.setAttribute(t,o)}},Nn=(e)=>{return{toDOM(n,o){wn(n,e,o)}}},eo=(e,n,o)=>{if(n==="apply")o(e);else if(n.match(/^on[A-Z]/)!=null){let t=n.substring(2).toLowerCase();P(e,t,o)}else if(n==="bind")if((typeof o.binding==="string"?K[o.binding]:o.binding)!==void 0&&o.value!==void 0)E(e,o.value,o.binding instanceof Function?{toDOM:o.binding}:o.binding);else throw Error("bad binding");else if(n.match(/^bind[A-Z]/)!=null){let t=n.substring(4,5).toLowerCase()+n.substring(5),r=K[t];if(r!==void 0)E(e,o,r);else throw Error(`${n} is not allowed, bindings.${t} is not defined`)}else if(S(o))E(e,o,Nn(n));else wn(e,n,o)},ze=(e,...n)=>{if(ue[e]===void 0){let[r,s]=e.split("|");if(s===void 0)ue[e]=globalThis.document.createElement(r);else ue[e]=globalThis.document.createElementNS(s,r)}let o=ue[e].cloneNode(),t={};for(let r of n)if(r instanceof Element||r instanceof DocumentFragment||typeof r==="string"||typeof r==="number")if(o instanceof HTMLTemplateElement)o.content.append(r);else o.append(r);else if(S(r))o.append(f.span({bindText:r}));else Object.assign(t,r);for(let r of Object.keys(t)){let s=t[r];eo(o,r,s)}return o},Ae=(...e)=>{let n=globalThis.document.createDocumentFragment();for(let o of e)n.append(o);return n},f=new Proxy({fragment:Ae},{get(e,n){if(n=n.replace(/[A-Z]/g,(o)=>`-${o.toLocaleLowerCase()}`),e[n]===void 0)e[n]=(...o)=>ze(n,...o);return e[n]},set(){throw Error("You may not add new properties to elements")}}),pe=new Proxy({fragment:Ae},{get(e,n){if(e[n]===void 0)e[n]=(...o)=>ze(`${n}|${Tn}`,...o);return e[n]},set(){throw Error("You may not add new properties to elements")}}),ye=new Proxy({fragment:Ae},{get(e,n){if(e[n]===void 0)e[n]=(...o)=>ze(`${n}|${bn}`,...o);return e[n]},set(){throw Error("You may not add new properties to elements")}});var no=["sort","splice","copyWithin","fill","pop","push","reverse","shift","unshift"],Ie={},oo=!0,to=/^\.?([^.[\](),])+(\.[^.[\](),]+|\[\d+\]|\[[^=[\](),]*=[^[\]()]+\])*$/,ro=(e)=>to.test(e),Y=(e="",n="")=>{if(e==="")return n;else if(n.match(/^\d+$/)!==null||n.includes("="))return`${e}[${n}]`;else return`${e}.${n}`},io={string(e){return new String(e)},boolean(e){return new Boolean(e)},bigint(e){return e},symbol(e){return e},number(e){return new Number(e)}},We=Symbol("undefined");function je(e,n){if(e===void 0||e===null)return new Proxy({[We]:e===null?"null":"undefined"},O(n,!0));let o=typeof e;if(o==="object"||o==="function")return e;else return new Proxy(io[typeof e](e),O(n,!0))}var so=()=>new Proxy({},O("^",!0)),O=(e,n)=>({get(o,t){switch(t){case T:case"tosiPath":return e;case z:case"tosiValue":return o[We]?o[We]==="null"?null:void 0:o.valueOf?o.valueOf():o;case Ge:case"tosiObserve":return(i)=>{let l=ve(e,i);return()=>U(l)};case qe:case"tosiOn":return(i,l)=>P(i,l,h(o));case _e:case"tosiBind":return(i,l,c)=>{E(i,e,l,c)};case"tosiBinding":return(i)=>({bind:{value:e,binding:i}});case"tosiListBinding":return(i=({span:c})=>c({bindText:"^"}),l={})=>[{bindList:{value:e,...l}},f.template(i(f,so()))]}if(typeof t==="symbol")return o[t];let r=t,s=r.match(/^([^.[]+)\.(.+)$/)??r.match(/^([^\]]+)(\[.+)/)??r.match(/^(\[[^\]]+\])\.(.+)$/)??r.match(/^(\[[^\]]+\])\[(.+)$/);if(s!==null){let[,i,l]=s,c=Y(e,i),m=J(o,i);return m!==null&&typeof m==="object"?new Proxy(m,O(c,n))[l]:m}if(r.startsWith("[")&&r.endsWith("]"))r=r.substring(1,r.length-1);if(!Array.isArray(o)&&o[r]!==void 0||Array.isArray(o)&&r.includes("=")){let i;if(r.includes("=")){let[l,c]=r.split("=");i=o.find((m)=>`${J(m,l)}`===c)}else i=o[r];if(i instanceof Object){let l=Y(e,r);return new Proxy(i instanceof Function?i.bind(o):i,O(l,n))}else return n?je(i,Y(e,r)):i}else if(Array.isArray(o)){let i=o[r];return typeof i==="function"?(...l)=>{let c=i.apply(o,l);if(no.includes(r))j(e);return c}:typeof i==="object"?new Proxy(i,O(Y(e,r),n)):n?je(i,Y(e,r)):i}else return n?je(o[r],Y(e,r)):o[r]},set(o,t,r){r=h(r);let s=t!==z?Y(e,t):e;if(oo&&!ro(s))throw Error(`setting invalid path ${s}`);if(h(d[s])!==r&&tn(Ie,s,r))j(s);return!0}}),_=(e,n)=>{let o=typeof n==="function"?n:d[n];if(typeof o!=="function")throw Error(`observe expects a function or path to a function, ${n} is neither`);return ve(e,o)},d=new Proxy(Ie,O("",!1)),V=new Proxy(Ie,O("",!0));var{document:N,MutationObserver:Cn}=globalThis,xe=(e,n)=>{let o=k.get(e);if(o==null)return;for(let t of o){let{binding:r,options:s}=t,{path:i}=t,{toDOM:l}=r;if(l!=null){if(i.startsWith("^")){let c=se(e);if(c!=null&&c[T]!=null)i=t.path=`${c[T]}${i.substring(1)}`;else throw console.error(`Cannot resolve relative binding ${i}`,e,"is not part of a list"),Error(`Cannot resolve relative binding ${i}`)}if(n==null||i.startsWith(n))l(e,d[i],s)}}};if(Cn!=null)new Cn((n)=>{n.forEach((o)=>{Array.from(o.addedNodes).forEach((t)=>{if(t instanceof Element)Array.from(t.querySelectorAll(F)).forEach((r)=>xe(r))})})}).observe(N.body,{subtree:!0,childList:!0});_(()=>!0,(e)=>{let n=Array.from(N.querySelectorAll(F));for(let o of n)xe(o,e)});var Xn=(e)=>{let n=e.target.closest(F);while(n!=null){let o=k.get(n);for(let t of o){let{binding:r,path:s}=t,{fromDOM:i}=r;if(i!=null){let l;try{l=i(n,t.options)}catch(c){throw console.error("Cannot get value from",n,"via",t),Error("Cannot obtain value fromDOM")}if(l!=null){let c=d[s];if(c==null)d[s]=l;else{let m=c[T]!=null?c[z]:c,p=l[T]!=null?l[z]:l;if(m!==p)d[s]=p}}}}n=n.parentElement.closest(F)}};if(globalThis.document!=null)N.body.addEventListener("change",Xn,!0),N.body.addEventListener("input",Xn,!0);function E(e,n,o,t){if(e instanceof DocumentFragment)throw Error("bind cannot bind to a DocumentFragment");let r;if(typeof n==="object"&&n[T]===void 0&&t===void 0){let{value:l}=n;r=typeof l==="string"?l:l[T],t=n,delete t.value}else r=typeof n==="string"?n:n[T];if(r==null)throw Error("bind requires a path or object with xin Proxy");let{toDOM:s}=o;e.classList?.add(Ce);let i=k.get(e);if(i==null)i=[],k.set(e,i);if(i.push({path:r,binding:o,options:t}),s!=null&&!r.startsWith("^"))j(r);if(t?.filter&&t?.needle)E(e,t.needle,{toDOM(l,c){console.log({needle:c}),l[me]?.filter(c)}});return e}var Mn=new Set,lo=(e)=>{let n=e?.target.closest(Me),o=!1,t=new Proxy(e,{get(s,i){if(i==="stopPropagation")return()=>{e.stopPropagation(),o=!0};else{let l=s[i];return typeof l==="function"?l.bind(s):l}}}),r=new Set;while(!o&&n!=null){let i=$.get(n)[e.type]||r;for(let l of i){if(typeof l==="function")l(t);else{let c=d[l];if(typeof c==="function")c(t);else throw Error(`no event handler found at path ${l}`)}if(o)continue}n=n.parentElement!=null?n.parentElement.closest(Me):null}};function P(e,n,o){let t=$.get(e);if(e.classList.add(Xe),t==null)t={},$.set(e,t);if(!t[n])t[n]=new Set;if(t[n].add(o),!Mn.has(n))Mn.add(n),N.body.addEventListener(n,lo,!0);return()=>{t[n].delete(o)}}var co=0;function Ye(){return`custom-elt${(co++).toString(36)}`}var Sn=0,ee={};function ao(e,n){let o=ee[e],t=I(n).replace(/:host\b/g,e);ee[e]=o?o+`
`+t:t}function mo(e){if(ee[e])document.head.append(f.style({id:e+"-component"},ee[e]));delete ee[e]}class D extends HTMLElement{static elements=f;static _elementCreator;instanceId;styleNode;static styleSpec;static styleNode;content=f.slot();isSlotted;static _tagName=null;static get tagName(){return this._tagName}static StyleNode(e){return console.warn("StyleNode is deprecated, just assign static styleSpec: XinStyleSheet to the class directly"),f.style(I(e))}static elementCreator(e={}){let n=this;if(n._elementCreator==null){let{tag:o,styleSpec:t}=e,r=e!=null?o:null;if(r==null)if(typeof n.name==="string"&&n.name!==""){if(r=g(n.name),r.startsWith("-"))r=r.slice(1)}else r=Ye();if(customElements.get(r)!=null)console.warn(`${r} is already defined`);if(r.match(/\w+(-\w+)+/)==null)console.warn(`${r} is not a legal tag for a custom-element`),r=Ye();while(customElements.get(r)!==void 0)r=Ye();if(n._tagName=r,t!==void 0)ao(r,t);window.customElements.define(r,this,e),n._elementCreator=f[r]}return n._elementCreator}initAttributes(...e){let n={},o={};new MutationObserver((r)=>{let s=!1;if(r.forEach((i)=>{s=!!(i.attributeName&&e.includes(fn(i.attributeName)))}),s&&this.queueRender!==void 0)this.queueRender(!1)}).observe(this,{attributes:!0}),e.forEach((r)=>{n[r]=L(this[r]);let s=g(r);Object.defineProperty(this,r,{enumerable:!1,get(){if(typeof n[r]==="boolean")return this.hasAttribute(s);else if(this.hasAttribute(s))return typeof n[r]==="number"?parseFloat(this.getAttribute(s)):this.getAttribute(s);else if(o[r]!==void 0)return o[r];else return n[r]},set(i){if(typeof n[r]==="boolean"){if(i!==this[r]){if(i)this.setAttribute(s,"");else this.removeAttribute(s);this.queueRender()}}else if(typeof n[r]==="number"){if(i!==parseFloat(this[r]))this.setAttribute(s,i),this.queueRender()}else if(typeof i==="object"||`${i}`!==`${this[r]}`){if(i===null||i===void 0||typeof i==="object")this.removeAttribute(s);else this.setAttribute(s,i);this.queueRender(),o[r]=i}}})})}initValue(){let e=Object.getOwnPropertyDescriptor(this,"value");if(e===void 0||e.get!==void 0||e.set!==void 0)return;let n=this.hasAttribute("value")?this.getAttribute("value"):L(this.value);delete this.value,Object.defineProperty(this,"value",{enumerable:!1,get(){return n},set(o){if(n!==o)n=o,this.queueRender(!0)}})}_parts;get parts(){let e=this.shadowRoot!=null?this.shadowRoot:this;if(this._parts==null)this._parts=new Proxy({},{get(n,o){if(n[o]===void 0){let t=e.querySelector(`[part="${o}"]`);if(t==null)t=e.querySelector(o);if(t==null)throw Error(`elementRef "${o}" does not exist!`);t.removeAttribute("data-ref"),n[o]=t}return n[o]}});return this._parts}constructor(){super();Sn+=1,this.initAttributes("hidden"),this.instanceId=`${this.tagName.toLocaleLowerCase()}-${Sn}`,this._value=L(this.defaultValue)}connectedCallback(){if(mo(this.constructor.tagName),this.hydrate(),this.role!=null)this.setAttribute("role",this.role);if(this.onResize!==void 0){if(Q.observe(this),this._onResize==null)this._onResize=this.onResize.bind(this);this.addEventListener("resize",this._onResize)}if(this.value!=null&&this.getAttribute("value")!=null)this._value=this.getAttribute("value");this.queueRender()}disconnectedCallback(){Q.unobserve(this)}_changeQueued=!1;_renderQueued=!1;queueRender(e=!1){if(!this._hydrated)return;if(!this._changeQueued)this._changeQueued=e;if(!this._renderQueued)this._renderQueued=!0,requestAnimationFrame(()=>{if(this._changeQueued)Pe(this,"change");this._changeQueued=!1,this._renderQueued=!1,this.render()})}_hydrated=!1;hydrate(){if(!this._hydrated){this.initValue();let e=typeof this.content!=="function",n=typeof this.content==="function"?this.content(f):this.content,{styleSpec:o}=this.constructor,{styleNode:t}=this.constructor;if(o)t=this.constructor.styleNode=f.style(I(o)),delete this.constructor.styleNode;if(this.styleNode)console.warn(this,"styleNode is deprecrated, use static styleNode or statc styleSpec instead"),t=this.styleNode;if(t){let r=this.attachShadow({mode:"open"});r.appendChild(t.cloneNode(!0)),Oe(r,n,e)}else if(n!==null){let r=Array.from(this.childNodes);Oe(this,n,e),this.isSlotted=this.querySelector("slot,xin-slot")!==void 0;let s=Array.from(this.querySelectorAll("slot"));if(s.length>0)s.forEach(Ve.replaceSlot);if(r.length>0){let i={"":this};Array.from(this.querySelectorAll("xin-slot")).forEach((l)=>{i[l.name]=l}),r.forEach((l)=>{let c=i[""],m=l instanceof Element?i[l.slot]:c;(m!==void 0?m:c).append(l)})}}this._hydrated=!0}}render(){}}class Ve extends D{name="";content=null;static replaceSlot(e){let n=document.createElement("xin-slot");if(e.name!=="")n.setAttribute("name",e.name);e.replaceWith(n)}constructor(){super();this.initAttributes("name")}}var Mt=Ve.elementCreator({tag:"xin-slot"});var Ln=(e=()=>!0)=>{let n=localStorage.getItem("xin-state");if(n!=null){let t=JSON.parse(n);for(let r of Object.keys(t).filter(e))if(d[r]!==void 0)Object.assign(d[r],t[r]);else d[r]=t[r]}let o=ae(()=>{let t={},r=h(d);for(let s of Object.keys(r).filter(e))t[s]=r[s];localStorage.setItem("xin-state",JSON.stringify(t)),console.log("xin state saved to localStorage")},500);_(e,o)};var he="1.0.10";function ne(e){return Object.assign(V,e),V}function oe(e){return console.warn("boxedProxy is deprecated, please use tosi() instead"),ne(e)}function Ee(e,n=!1){if(n)return console.warn("xinProxy(..., true) is deprecated; use tosi(...) instead"),oe(e);return Object.keys(e).forEach((o)=>{d[o]=e[o]}),d}var fo={};async function te(e,n){let{type:o,styleSpec:t}=await n(e,{Color:a,Component:D,elements:f,svgElements:pe,mathML:ye,varDefault:R,vars:fe,xin:d,boxed:V,xinProxy:Ee,boxedProxy:oe,tosi:ne,makeComponent:te,bind:E,on:P,version:he}),r={type:o,creator:o.elementCreator({tag:e,styleSpec:t})};return fo[e]=r,r}var Ue={},uo=(e)=>import(e);class re extends D{tag="anon-elt";src="";property="default";loaded;blueprintLoaded=(e)=>{};async packaged(){let{tag:e,src:n,property:o}=this,t=`${e}.${o}:${n}`;if(!this.loaded){if(Ue[t]===void 0)Ue[t]=uo(n).then((r)=>{let s=r[o];return te(e,s)});else console.log(`using cached ${e} with signature ${t}`);this.loaded=await Ue[t],this.blueprintLoaded(this.loaded)}return this.loaded}constructor(){super();this.initAttributes("tag","src","property")}}var kn=re.elementCreator({tag:"xin-blueprint",styleSpec:{":host":{display:"none"}}});class be extends D{allLoaded=()=>{};constructor(){super()}async load(){let n=Array.from(this.querySelectorAll(re.tagName)).filter((o)=>o.src).map((o)=>o.packaged());await Promise.all(n),this.allLoaded()}connectedCallback(){super.connectedCallback(),this.load()}}var Hn=be.elementCreator({tag:"xin-loader",styleSpec:{":host":{display:"none"}}});})();

//# debugId=D2776F89087CB7F864756E2164756E21
//# sourceMappingURL=index.js.map
