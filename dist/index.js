(()=>{var{defineProperty:Sn,getOwnPropertyNames:Zo,getOwnPropertyDescriptor:Jo}=Object,Uo=Object.prototype.hasOwnProperty;var Pn=new WeakMap,Go=(n)=>{var o=Pn.get(n),c;if(o)return o;if(o=Sn({},"__esModule",{value:!0}),n&&typeof n==="object"||typeof n==="function")Zo(n).map((r)=>!Uo.call(o,r)&&Sn(o,r,{get:()=>n[r],enumerable:!(c=Jo(n,r))||c.enumerable}));return Pn.set(n,o),o};var Qo=(n,o)=>{for(var c in o)Sn(n,c,{get:o[c],enumerable:!0,configurable:!0,set:(r)=>o[c]=()=>r})};var Ec={};Qo(Ec,{xinValue:()=>$,xinProxy:()=>On,xinPath:()=>k,xin:()=>s,version:()=>$n,vars:()=>Fn,varDefault:()=>e,updates:()=>Zn,unobserve:()=>P,touch:()=>K,throttle:()=>yn,svgElements:()=>Tn,settings:()=>U,on:()=>xn,observe:()=>N,mathML:()=>Mn,makeComponent:()=>a,invertLuminance:()=>So,initVars:()=>Lo,hotReload:()=>Ao,getListItem:()=>rn,elements:()=>F,debounce:()=>En,darkMode:()=>Ho,css:()=>_,boxedProxy:()=>t,boxed:()=>I,blueprintLoader:()=>ko,blueprint:()=>Wo,bindings:()=>v,bind:()=>Z,StyleSheet:()=>Oo,MoreMath:()=>so,Component:()=>J,Color:()=>y,BlueprintLoader:()=>Dn,Blueprint:()=>nn});var U={debug:!1,perf:!1};function B(n){if(n==null||typeof n!=="object")return n;if(Array.isArray(n))return n.map(B);let o={};for(let c in n){let r=n[c];if(n!=null&&typeof n==="object")o[c]=B(r);else o[c]=r}return o}var Cn="-xin-data",G=`.${Cn}`,An="-xin-event",Bn=`.${An}`,D="xinPath",q="xinValue",un="xinObserve",dn="xinBind",k=(n)=>{return n[D]};function $(n){return typeof n==="object"&&n!==null?n[q]||n:n}var Y=new WeakMap,W=new WeakMap;var w=(n)=>{let o=n.cloneNode();if(o instanceof Element){let c=W.get(n),r=Y.get(n);if(c!=null)W.set(o,B(c));if(r!=null)Y.set(o,B(r))}for(let c of n instanceof HTMLTemplateElement?n.content.childNodes:n.childNodes)if(c instanceof Element||c instanceof DocumentFragment)o.appendChild(w(c));else o.appendChild(c.cloneNode());return o},p=new WeakMap,rn=(n)=>{let o=document.body.parentElement;while(n.parentElement!=null&&n.parentElement!==o){let c=p.get(n);if(c!=null)return c;n=n.parentElement}return!1};var Nn=Symbol("observer should be removed"),fn=[],Xn=[],Wn=!1,kn,zn;class pn{description;test;callback;constructor(n,o){let c=typeof o==="string"?`"${o}"`:`function ${o.name}`,r;if(typeof n==="string")this.test=(f)=>typeof f==="string"&&f!==""&&(n.startsWith(f)||f.startsWith(n)),r=`test = "${n}"`;else if(n instanceof RegExp)this.test=n.test.bind(n),r=`test = "${n.toString()}"`;else if(n instanceof Function)this.test=n,r=`test = function ${n.name}`;else throw new Error("expect listener test to be a string, RegExp, or test function");if(this.description=`${r}, ${c}`,typeof o==="function")this.callback=o;else throw new Error("expect callback to be a path or function");fn.push(this)}}var Zn=async()=>{if(kn===void 0)return;await kn},Yo=()=>{if(U.perf)console.time("xin async update");let n=Array.from(Xn);for(let o of n)fn.filter((c)=>{let r;try{r=c.test(o)}catch(f){throw new Error(`Listener ${c.description} threw "${f}" at "${o}"`)}if(r===Nn)return P(c),!1;return r}).forEach((c)=>{let r;try{r=c.callback(o)}catch(f){console.error(`Listener ${c.description} threw "${f}" handling "${o}"`)}if(r===Nn)P(c)});if(Xn.splice(0),Wn=!1,typeof zn==="function")zn();if(U.perf)console.timeEnd("xin async update")},K=(n)=>{let o=typeof n==="string"?n:k(n);if(o===void 0)throw console.error("touch was called on an invalid target",n),new Error("touch was called on an invalid target");if(Wn===!1)kn=new Promise((c)=>{zn=c}),Wn=setTimeout(Yo);if(Xn.find((c)=>o.startsWith(c))==null)Xn.push(o)},Jn=(n,o)=>{return new pn(n,o)},P=(n)=>{let o=fn.indexOf(n);if(o>-1)fn.splice(o,1);else throw new Error("unobserve failed, listener not found")};var qo=(n)=>{try{return JSON.stringify(n)}catch(o){return"{has circular references}"}},Un=(...n)=>new Error(n.map(qo).join(" "));var wo=()=>new Date(parseInt("1000000000",36)+Date.now()).valueOf().toString(36).slice(1),Ko=0,Ro=()=>(parseInt("10000",36)+ ++Ko).toString(36).slice(-5),Io=()=>wo()+Ro(),Gn={},vn={};function hn(n){if(n==="")return[];if(Array.isArray(n))return n;else{let o=[];while(n.length>0){let c=n.search(/\[[^\]]+\]/);if(c===-1){o.push(n.split("."));break}else{let r=n.slice(0,c);if(n=n.slice(c),r!=="")o.push(r.split("."));if(c=n.indexOf("]")+1,o.push(n.slice(1,c-1)),n.slice(c,c+1)===".")c+=1;n=n.slice(c)}}return o}}var z=new WeakMap;function en(n,o){if(z.get(n)===void 0)z.set(n,{});if(z.get(n)[o]===void 0)z.get(n)[o]={};let c=z.get(n)[o];if(o==="_auto_")n.forEach((r,f)=>{if(r._auto_===void 0)r._auto_=Io();c[r._auto_+""]=f});else n.forEach((r,f)=>{c[u(r,o)+""]=f});return c}function Vo(n,o){if(z.get(n)===void 0||z.get(n)[o]===void 0)return en(n,o);else return z.get(n)[o]}function _o(n,o,c){c=c+"";let r=Vo(n,o)[c];if(r===void 0||u(n[r],o)+""!==c)r=en(n,o)[c];return r}function jo(n,o,c){if(n[o]===void 0&&c!==void 0)n[o]=c;return n[o]}function ln(n,o,c,r){let f=o!==""?_o(n,o,c):c;if(r===Gn)return n.splice(f,1),z.delete(n),Symbol("deleted");else if(r===vn){if(o===""&&n[f]===void 0)n[f]={}}else if(r!==void 0)if(f!==void 0)n[f]=r;else if(o!==""&&u(r,o)+""===c+"")n.push(r),f=n.length-1;else throw new Error(`byIdPath insert failed at [${o}=${c}]`);return n[f]}function gn(n){if(!Array.isArray(n))throw Un("setByPath failed: expected array, found",n)}function bn(n){if(n==null||!(n instanceof Object))throw Un("setByPath failed: expected Object, found",n)}function u(n,o){let c=hn(o),r=n,f,x,X,E;for(f=0,x=c.length;r!==void 0&&f<x;f++){let i=c[f];if(Array.isArray(i))for(X=0,E=i.length;r!==void 0&&X<E;X++){let T=i[X];r=r[T]}else if(r.length===0){if(r=r[i.slice(1)],i[0]!=="=")return}else if(i.includes("=")){let[T,...H]=i.split("=");r=ln(r,T,H.join("="))}else X=parseInt(i,10),r=r[X]}return r}function tn(n,o,c){let r=n,f=hn(o);while(r!=null&&f.length>0){let x=f.shift();if(typeof x==="string"){let X=x.indexOf("=");if(X>-1){if(X===0)bn(r);else gn(r);let E=x.slice(0,X),i=x.slice(X+1);if(r=ln(r,E,i,f.length>0?vn:c),f.length===0)return!0}else{gn(r);let E=parseInt(x,10);if(f.length>0)r=r[E];else{if(c!==Gn){if(r[E]===c)return!1;r[E]=c}else r.splice(E,1);return!0}}}else if(Array.isArray(x)&&x.length>0){bn(r);while(x.length>0){let X=x.shift();if(x.length>0||f.length>0)r=jo(r,X,x.length>0?{}:[]);else{if(c!==Gn){if(r[X]===c)return!1;r[X]=c}else{if(!Object.prototype.hasOwnProperty.call(r,X))return!1;delete r[X]}return!0}}}else throw new Error(`setByPath failed, bad path ${o}`)}throw new Error(`setByPath(${n}, ${o}, ${c}) failed`)}var mo=["sort","splice","copyWithin","fill","pop","push","reverse","shift","unshift"],Yn={},Po=!0,uo=/^\.?([^.[\](),])+(\.[^.[\](),]+|\[\d+\]|\[[^=[\](),]*=[^[\]()]+\])*$/,No=(n)=>uo.test(n),R=(n="",o="")=>{if(n==="")return o;else if(o.match(/^\d+$/)!==null||o.includes("="))return`${n}[${o}]`;else return`${n}.${o}`},po={string(n){return new String(n)},boolean(n){return new Boolean(n)},bigint(n){return n},symbol(n){return n},number(n){return new Number(n)}};function Qn(n,o){let c=typeof n;if(n===void 0||c==="object"||c==="function")return n;else return new Proxy(po[typeof n](n),d(o,!0))}var d=(n,o)=>({get(c,r){switch(r){case D:return n;case q:return $(c);case un:return(X)=>{let E=Jn(n,X);return()=>P(E)};case dn:return(X,E,i)=>{Z(X,n,E,i)}}if(typeof r==="symbol")return c[r];let f=r,x=f.match(/^([^.[]+)\.(.+)$/)??f.match(/^([^\]]+)(\[.+)/)??f.match(/^(\[[^\]]+\])\.(.+)$/)??f.match(/^(\[[^\]]+\])\[(.+)$/);if(x!==null){let[,X,E]=x,i=R(n,X),T=u(c,X);return T!==null&&typeof T==="object"?new Proxy(T,d(i,o))[E]:T}if(f.startsWith("[")&&f.endsWith("]"))f=f.substring(1,f.length-1);if(!Array.isArray(c)&&c[f]!==void 0||Array.isArray(c)&&f.includes("=")){let X;if(f.includes("=")){let[E,i]=f.split("=");X=c.find((T)=>`${u(T,E)}`===i)}else X=c[f];if(X!==null&&typeof X==="object"){let E=R(n,f);return new Proxy(X,d(E,o))}else if(typeof X==="function")return X.bind(c);else return o?Qn(X,R(n,f)):X}else if(Array.isArray(c)){let X=c[f];return typeof X==="function"?(...E)=>{let i=X.apply(c,E);if(mo.includes(f))K(n);return i}:typeof X==="object"?new Proxy(X,d(R(n,f),o)):o?Qn(X,R(n,f)):X}else return o?Qn(c[f],R(n,f)):c[f]},set(c,r,f){f=$(f);let x=r!==q?R(n,r):n;if(Po&&!No(x))throw new Error(`setting invalid path ${x}`);if($(s[x])!==f&&tn(Yn,x,f))K(x);return!0}}),N=(n,o)=>{let c=typeof o==="function"?o:s[o];if(typeof c!=="function")throw new Error(`observe expects a function or path to a function, ${o} is neither`);return Jn(n,c)},s=new Proxy(Yn,d("",!1)),I=new Proxy(Yn,d("",!0));var{document:g,MutationObserver:an}=globalThis,co=(n,o)=>{let c=W.get(n);if(c==null)return;for(let r of c){let{binding:f,options:x}=r,{path:X}=r,{toDOM:E}=f;if(E!=null){if(X.startsWith("^")){let i=rn(n);if(i!=null&&i[D]!=null)X=r.path=`${i[D]}${X.substring(1)}`;else throw console.error(`Cannot resolve relative binding ${X}`,n,"is not part of a list"),new Error(`Cannot resolve relative binding ${X}`)}if(o==null||X.startsWith(o))E(n,s[X],x)}}};if(an!=null)new an((o)=>{o.forEach((c)=>{Array.from(c.addedNodes).forEach((r)=>{if(r instanceof Element)Array.from(r.querySelectorAll(G)).forEach((f)=>co(f))})})}).observe(g.body,{subtree:!0,childList:!0});N(()=>!0,(n)=>{let o=Array.from(g.querySelectorAll(G));for(let c of o)co(c,n)});var no=(n)=>{let o=n.target.closest(G);while(o!=null){let c=W.get(o);for(let r of c){let{binding:f,path:x}=r,{fromDOM:X}=f;if(X!=null){let E;try{E=X(o,r.options)}catch(i){throw console.error("Cannot get value from",o,"via",r),new Error("Cannot obtain value fromDOM")}if(E!=null){let i=s[x];if(i==null)s[x]=E;else{let T=i[D]!=null?i[q]:i,H=E[D]!=null?E[q]:E;if(T!==H)s[x]=H}}}}o=o.parentElement.closest(G)}};if(globalThis.document!=null)g.body.addEventListener("change",no,!0),g.body.addEventListener("input",no,!0);function Z(n,o,c,r){if(n instanceof DocumentFragment)throw new Error("bind cannot bind to a DocumentFragment");let f;if(typeof o==="object"&&o[D]===void 0&&r===void 0){let{value:E}=o;f=typeof E==="string"?E:E[D],r=o,delete r.value}else f=typeof o==="string"?o:o[D];if(f==null)throw new Error("bind requires a path or object with xin Proxy");let{toDOM:x}=c;n.classList?.add(Cn);let X=W.get(n);if(X==null)X=[],W.set(n,X);if(X.push({path:f,binding:c,options:r}),x!=null&&!f.startsWith("^"))K(f);return n}var oo=new Set,go=(n)=>{let o=n?.target.closest(Bn),c=!1,r=new Proxy(n,{get(f,x){if(x==="stopPropagation")return()=>{n.stopPropagation(),c=!0};else{let X=f[x];return typeof X==="function"?X.bind(f):X}}});while(!c&&o!=null){let x=Y.get(o)[n.type]||[];for(let X of x){if(typeof X==="function")X(r);else{let E=s[X];if(typeof E==="function")E(r);else throw new Error(`no event handler found at path ${X}`)}if(c)continue}o=o.parentElement!=null?o.parentElement.closest(Bn):null}},xn=(n,o,c)=>{let r=Y.get(n);if(n.classList.add(An),r==null)r={},Y.set(n,r);if(!r[o])r[o]=[];if(!r[o].includes(c))r[o].push(c);if(!oo.has(o))oo.add(o),g.body.addEventListener(o,go,!0)};var qn=(n,o)=>{let c=new Event(o);n.dispatchEvent(c)},fo=(n)=>{if(n instanceof HTMLInputElement)return n.type;else if(n instanceof HTMLSelectElement&&n.hasAttribute("multiple"))return"multi-select";else return"other"},wn=(n,o)=>{switch(fo(n)){case"radio":n.checked=n.value===o;break;case"checkbox":n.checked=!!o;break;case"date":n.valueAsDate=new Date(o);break;case"multi-select":for(let c of Array.from(n.querySelectorAll("option")))c.selected=o[c.value];break;default:n.value=o}},Xo=(n)=>{switch(fo(n)){case"radio":{let o=n.parentElement?.querySelector(`[name="${n.name}"]:checked`);return o!=null?o.value:null}case"checkbox":return n.checked;case"date":return n.valueAsDate?.toISOString();case"multi-select":return Array.from(n.querySelectorAll("option")).reduce((o,c)=>{return o[c.value]=c.selected,o},{});default:return n.value}},{ResizeObserver:ro}=globalThis,b=ro!=null?new ro((n)=>{for(let o of n){let c=o.target;qn(c,"resize")}}):{observe(){},unobserve(){}},Kn=(n,o,c=!0)=>{if(n!=null&&o!=null)if(typeof o==="string")n.textContent=o;else if(Array.isArray(o))o.forEach((r)=>{n.append(r instanceof Node&&c?w(r):r)});else if(o instanceof Node)n.append(c?w(o):o);else throw new Error("expect text content or document node")};var En=(n,o=250)=>{let c;return(...r)=>{if(c!==void 0)clearTimeout(c);c=setTimeout(()=>{n(...r)},o)}},yn=(n,o=250)=>{let c,r=Date.now()-o,f=!1;return(...x)=>{if(clearTimeout(c),c=setTimeout(async()=>{n(...x),r=Date.now()},o),!f&&Date.now()-r>=o){f=!0;try{n(...x),r=Date.now()}finally{f=!1}}}};var xo=Symbol("list-binding"),bo=16;function Eo(n,o){let c=Array.from(n.querySelectorAll(G));if(n.matches(G))c.unshift(n);for(let r of c){let f=W.get(r);for(let x of f){if(x.path.startsWith("^"))x.path=`${o}${x.path.substring(1)}`;if(x.binding.toDOM!=null)x.binding.toDOM(r,s[x.path])}}}class io{boundElement;listTop;listBottom;template;options;itemToElement;_array=[];_update;_previousSlice;constructor(n,o={}){if(this.boundElement=n,this.itemToElement=new WeakMap,n.children.length!==1)throw new Error("ListBinding expects an element with exactly one child element");if(n.children[0]instanceof HTMLTemplateElement){let c=n.children[0];if(c.content.children.length!==1)throw new Error("ListBinding expects a template with exactly one child element");this.template=w(c.content.children[0])}else this.template=n.children[0],this.template.remove();if(this.listTop=document.createElement("div"),this.listBottom=document.createElement("div"),this.boundElement.append(this.listTop),this.boundElement.append(this.listBottom),this.options=o,o.virtual!=null)b.observe(this.boundElement),this._update=yn(()=>{this.update(this._array,!0)},bo),this.boundElement.addEventListener("scroll",this._update),this.boundElement.addEventListener("resize",this._update)}visibleSlice(){let{virtual:n,hiddenProp:o,visibleProp:c}=this.options,r=this._array;if(o!==void 0)r=r.filter((i)=>i[o]!==!0);if(c!==void 0)r=r.filter((i)=>i[c]===!0);let f=0,x=r.length-1,X=0,E=0;if(n!=null&&this.boundElement instanceof HTMLElement){let i=this.boundElement.offsetWidth,T=this.boundElement.offsetHeight,H=n.width!=null?Math.max(1,Math.floor(i/n.width)):1,j=Math.ceil(T/n.height)+1,m=Math.ceil(r.length/H),on=H*j,Q=Math.floor(this.boundElement.scrollTop/n.height);if(Q>m-j+1)Q=Math.max(0,m-j+1);f=Q*H,x=f+on-1,X=Q*n.height,E=Math.max(m*n.height-T-X,0)}return{items:r,firstItem:f,lastItem:x,topBuffer:X,bottomBuffer:E}}update(n,o){if(n==null)n=[];this._array=n;let{hiddenProp:c,visibleProp:r}=this.options,f=k(n),x=this.visibleSlice();this.boundElement.classList.toggle("-xin-empty-list",x.items.length===0);let X=this._previousSlice,{firstItem:E,lastItem:i,topBuffer:T,bottomBuffer:H}=x;if(c===void 0&&r===void 0&&o===!0&&X!=null&&E===X.firstItem&&i===X.lastItem)return;this._previousSlice=x;let j=0,m=0,on=0;for(let M of Array.from(this.boundElement.children)){if(M===this.listTop||M===this.listBottom)continue;let S=p.get(M);if(S==null)M.remove();else{let O=x.items.indexOf(S);if(O<E||O>i)M.remove(),this.itemToElement.delete(S),p.delete(M),j++}}this.listTop.style.height=String(T)+"px",this.listBottom.style.height=String(H)+"px";let Q=[],{idPath:Ln}=this.options;for(let M=E;M<=i;M++){let S=x.items[M];if(S===void 0)continue;let O=this.itemToElement.get($(S));if(O==null){if(on++,O=w(this.template),typeof S==="object")this.itemToElement.set($(S),O),p.set(O,$(S));if(this.boundElement.insertBefore(O,this.listBottom),Ln!=null){let Hn=S[Ln],zo=`${f}[${Ln}=${Hn}]`;Eo(O,zo)}else{let Hn=`${f}[${M}]`;Eo(O,Hn)}}Q.push(O)}let cn=null;for(let M of Q){if(M.previousElementSibling!==cn)if(m++,cn?.nextElementSibling!=null)this.boundElement.insertBefore(M,cn.nextElementSibling);else this.boundElement.insertBefore(M,this.listBottom);cn=M}if(U.perf)console.log(f,"updated",{removed:j,created:on,moved:m})}}var yo=(n,o)=>{let c=n[xo];if(c===void 0)c=new io(n,o),n[xo]=c;return c};var v={value:{toDOM:wn,fromDOM(n){return Xo(n)}},set:{toDOM:wn},text:{toDOM(n,o){n.textContent=o}},enabled:{toDOM(n,o){n.disabled=!o}},disabled:{toDOM(n,o){n.disabled=Boolean(o)}},style:{toDOM(n,o){}},callback:{toDOM(n,o,c){if(c?.callback)c.callback(n,o);else if(o instanceof Function)o(n)}},list:{toDOM(n,o,c){yo(n,c).update(o)}}};var Nc=180/Math.PI,pc=Math.PI/180;function L(n,o,c){return o<n?n:o>c?c:o}function C(n,o,c){return c=L(0,c,1),c*(o-n)+n}var so={clamp:L,lerp:C};var vo=(n,o,c)=>{return(0.299*n+0.587*o+0.114*c)/255},V=(n)=>("00"+Math.round(Number(n)).toString(16)).slice(-2);class To{h;s;l;constructor(n,o,c){n/=255,o/=255,c/=255;let r=Math.max(n,o,c),f=r-Math.min(n,o,c),x=f!==0?r===n?(o-c)/f:r===o?2+(c-n)/f:4+(n-o)/f:0;this.h=60*x<0?60*x+360:60*x,this.s=f!==0?r<=0.5?f/(2*r-f):f/(2-(2*r-f)):0,this.l=(2*r-f)/2}}var h=globalThis.document!==void 0?globalThis.document.createElement("span"):void 0;class y{r;g;b;a;static fromCss(n){let o=n;if(h instanceof HTMLSpanElement)h.style.color=n,document.body.appendChild(h),o=getComputedStyle(h).color,h.remove();let[c,r,f,x]=o.match(/[\d.]+/g);return new y(Number(c),Number(r),Number(f),x==null?1:Number(x))}static fromHsl(n,o,c,r=1){return y.fromCss(`hsla(${n.toFixed(0)}, ${(o*100).toFixed(0)}%, ${(c*100).toFixed(0)}%, ${r.toFixed(2)})`)}constructor(n,o,c,r=1){this.r=L(0,n,255),this.g=L(0,o,255),this.b=L(0,c,255),this.a=r!==void 0?L(0,r,1):r=1}get inverse(){return new y(255-this.r,255-this.g,255-this.b,this.a)}get inverseLuminance(){let{h:n,s:o,l:c}=this._hsl;return y.fromHsl(n,o,1-c,this.a)}get rgb(){let{r:n,g:o,b:c}=this;return`rgb(${n.toFixed(0)},${o.toFixed(0)},${c.toFixed(0)})`}get rgba(){let{r:n,g:o,b:c,a:r}=this;return`rgba(${n.toFixed(0)},${o.toFixed(0)},${c.toFixed(0)},${r.toFixed(2)})`}get RGBA(){return[this.r/255,this.g/255,this.b/255,this.a]}get ARGB(){return[this.a,this.r/255,this.g/255,this.b/255]}hslCached;get _hsl(){if(this.hslCached==null)this.hslCached=new To(this.r,this.g,this.b);return this.hslCached}get hsl(){let{h:n,s:o,l:c}=this._hsl;return`hsl(${n.toFixed(0)}, ${(o*100).toFixed(0)}%, ${(c*100).toFixed(0)}%)`}get hsla(){let{h:n,s:o,l:c}=this._hsl;return`hsla(${n.toFixed(0)}, ${(o*100).toFixed(0)}%, ${(c*100).toFixed(0)}%, ${this.a.toFixed(2)})`}get mono(){let n=this.brightness*255;return new y(n,n,n)}get brightness(){return vo(this.r,this.g,this.b)}get html(){return this.toString()}toString(){return this.a===1?"#"+V(this.r)+V(this.g)+V(this.b):"#"+V(this.r)+V(this.g)+V(this.b)+V(Math.floor(255*this.a))}brighten(n){let{h:o,s:c,l:r}=this._hsl,f=L(0,r+n*(1-r),1);return y.fromHsl(o,c,f,this.a)}darken(n){let{h:o,s:c,l:r}=this._hsl,f=L(0,r*(1-n),1);return y.fromHsl(o,c,f,this.a)}saturate(n){let{h:o,s:c,l:r}=this._hsl,f=L(0,c+n*(1-c),1);return y.fromHsl(o,f,r,this.a)}desaturate(n){let{h:o,s:c,l:r}=this._hsl,f=L(0,c*(1-n),1);return y.fromHsl(o,f,r,this.a)}rotate(n){let{h:o,s:c,l:r}=this._hsl,f=(o+360+n)%360;return y.fromHsl(f,c,r,this.a)}opacity(n){let{h:o,s:c,l:r}=this._hsl;return y.fromHsl(o,c,r,n)}swatch(){let{r:n,g:o,b:c,a:r}=this;return console.log(`%c      %c ${this.html}, rgba(${n}, ${o}, ${c}, ${r}), ${this.hsla}`,`background-color: rgba(${n}, ${o}, ${c}, ${r})`,"background-color: transparent"),this}blend(n,o){return new y(C(this.r,n.r,o),C(this.g,n.g,o),C(this.b,n.b,o),C(this.a,n.a,o))}mix(n,o){let c=this._hsl,r=n._hsl;return y.fromHsl(C(c.h,r.h,o),C(c.s,r.s,o),C(c.l,r.l,o),C(this.a,n.a,o))}}function A(n){return n.replace(/[A-Z]/g,(o)=>{return`-${o.toLocaleLowerCase()}`})}function Mo(n){return n.replace(/-([a-z])/g,(o,c)=>{return c.toLocaleUpperCase()})}var ho="http://www.w3.org/1998/Math/MathML",eo="http://www.w3.org/2000/svg",sn={},Fo=(n,o,c)=>{let r=Vn(A(o),c);if(r.prop.startsWith("--"))n.style.setProperty(r.prop,r.value);else n.style[o]=r.value},lo=(n)=>{return{toDOM(o,c){Fo(o,n,c)}}},$o=(n,o,c)=>{if(o==="style")if(typeof c==="object")for(let r of Object.keys(c))if(k(c[r]))console.log(r,c[r]),Z(n,c[r],lo(r));else Fo(n,r,c[r]);else n.setAttribute("style",c);else if(n[o]!==void 0){let{MathMLElement:r}=globalThis;if(n instanceof SVGElement||r!==void 0&&n instanceof r)n.setAttribute(o,c);else n[o]=c}else{let r=A(o);if(r==="class")c.split(" ").forEach((f)=>{n.classList.add(f)});else if(n[r]!==void 0)n[r]=c;else if(typeof c==="boolean")c?n.setAttribute(r,""):n.removeAttribute(r);else n.setAttribute(r,c)}},to=(n)=>{return{toDOM(o,c){$o(o,n,c)}}},ao=(n,o,c)=>{if(o==="apply")c(n);else if(o.match(/^on[A-Z]/)!=null){let r=o.substring(2).toLowerCase();xn(n,r,c)}else if(o==="bind")if((typeof c.binding==="string"?v[c.binding]:c.binding)!==void 0&&c.value!==void 0)Z(n,c.value,c.binding instanceof Function?{toDOM:c.binding}:c.binding);else throw new Error("bad binding");else if(o.match(/^bind[A-Z]/)!=null){let r=o.substring(4,5).toLowerCase()+o.substring(5),f=v[r];if(f!==void 0)Z(n,c,f);else throw new Error(`${o} is not allowed, bindings.${r} is not defined`)}else if(k(c))Z(n,c,to(o));else $o(n,o,c)},Rn=(n,...o)=>{if(sn[n]===void 0){let[f,x]=n.split("|");if(x===void 0)sn[n]=globalThis.document.createElement(f);else sn[n]=globalThis.document.createElementNS(x,f)}let c=sn[n].cloneNode(),r={};for(let f of o)if(f instanceof Element||f instanceof DocumentFragment||typeof f==="string"||typeof f==="number")if(c instanceof HTMLTemplateElement)c.content.append(f);else c.append(f);else if(f.xinPath)c.append(F.span({bindText:f}));else Object.assign(r,f);for(let f of Object.keys(r)){let x=r[f];ao(c,f,x)}return c},In=(...n)=>{let o=globalThis.document.createDocumentFragment();for(let c of n)o.append(c);return o},F=new Proxy({fragment:In},{get(n,o){if(o=o.replace(/[A-Z]/g,(c)=>`-${c.toLocaleLowerCase()}`),n[o]===void 0)n[o]=(...c)=>Rn(o,...c);return n[o]},set(){throw new Error("You may not add new properties to elements")}}),Tn=new Proxy({fragment:In},{get(n,o){if(n[o]===void 0)n[o]=(...c)=>Rn(`${o}|${eo}`,...c);return n[o]},set(){throw new Error("You may not add new properties to elements")}}),Mn=new Proxy({fragment:In},{get(n,o){if(n[o]===void 0)n[o]=(...c)=>Rn(`${o}|${ho}`,...c);return n[o]},set(){throw new Error("You may not add new properties to elements")}});function Oo(n,o){let c=F.style(_(o));c.id=n,document.head.append(c)}var nc=["animation-iteration-count","flex","flex-base","flex-grow","flex-shrink","opacity","order","tab-size","widows","z-index","zoom"],Vn=(n,o)=>{if(typeof o==="number"&&!nc.includes(n))o=`${o}px`;if(n.startsWith("_"))if(n.startsWith("__"))n="--"+n.substring(2),o=`var(${n}-default, ${o})`;else n="--"+n.substring(1);return{prop:n,value:String(o)}},oc=(n,o,c)=>{if(c===void 0)return"";if(c instanceof y)c=c.html;let r=Vn(o,c);return`${n}  ${r.prop}: ${r.value};`},Do=(n,o,c="")=>{let r=A(n);if(typeof o==="object"&&!(o instanceof y)){let f=Object.keys(o).map((x)=>Do(x,o[x],`${c}  `)).join(`
`);return`${c}  ${n} {
${f}
${c}  }`}else return oc(c,r,o)},_=(n,o="")=>{return Object.keys(n).map((r)=>{let f=n[r];if(typeof f==="string"){if(r==="@import")return`@import url('${f}');`;throw new Error("top-level string value only allowed for `@import`")}let x=Object.keys(f).map((X)=>Do(X,f[X])).join(`
`);return`${o}${r} {
${x}
}`}).join(`

`)},Lo=(n)=>{console.warn("initVars is deprecated. Just use _ and __ prefixes instead.");let o={};for(let c of Object.keys(n)){let r=n[c],f=A(c);o[`--${f}`]=typeof r==="number"&&r!==0?String(r)+"px":r}return o},Ho=(n)=>{console.warn("darkMode is deprecated. Use inverseLuminance instead.");let o={};for(let c of Object.keys(n)){let r=n[c];if(typeof r==="string"&&r.match(/^(#|rgb[a]?\(|hsl[a]?\()/)!=null)r=y.fromCss(r).inverseLuminance.html,o[`--${A(c)}`]=r}return o},So=(n)=>{let o={};for(let c of Object.keys(n)){let r=n[c];if(r instanceof y)o[c]=r.inverseLuminance;else if(typeof r==="string"&&r.match(/^(#[0-9a-fA-F]{3}|rgba?\(|hsla?\()/))o[c]=y.fromCss(r).inverseLuminance}return o},e=new Proxy({},{get(n,o){if(n[o]===void 0){let c=`--${o.replace(/[A-Z]/g,(r)=>`-${r.toLocaleLowerCase()}`)}`;n[o]=(r)=>`var(${c}, ${r})`}return n[o]}}),Fn=new Proxy({},{get(n,o){if(o==="default")return e;if(n[o]==null){o=o.replace(/[A-Z]/g,(E)=>`-${E.toLocaleLowerCase()}`);let[,c,,r,f,x]=o.match(/^([^\d_]*)((_)?(\d+)(\w*))?$/),X=`--${c}`;if(f!=null){let E=r==null?Number(f)/100:-Number(f)/100;switch(x){case"b":{let i=getComputedStyle(document.body).getPropertyValue(X);n[o]=E>0?y.fromCss(i).brighten(E).rgba:y.fromCss(i).darken(-E).rgba}break;case"s":{let i=getComputedStyle(document.body).getPropertyValue(X);n[o]=E>0?y.fromCss(i).saturate(E).rgba:y.fromCss(i).desaturate(-E).rgba}break;case"h":{let i=getComputedStyle(document.body).getPropertyValue(X);n[o]=y.fromCss(i).rotate(E*100).rgba,console.log(y.fromCss(i).hsla,y.fromCss(i).rotate(E).hsla)}break;case"o":{let i=getComputedStyle(document.body).getPropertyValue(X);n[o]=y.fromCss(i).opacity(E).rgba}break;case"":n[o]=`calc(var(${X}) * ${E})`;break;default:throw console.error(x),new Error(`Unrecognized method ${x} for css variable ${X}`)}}else n[o]=`var(${X})`}return n[o]}});var cc=0;function _n(){return`custom-elt${(cc++).toString(36)}`}var Co=0,l={};function rc(n,o){let c=l[n],r=_(o).replace(/:host\b/g,n);l[n]=c?c+`
`+r:r}function fc(n){if(l[n])document.head.append(F.style({id:n+"-component"},l[n]));delete l[n]}class J extends HTMLElement{static elements=F;static _elementCreator;instanceId;styleNode;static styleSpec;static styleNode;content=F.slot();isSlotted;static _tagName=null;static get tagName(){return this._tagName}static StyleNode(n){return console.warn("StyleNode is deprecated, just assign static styleSpec: XinStyleSheet to the class directly"),F.style(_(n))}static elementCreator(n={}){if(this._elementCreator==null){let{tag:o,styleSpec:c}=n,r=n!=null?o:null;if(r==null)if(typeof this.name==="string"&&this.name!==""){if(r=A(this.name),r.startsWith("-"))r=r.slice(1)}else r=_n();if(customElements.get(r)!=null)console.warn(`${r} is already defined`);if(r.match(/\w+(-\w+)+/)==null)console.warn(`${r} is not a legal tag for a custom-element`),r=_n();while(customElements.get(r)!==void 0)r=_n();if(this._tagName=r,c!==void 0)rc(r,c);window.customElements.define(r,this,n),this._elementCreator=F[r]}return this._elementCreator}initAttributes(...n){let o={},c={};new MutationObserver((f)=>{let x=!1;if(f.forEach((X)=>{x=!!(X.attributeName&&n.includes(Mo(X.attributeName)))}),x&&this.queueRender!==void 0)this.queueRender(!1)}).observe(this,{attributes:!0}),n.forEach((f)=>{o[f]=B(this[f]);let x=A(f);Object.defineProperty(this,f,{enumerable:!1,get(){if(typeof o[f]==="boolean")return this.hasAttribute(x);else if(this.hasAttribute(x))return typeof o[f]==="number"?parseFloat(this.getAttribute(x)):this.getAttribute(x);else if(c[f]!==void 0)return c[f];else return o[f]},set(X){if(typeof o[f]==="boolean"){if(X!==this[f]){if(X)this.setAttribute(x,"");else this.removeAttribute(x);this.queueRender()}}else if(typeof o[f]==="number"){if(X!==parseFloat(this[f]))this.setAttribute(x,X),this.queueRender()}else if(typeof X==="object"||`${X}`!==`${this[f]}`){if(X===null||X===void 0||typeof X==="object")this.removeAttribute(x);else this.setAttribute(x,X);this.queueRender(),c[f]=X}}})})}initValue(){let n=Object.getOwnPropertyDescriptor(this,"value");if(n===void 0||n.get!==void 0||n.set!==void 0)return;let o=this.hasAttribute("value")?this.getAttribute("value"):B(this.value);delete this.value,Object.defineProperty(this,"value",{enumerable:!1,get(){return o},set(c){if(o!==c)o=c,this.queueRender(!0)}})}_parts;get parts(){let n=this.shadowRoot!=null?this.shadowRoot:this;if(this._parts==null)this._parts=new Proxy({},{get(o,c){if(o[c]===void 0){let r=n.querySelector(`[part="${c}"]`);if(r==null)r=n.querySelector(c);if(r==null)throw new Error(`elementRef "${c}" does not exist!`);r.removeAttribute("data-ref"),o[c]=r}return o[c]}});return this._parts}constructor(){super();Co+=1,this.initAttributes("hidden"),this.instanceId=`${this.tagName.toLocaleLowerCase()}-${Co}`,this._value=B(this.defaultValue)}connectedCallback(){if(fc(this.constructor.tagName),this.hydrate(),this.role!=null)this.setAttribute("role",this.role);if(this.onResize!==void 0){if(b.observe(this),this._onResize==null)this._onResize=this.onResize.bind(this);this.addEventListener("resize",this._onResize)}if(this.value!=null&&this.getAttribute("value")!=null)this._value=this.getAttribute("value");this.queueRender()}disconnectedCallback(){b.unobserve(this)}_changeQueued=!1;_renderQueued=!1;queueRender(n=!1){if(!this._hydrated)return;if(!this._changeQueued)this._changeQueued=n;if(!this._renderQueued)this._renderQueued=!0,requestAnimationFrame(()=>{if(this._changeQueued)qn(this,"change");this._changeQueued=!1,this._renderQueued=!1,this.render()})}_hydrated=!1;hydrate(){if(!this._hydrated){this.initValue();let n=typeof this.content!=="function",o=typeof this.content==="function"?this.content():this.content,{styleSpec:c}=this.constructor,{styleNode:r}=this.constructor;if(c)r=this.constructor.styleNode=F.style(_(c)),delete this.constructor.styleNode;if(this.styleNode)console.warn(this,"styleNode is deprecrated, use static styleNode or statc styleSpec instead"),r=this.styleNode;if(r){let f=this.attachShadow({mode:"open"});f.appendChild(r.cloneNode(!0)),Kn(f,o,n)}else if(o!==null){let f=Array.from(this.childNodes);Kn(this,o,n),this.isSlotted=this.querySelector("slot,xin-slot")!==void 0;let x=Array.from(this.querySelectorAll("slot"));if(x.length>0)x.forEach(jn.replaceSlot);if(f.length>0){let X={"":this};Array.from(this.querySelectorAll("xin-slot")).forEach((E)=>{X[E.name]=E}),f.forEach((E)=>{let i=X[""],T=E instanceof Element?X[E.slot]:i;(T!==void 0?T:i).append(E)})}}this._hydrated=!0}}render(){}}class jn extends J{name="";content=null;static replaceSlot(n){let o=document.createElement("xin-slot");if(n.name!=="")o.setAttribute("name",n.name);n.replaceWith(o)}constructor(){super();this.initAttributes("name")}}var Mr=jn.elementCreator({tag:"xin-slot"});var Ao=(n=()=>!0)=>{let o=localStorage.getItem("xin-state");if(o!=null){let r=JSON.parse(o);for(let f of Object.keys(r).filter(n))if(s[f]!==void 0)Object.assign(s[f],r[f]);else s[f]=r[f]}let c=En(()=>{let r={},f=$(s);for(let x of Object.keys(f).filter(n))r[x]=f[x];localStorage.setItem("xin-state",JSON.stringify(r)),console.log("xin state saved to localStorage")},500);N(n,c)};var $n="0.9.1";function t(n){return Object.assign(I,n),I}var Bo=!1;function On(n,o=!1){if(o){if(!Bo)console.warn("xinProxy(..., true) is deprecated; use boxedProxy(...) instead"),Bo=!0;return t(n)}return Object.keys(n).forEach((c)=>{s[c]=n[c]}),s}var Xc={};async function a(n,o){let{type:c,styleSpec:r}=await o(n,{Color:y,Component:J,elements:F,svgElements:Tn,mathML:Mn,varDefault:e,vars:Fn,xin:s,boxed:I,xinProxy:On,boxedProxy:t,makeComponent:a,version:$n}),f={type:c,creator:c.elementCreator({tag:n,styleSpec:r})};return Xc[n]=f,f}var mn={},xc=(n)=>import(n);class nn extends J{tag="anon-elt";src="";property="default";loaded;onload=()=>{};async packaged(){let{tag:n,src:o,property:c}=this,r=`${n}.${c}:${o}`;if(!this.loaded){if(mn[r]===void 0){let x=(await xc(o))[c];mn[r]=a(n,x)}else console.log(`using cached ${n}`);this.loaded=await mn[r],this.onload()}return this.loaded}constructor(){super();this.initAttributes("tag","src","property")}}var Wo=nn.elementCreator({tag:"xin-blueprint",styleSpec:{":host":{display:"none"}}});class Dn extends J{onload=()=>{};constructor(){super()}async load(){let o=Array.from(this.querySelectorAll(nn.tagName)).filter((c)=>c.src).map((c)=>c.packaged());await Promise.all(o),this.onload()}connectedCallback(){super.connectedCallback(),this.load()}}var ko=Dn.elementCreator({tag:"xin-loader",styleSpec:{":host":{display:"none"}}});})();

//# debugId=A1F55D88FFD6570964756E2164756E21
//# sourceMappingURL=index.js.map
